module fnet_mtz

! a = 
0.0000

! b = 
0.0941

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.000682670393,0.042704880326,0.074876204644,-0.080225979543,-0.027137981840,-0.035107904627,0.054881053432,0.006177248621,-0.016302316686,-0.139785549615,0.235927762581,-0.465909780203 &
            ,-0.139689509595,0.247903897831,0.223562114781,-0.355181060546,0.030101926598,-0.362677303675,0.443684778812,-0.427269254984,-0.504223078981,0.357670600636,0.325188447129,-0.267967122096 &
            ,0.029641843997,-0.060860302110,0.215784604371,-0.575250964738,-0.322491800349,0.433269489825,-0.055344013762,-0.156159181896,-0.394291187483,-0.136656924775,0.713336357615,-0.471598821189 &
            ,-0.302190456604,0.237659748069,-0.029332942209,-0.220411857620,0.075419315964,-0.031760139782,0.420899399750,-0.154778094822,-0.254207916418,0.191058277106,-0.028680663611,-0.123990713791 &
            ,-0.060652743112,0.025698318658,0.515392544499,-0.652495177074,-0.268884645794,0.385865450778,0.053492606270,0.015113579985,-0.055800503143,0.029273442488,0.507796730837,-0.657718463854 &
            ,-0.261328949398,0.389890430531,0.049553994622,0.015307675558,-0.199456647472,0.216798303695,0.875995128405,0.937882795642,-1.377895511351,1.074087779535,-0.204692005959,-0.349756458920 &
            ,-0.073464930005,0.120922013624,-0.035524696327,1.618877511965,0.137201218206,-0.468542777865,0.053882137152,0.049887191949,-0.027682819647,-0.111711826614,-0.170462935058,0.748610002529 &
            ,0.638398661226,-1.721653706590,-0.025771707824,0.020036498674,0.153797903651,-0.229589642633,0.192976360702,-0.055872653990,0.431680458055,-1.725541909592,-0.121424761848,0.088129726130 &
            ,-0.149799689355,0.190817608318,-0.145897717808,0.098619908078,-0.071568080170,-0.411742951149,0.086203059592,-0.047006296713,0.042304258780,-0.036730980075,0.047508938787,0.192501074411 &
            ,0.497740473567,-0.717518933033,0.070624369978,0.100790137265,0.101362416582,-0.054490261659,0.051268237858,-0.279453618314,-0.135689567034,-0.161387599276,0.019182821160,0.015372827674 &
            ,-0.108186495806,0.104489874226,0.016268171282,-0.047847603760,0.018056116438,-0.196365754045,0.004973950680,0.008636015620,-0.090556616822,0.060704298368,0.003561518990,0.027922126264 &
            ,0.027554280844,0.036390759789,-0.027967988613,-0.125878133029,0.071700255083,-0.060717969570,-0.026839807822,0.131974921953,0.060104931526,0.069626236153,0.005131061864,0.066233798820 &
            ,0.086662727196,0.065725077696,-0.004536515077,0.000437372893,-0.069214692584,0.030215182625,0.048724419563,0.003083990780,-0.116773556841,-0.135593666668,0.011331301360,-0.021407027841 &
            ,0.133921432536,-0.074687354228,-0.076956741026,0.004575054349,0.089034321841,0.032282485636,0.028494713295,0.049351764525,0.062126589111,-0.161038425572,-0.072935456749,0.000820171015 &
            ,-0.102287349561,0.068648650727,-0.056732840299,0.004146191976,-0.063415561128,0.148591394391,0.020365691127,0.022505890377,-0.004297672959,0.081973116716,-0.034882156764,0.063642676306 &
            ,-0.002382031893,-0.045513500580,-0.012369890146,-0.068999691682,0.035157376723,-0.062679293126,0.029759489385,-0.047311172103,0.090960767235,-0.085183606009,-0.002836582250,0.072579688204 &
            ,0.057084365847,-0.040773639061,-0.081677639517,0.103939958482,-0.088083558424,0.157416373988,0.046993018198,0.070593041227,-0.007468252822,0.009005860447,-0.013791650377,0.001499964740 &
            ,0.089956940538,-0.175115987449,-0.036252967644,-0.034574056850,0.008625532919,0.016358952890,-0.031933581073,-0.120179880806,0.057698856151,-0.056838997717,0.048926457531,0.014688681391 &
            ,0.027948575746,-0.058595309441,-0.029331538820,-0.009219407690,0.025424699795,0.046338416178,-0.000086180864,0.022308684930,0.009119682804,-0.003976370298,0.051937332240,-0.072979495883 &
            ,0.059820530543,-0.077054792387,-0.028825369634,-0.000053478604,0.000126105436,-0.000277055070,-0.000651120966,-0.062381580647,-0.091507804163,0.166011371445,0.008850338763,0.012501213214 &
            ,0.007038111052,0.001202880802,-0.014025104806,0.005594364044,-0.079362610465,0.151080980450,0.020458840018,-0.006217600243,-0.005079649552,-0.004688483157,0.024634223029,-0.024060131897 &
            ,0.047775161814,-0.069219454139,-0.002681453629,0.052150795361,0.019510081768,-0.024058054244,-0.042150173739,0.093928963472,0.012073573250,0.057322133982,0.017735983602,0.002061945207 &
            ,-0.010120043858,0.013730593200,0.012080046640,-0.044191306793,-0.035386848261,0.020028063007,0.002117085100,0.006992029032,-0.043766481452,0.044688315577,0.036757813378,-0.045932140547 &
            ,0.020907045816,-0.059886422684,-0.014984126953,0.004975300940,-0.016840264921,0.028615916982,-0.029236918973,0.035702651627,-0.013884003591,0.038507216913,0.005872318137,-0.075120678627 &
            ,-0.053577432272,0.115793201998,0.028901791210,0.237458264544,0.126857292857,0.201625782678,0.164312792835,0.010992982865,0.022705511508,0.080910282393,-0.020424877298,-0.101349937502 &
            ,-0.210477788801,0.094393314313,0.034471799418,-0.170234426581,0.006219331700,-0.079153590980,0.129362090386,-0.182148029018,-0.141191716482,0.311307619214,-0.034628133013,-0.249802372856 &
            ,-0.007410121300,0.001156329681,-0.001915770328,-0.074439168664,-0.302709702290,0.187630689058,-0.091111668286,-0.109912529277,-0.070554282969,-0.083221282691,-0.021142602116,-0.135804595837 &
            ,-0.137049577754,0.095976399033,0.059508276284,-0.041535641708,0.005607743321,-0.138159858462,0.069458103233,-0.111564873192,-0.032081067023,0.045138511608,0.188111073968,0.106072514027 &
            ,0.119808186971,0.108650524926,0.000495792412,-0.011025694353,-0.153914208767,0.012398862067,-0.015090255625,0.109763411344,-0.174628721884,-0.125214884518,0.283583555394,-0.273089319967 &
            ,-0.026663555741,0.100374124055,-0.119719723214,0.007922427856,-0.216266063877,0.147193853553,0.362651682140,0.161429599690,0.037517128499,-0.359702701637,-0.211597915630,-0.264186724882 &
            ,0.024849854905,0.145047587818,-0.058235995630,0.323499613506,-0.003084377197,-0.142403234522,0.148052100169,0.055716120191,0.064840682215,-0.031643672708,-0.119634123698,0.051295200436 &
            ,-0.144347984648,-0.008177189404,0.023616458273,-0.037105249770,-0.040114716450,0.082377099006,-0.008873841431,0.326615573137,0.326746611748,-0.333051533929,0.069301766085,0.070681046368 &
            ,0.000016222471,-0.125282079990,-0.092434580195,0.254492368336,0.166339396058,-0.003573032919,-0.121168320535,-0.116990801075,0.125092022440,-0.135191841301,0.007935966396,-0.368114500986 &
            ,-0.319242140338,-0.144068903424,-0.010531610551,-0.036504712787,-0.133165016227,0.143510303443,0.238471457019,-0.275983515839,0.024800523037,-0.075784366862,-0.060226480945,0.083467337221 &
            ,0.022812035897,-0.052231796846,-0.181694773816,0.228296299930,0.033857806084,-0.019050401531,0.067589332914,-0.094634845508,0.111213796553,-0.173492340677,0.011092085475,-0.044793410236 &
            ,-0.022812594525,-0.009398165366,-0.028874329381,0.166560375281,0.001101168198,0.108673008943,0.104556660297,-0.181360468532,-0.039735820510,-0.054846153797,0.068861187879,0.058303682977 &
            ,0.195461920834,0.054821115423,0.018871513772,0.067649618701,-0.023886612172,0.051957478660,0.184382657648,0.160696917893,-0.025001204918,-0.192142181872,-0.092333156151,0.045792863061 &
            ,0.125863689172,-0.071275248383,-0.069441002573,0.021926601991,-0.039050637756,0.070444573804,0.077111197538,-0.064579094467,-0.061660397385,-0.092035166797,-0.115237575899,-0.019522071087 &
            ,-0.089860315883,0.163770247399,-0.014905278646,-0.099050121679,-0.107071462049,0.214348000516,0.047056144570,-0.079754334081,-0.090440370118,0.041865928771,-0.055032775994,0.062951936575 &
            ,-0.085084715251,0.076580927011,-0.070276450436,-0.074622152726,-0.040135244290,-0.165878758405,-0.046985495067,0.061043044928,0.091218029480,-0.066717594116,-0.153093975692,0.018922883400 &
            ,0.020480174626,0.066164461056,0.006449000686,-0.023991077866,0.047011537537,-0.119835252125,0.128469393966,0.001398996096,0.077947071662,0.077820686261,-0.043161221425,0.087950446878 &
            ,0.040107484529,-0.009393688845,0.111409540459,0.094401075116,0.097785334645,-0.107640375748,0.016139398790,-0.124373378137,0.118233598397,-0.188313941675,-0.020090924027,0.111193596362 &
            ,-0.023314984380,0.049504210325,-0.010455598232,-0.120662622398,0.024639897934,-0.045201634965,0.066266078055,0.037535683544,-0.057532258627,0.009354801374,0.064567552427,-0.164367031166 &
            ,-0.063245522182,0.043119341178,-0.094998360609,-0.002960309766,0.131569405121,-0.089231872674,0.001775931963,-0.003675445814,-0.041965867494,0.100665468910,0.044818272915,0.091102402611 &
            ,-0.101969180529,0.086232055165,0.008945106136,-0.031741925841,-0.032982574391,0.079604875875,-0.027898373746,-0.075974557287,0.157192858637,-0.135226752305,-0.062633471115,0.075388884651 &
            ,-0.075742839868,0.145783459473,0.068643020900,0.146969380149,-0.099976616374,0.045443371965,0.110107906158,-0.188399881346,0.040967596285,-0.168200625821,-0.109353189571,-0.098976743004 &
            ,-0.012990110868,0.040097105610,-0.024561966642,-0.049260538605,-0.091004306814,0.141826869051,0.053099887306,-0.021047344199,-0.072182247975,-0.010586438228,-0.016304754628,-0.009247646723 &
            ,-0.067098256742,0.049808163798,-0.044808820787,-0.001796866449,0.058378128982,0.040312320881,0.013570785683,0.041123908280,0.062301115918,0.036918170729,0.060454958661,0.031871200159 &
            ,-0.008486388431,0.024865799799,-0.049754476543,0.066013564060,-0.017005709629,0.045349897245,0.009731574319,-0.050536671377,0.006598558445,-0.013057488835,0.029520033513,-0.053684714774 &
            ,-0.020840072818,0.007476836149,-0.013930171340,0.018146120837,-0.046707124443,0.026552355662,0.019217421916,-0.031875695866,0.035880627758,-0.072449283113,-0.034962514833,-0.056170540784 &
            ,0.063972597305,-0.031772758466,-0.012863911988,0.004033053612,-0.023447918831,0.031741490035,0.062216206770,0.103008368018,-0.046372125118,0.010271956101,-0.031470159303,0.050212451293 &
            ,0.024427290231,-0.009747023123,-0.009145359772,-0.038868304958,0.007637656999,-0.000175117942,-0.000965942787,0.006921115947,0.026716638028,-0.043608312366,0.012167114407,0.015760403644 &
            ,0.098801931976,-0.047928701101,0.023787680198,-0.016235459577,0.054787414920,-0.090103297595,0.037332490950,0.022444778400,-0.125790510432,0.061869560679,-0.025202451094,0.020740221206 &
            ,-0.027739447773,0.041271514045,-0.052884579449,-0.057874649560,0.043477509107,-0.059363844692,0.055871292866,-0.067244441906,-0.046652333830,0.065085432692,-0.037656838246,0.049456848499 &
            ,-0.061502475319,0.079767923236,-0.010286081935,-0.020235960205,-0.000204898892,-0.032808674169,0.013701279655,-0.057216294239,-0.044679599012,-0.000532059863,0.040272462209,-0.064409604570 &
            ,0.051305888642,-0.116301165194,-0.033339440502,-0.021929653148,0.033454581909,-0.029916406854,0.000764336658,0.014014972165,-0.020436553371,0.066870339054,0.002300409702,0.012219287700 &
            ,0.034265924343,-0.018448514437,-0.038122115343,0.037516663983,-0.002917111448,0.003908292428,0.039118746334,0.051090075443,-0.101149811359,0.066282127666,0.036219960707,-0.064273745770 &
            ,-0.018765014181,-0.003364946990,-0.055017046965,-0.085549743432,0.085440549197,-0.055068055585,0.015634678841,0.006935980673,0.035541762931,-0.029190362933,0.043533344092,0.099172005842 &
            ,-0.027131950567,0.019238405475,-0.012408702093,-0.035503726236,-0.047047306017,0.032437286373,-0.008005124875,-0.049520071240,0.003913167976,-0.000858326224,-0.009967723872,0.006788776017 &
            ,-0.043528462937,0.059787306831,-0.002763623685,-0.006954381689,0.026760384597,-0.016704401618,-0.003395596431,-0.018945499383,-0.038177481193,0.048279894182,0.016879462522,0.049576331201 &
            ,-0.036061447821,-0.000313859772,-0.024463590566,0.032602423245,-0.014542404599,0.005248277868,-0.082366681567,0.159237513464,0.157497898486,-0.093075331563,-0.024521177422,-0.001452114078 &
            ,-0.020556106883,0.005900133986,0.074269659512,0.205170019465,-0.130636310428,-0.000393956909,-0.016828013599,0.048604785785,0.098591003153,-0.099191882820,-0.142049221017,-0.083361274860 &
            ,-0.233707314521,0.158736866077,-0.052190429497,0.056620621659,0.018961557680,-0.034863293631,-0.126858851760,-0.253708045273,-0.196506472918,0.176382160140,0.012229055964,-0.078431916877 &
            ,-0.092332490401,0.095203923991,-0.046382686397,-0.226059180882,0.075082840916,-0.071871157058,-0.019336482159,-0.001736448385,-0.024305730227,0.022036182238,0.037465362431,0.059522274047 &
            ,-0.027606068045,-0.014090232726,0.017459695193,0.002646100949,0.072407993414,-0.103690373937,-0.031508749790,0.035118612457,-0.053875967391,0.076631614252,-0.003273606145,-0.078157327289 &
            ,-0.173183868794,0.190328308050,-0.029474000068,-0.201174621827,-0.258718901164,0.315182437883,0.003679412738,-0.020443033111,0.044461198215,-0.070762952020,-0.004130160845,-0.105633108868 &
            ,-0.699221335477,0.589170646404,-0.029873190268,-0.139580855508,-0.200183921080,0.150259081955,-0.213413724938,-0.652458030667,0.570977193378,-0.299228107139,-0.030511485227,0.082129426331 &
            ,-0.062604403355,0.177175471196,0.235211403702,0.106908874227,-0.276460483393,-0.147457073344,-0.102528522108,0.017674900876,-0.237588633495,0.293845049079,-0.270436530207,-0.150248813600 &
            ,0.257164879433,-0.246564167472,-0.089023860430,0.196332266710,-0.041964215485,0.161132798227,0.043035227585,0.331792384077,-0.651947209152,0.289762971824,-0.131899027749,0.141147255495 &
            ,0.007172124760,-0.002585679245,-0.369014125871,-0.363890839580,0.168538183799,-0.235041514811,0.040027473870,0.126007386658,0.268428450680,-0.256934048192,-0.179698429205,0.105905205378 &
            ,-0.189624271709,-0.049585554315,0.061651231376,-0.151762163762,-0.017896362022,-0.074956267613,-0.165568345304,0.031936060640,0.622684031667,-0.170391148607,0.021546154830,-0.069040316950 &
            ,-0.110943974988,0.104812044506,0.482898697723,0.483337693662,-0.208070778795,0.300924105716,-0.029172428657,-0.077667141540,-0.098051992194,0.049946830312,0.211025558834,-0.017533368321 &
            ,-0.012455709231,0.026536724619,0.024577434937,-0.022735049702,0.009719640340,-0.024708241087,-0.009853992531,0.002362607008,0.023836356311,-0.014198201312,-0.010487113833,0.011833887305 &
            ,-0.001860287849,0.005955711202,0.014072725445,0.007095436262,-0.008035635425,0.001748254329,-0.007124253865,0.000076505948,-0.005413534771,0.004678529142,0.001328358018,-0.009278969416 &
            ,0.009457442669,-0.001981431420,0.009298446288,-0.006361221438,0.005338445565,-0.006617838026,0.002767687631,0.006552042133,-0.001735330313,0.004835498031,-0.011819253626,0.013667399015 &
            ,-0.009432149932,0.016022310438,-0.000347782406,-0.009311905268,-0.001700187108,-0.002897485098,0.004368534515,-0.011673411297,-0.013662555933,0.015323914916,-0.007714248263,-0.001959135407 &
            ,-0.012821257708,0.016158224554,0.011831164836,-0.018786170825,0.001173190779,-0.009615762857,-0.001186605098,-0.003560845523,0.009695455410,-0.014807207038,-0.007335539720,0.016440018979 &
            ,0.025112704136,-0.027066416027,0.009475436379,-0.000247873230,0.008425135810,-0.017342729581,-0.007155679327,0.008532938144,-0.024680915813,0.024574008938,-0.020338012500,0.020458037580 &
            ,0.021773599630,-0.026270612967,0.017402684158,-0.020059529474,0.019240320139,-0.025695877218,0.004930337668,0.012371763219,0.016047211809,-0.007996451022,0.003323700300,-0.018096327644 &
            ,-0.031058620549,0.037698666035,0.000106142454,0.014644356058,-0.002972865186,-0.006545778774,-0.023103489892,0.023932467536,-0.035622383942,0.063358875935,-0.004443527609,0.006211916635 &
            ,0.017404219563,-0.019260359647,-0.043164681338,0.037042945667,-0.054637365270,0.075661868582,0.000923083739,0.010243369930,-0.006140078231,-0.001846695306,-0.028014805595,0.020562293684 &
            ,-0.027989396846,0.033118773064,0.009223430414,0.017966228076,-0.035077409379,0.019602459484,-0.018194370642,0.006493640819,-0.002800426066,-0.007386694012,0.006281215827,-0.007182268782 &
            ,0.010739753682,-0.014569170852,0.008468839233,-0.024765908236,-0.032353808846,0.039631885723,-0.007441596055,0.020193228879,-0.008341259035,0.015331037089,-0.013363065810,0.003494060394 &
            ,-0.031002303980,0.041898411510,0.007509374766,-0.012710757619,0.011886962108,-0.006141719376,0.006889337971,-0.019078640199,-0.008902860001,-0.004116976063,0.000377820869,0.014321857519 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.36628,1.8813 &
            ,-0.17906,1.2077,-1.6589,-0.41272 &
            ,-1.4978,-0.005034 &
            ,3.2913,0.018806 &
            ,1.8524,-0.036528 &
            ,0.14307,-1.4283 &
            ,0.048789,0.82741 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.95982,0.68916/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-1.8542,0.085306,3.7816,0.63664,-1.3568,-3.1935,-0.10597,-0.62121/)
real, dimension(2) :: bias2 = &
  (/-1.5553,-0.42912/)
real, dimension(1) :: bias3 = &
  (/0.64463/)
contains
subroutine fnet_mtz_initall()
end subroutine fnet_mtz_initall
subroutine fnet_mtz_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_mtz_engine
end module fnet_mtz

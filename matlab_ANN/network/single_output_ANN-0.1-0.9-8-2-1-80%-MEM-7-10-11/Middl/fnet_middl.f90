module fnet_middl

! a = 
0.0009

! b = 
-0.0049

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.865516244602,0.021730173794,-0.286181713078,0.455257246321,0.181570453574,-0.081889863732,-0.049943344494,-0.893688127849,-0.203658593957,-0.297005459012,0.433097050056,0.036700768413 &
            ,-0.286930366046,-0.138435814216,-0.087017578337,-0.220707159345,0.407391125692,0.077973195035,-0.024126237626,-0.216605976279,0.145545919442,-0.079848528550,0.011623489293,0.178620824530 &
            ,0.189254772068,0.257469048975,-0.046033626242,-0.324166243203,0.218042242372,0.232743071133,0.074750788787,0.263707427002,-0.525924302210,-0.110158930392,-0.403210680539,-0.114254910816 &
            ,-0.103460240548,0.247639636377,-0.034680460234,0.114681812454,-0.682685954539,-0.143199346833,0.240279275286,-0.050826234963,-0.090639478286,-0.159003469882,-0.019659964026,0.099616653329 &
            ,-0.573250459183,0.067768312904,-0.105115329556,-0.542161036457,0.032777162769,0.170078137614,0.028639303901,0.054995803061,-0.573726975262,0.072186476730,-0.100117227743,-0.541789903530 &
            ,0.028536247639,0.177840915917,0.000711071161,0.056426302656,-0.308287704157,-0.148253945772,-0.307214759507,-0.209761403049,0.163714840811,0.312840513807,-0.158494461259,0.344029699671 &
            ,0.025142266195,-0.756166206172,-0.149077710631,-0.086516208027,0.532616658151,0.060857443207,-0.615318788218,0.714664722049,0.487466523874,-1.556954416047,0.223085508695,0.344400669233 &
            ,0.845063055409,-0.264526996337,-1.199379046921,-0.916005219720,-0.468385984609,-0.366576698948,-0.256868338070,-0.082551700871,0.578325200273,0.277563723380,-0.403769839754,0.228674894624 &
            ,0.121969894602,-0.404945816844,-0.041800148221,0.195270096942,0.307957330463,-0.016728948746,-0.341524376418,0.352541937590,0.714780195265,-0.348401331621,0.459699789904,-0.166513456488 &
            ,0.469966488102,-0.159602473065,-0.370469521882,-0.691073315299,0.376242087825,-0.037383644909,0.110363030144,0.880144402300,0.173504172280,-0.090808931518,-0.094922225657,-0.742012638059 &
            ,-0.328430839876,-0.087554910470,0.019855919007,-0.362461954863,-0.078001517160,-0.016666186925,-0.014775916201,0.348671477638,0.178597173405,-0.101516268600,0.449900296208,0.351237829732 &
            ,0.104800215209,-0.267909152411,-0.104875000672,-1.108001606994,0.570080844212,-0.040281186627,-0.043258562230,0.357054708380,-0.020174814673,-0.028070762121,0.002247772103,0.606610398315 &
            ,-0.590483003825,-0.090158457857,0.129228832479,-0.427256268629,-0.172618188430,-0.040275140954,0.011974488432,0.261926976977,0.382690393601,0.068126601022,-0.044920643395,0.287231584970 &
            ,0.125606523366,-0.004982471277,0.012743398369,0.310668286486,0.154706963955,-0.052403416759,-0.083059079785,0.031405474955,-0.075273464499,0.020403362777,-0.030900112005,-0.335631703279 &
            ,-0.268732493096,-0.013355742190,0.181829843087,0.064948671665,-0.000797400398,-0.044784136257,0.024096285872,-0.055938108181,-0.066931322322,-0.008171032873,0.114238006287,0.028218398939 &
            ,-0.071647423150,-0.174083851646,-0.013114238936,0.008461493341,0.182339051285,0.013074368605,0.048825016524,-0.144523247974,0.053157064875,0.001222217701,-0.009821219302,-0.103120181489 &
            ,-0.189630085929,0.048969436848,-0.161052531387,0.079556681522,-0.026671986325,0.150828945081,0.033715714955,0.011689534484,-0.086889209553,-0.026908336916,0.193772630444,0.117498679370 &
            ,0.010068422293,-0.142639629072,-0.017071078343,-0.021322383943,0.115416513489,0.010494471404,0.333221639167,0.309340528993,-0.095854864423,-0.259204070613,0.002942991730,-0.681977020564 &
            ,-0.011378042762,0.164607761612,0.288368102594,-0.023997046817,-0.031552381234,-0.073132265855,0.094401127300,-0.317481394229,-0.243904727169,0.146538411686,0.032259535727,-0.805565462624 &
            ,-0.042631299905,0.007256778444,0.096654353521,0.895101283520,-0.492034114783,0.057864847409,0.110620615908,-0.525442835127,-0.058925176287,0.028713468268,0.060180824503,0.239276818256 &
            ,0.134874671318,-0.058252158995,0.065910816210,0.376614249413,-0.065168958115,-0.099748121113,-0.004214643683,-0.191828438148,-0.286957755992,0.114388178597,0.079620416030,-0.179725950008 &
            ,0.034255511136,0.003401464957,0.047185558271,0.082785202677,0.576519736204,0.032966702315,-0.042306108367,0.422907962702,0.026265674524,0.016215797565,0.008167926937,-0.271790530341 &
            ,-0.320713499460,-0.007348987434,-0.184374251075,0.013575701194,0.051854311086,0.119894174129,-0.010584238188,0.260077806693,-0.289658826899,0.068805846696,0.053576689427,-0.257300500402 &
            ,0.025687629920,0.016684022461,0.026932144120,0.091525691577,0.014154754677,-0.102689937569,0.062047842582,0.112741811304,-0.051254713509,-0.072566897665,-0.034575618523,-0.021707522470 &
            ,0.144760984577,0.404888244189,-0.295746485426,-0.886616303666,0.461677210397,0.603191345015,0.115747882278,0.993764049743,-0.077691940834,0.141405382468,-0.082243460270,-0.599792810082 &
            ,-0.190578557484,-0.083782571832,0.132936067106,0.457866568610,-0.147411576880,0.074618529166,-0.089410189181,0.051498760599,0.105275120826,-0.019091773234,-0.035881457760,0.272695619094 &
            ,0.111801322708,-0.068428969603,0.035708461593,0.262311288994,-0.057011396321,0.041868720217,0.005861003413,0.272330529578,0.102909697381,0.057934139485,-0.028828798636,0.258360742326 &
            ,0.065597056575,0.232676017321,0.100228010391,0.291848824006,0.107254837621,-0.059392930701,0.017844722743,-0.178686740361,-0.012577770566,-0.156714353895,-0.057871154682,0.211350194370 &
            ,0.554835488932,-0.019037225659,0.032113493079,-0.432532130742,-0.034984701698,0.175174215806,0.018359018467,0.209528590168,0.354971612814,0.139584921345,-0.321842625030,-0.145026539966 &
            ,0.116596412112,0.205524431050,0.034790294923,0.340707714941,0.664608611196,-0.551052626530,0.398871127296,-0.973449520553,-0.137963962098,-0.222252499852,-0.178119309803,-1.181819785425 &
            ,-0.297229061566,-0.364404594359,-0.256960188135,-0.071548379341,0.215452583761,0.179319717657,-0.275816019844,-1.362645320231,-0.935581020498,-0.501022552237,-0.939695405070,2.517526498950 &
            ,-0.193724742624,0.647989615826,-0.116651709585,-1.620689135587,0.995932013398,-0.139989809154,-0.710037796903,0.150230318037,-0.034318398960,0.151058047796,-0.143660014832,-0.649355202834 &
            ,0.482227476971,-0.138438260087,-0.190059402866,-0.666754245766,0.091727294110,0.133918806602,-0.032853833108,1.532771448807,-1.291992170104,-0.013917371380,-1.159780433156,-0.379991585432 &
            ,-0.308511579099,0.797269456836,0.135966118635,0.580446183222,0.980820360261,0.138764263143,-0.013000345340,0.451103798192,0.335576802507,-0.168188476731,-0.108551945290,-0.670281268857 &
            ,0.569336408717,0.074064786623,-0.186947414990,0.858181106200,0.231116493294,0.149558083487,-0.021397691273,-0.535488041811,-0.450388316446,-0.208472729635,0.262335037418,0.296947642283 &
            ,-0.343848167887,-0.326087356259,-0.016492774573,-0.887255145899,-1.452588601678,0.096994496807,0.359247842608,-0.796450518713,0.217419313021,-0.082187316861,-0.023047110524,0.455248443847 &
            ,-0.813023632798,-0.296446379393,0.030183701114,-0.463151873825,-0.151188596683,-0.167538794612,-0.077314448768,0.741751481237,-0.179316663283,0.280550956347,-0.227341439347,-0.085990911571 &
            ,0.223424312825,0.226712360490,0.059902301005,-0.131814697391,-0.048280906090,-0.084880184536,-0.137293735517,-0.194171902867,-0.150431255067,0.096614768412,-0.029900518000,0.290099957347 &
            ,0.017793085031,0.145106881379,0.030866497940,-0.457388608847,0.206582005560,0.157301253683,0.069572448773,0.227930176964,-0.118640844928,-0.022583909017,0.142060522367,-0.222694843764 &
            ,-0.177054442194,-0.130268801165,-0.013356264992,-0.072820766875,-0.358095726318,-0.011272386414,-0.057569332856,0.410290603856,-0.040509912958,0.009500204463,0.037223901734,0.057462678599 &
            ,-0.253577087921,0.051754346892,0.185897082342,-0.168935790156,0.095713070294,0.025585738471,0.001490568940,0.165921619815,-0.513319282520,0.030661002381,-0.020841067449,-0.709497753170 &
            ,-0.052468936603,0.034870960926,0.010396074346,-0.055321763073,-0.339101513508,0.243094058109,0.435845002048,-0.026313743473,0.032664112151,-0.090470043807,0.108503946091,0.000429454939 &
            ,-0.407265316315,0.085997892216,-0.131704725222,-0.113420854043,0.121465994815,0.118406555681,0.009585938444,0.282790535774,0.045027456772,0.077757575169,-0.114213267921,-0.027422918402 &
            ,-0.077669849825,0.107401206007,0.083385359758,0.495196428203,0.650134663258,0.151204926655,-0.045478974715,-0.418827806835,0.185722027629,0.134376308017,0.014567485411,-0.022779105724 &
            ,0.495524231442,-0.029559104208,-0.361922291669,0.539018454709,0.028377531757,0.144800178920,-0.027506817927,-0.304685919490,0.460689922813,0.235763633873,0.078162769716,0.265656616670 &
            ,0.245784614123,0.063686432385,0.059087505087,-0.131927691159,0.414482397576,0.028051906038,-0.193688686348,0.017264697597,0.161980515406,0.101097568991,-0.035339254581,0.318713708563 &
            ,-0.097118266535,-0.046171354845,-0.039778460329,0.548735808002,0.080065779097,-0.048650232262,-0.051805168712,-0.355323028000,-0.176597359076,-0.032495936007,0.241632252814,0.189671465488 &
            ,-0.044673853208,-0.195994088049,-0.007676663650,-0.447461430372,-0.284923041555,0.053133633270,-0.217302677291,0.274029883782,0.099463069675,0.115227981681,-0.009733228546,0.039272444399 &
            ,-0.136031408459,0.066342714397,0.094484362796,-0.191030004739,0.081432844861,0.007515840481,0.014786623471,0.091348764573,-0.268385215153,0.008710631768,0.076188438576,-0.106988104457 &
            ,-0.013504483934,-0.071733041742,0.001323018644,0.023687821395,0.086983319433,0.020808752822,-0.138653390296,0.085487991768,0.011020612108,0.132956285566,0.018053816567,0.145395790332 &
            ,-0.040379188514,0.022505922800,0.115266183183,0.021572477033,0.015254841254,-0.058907049256,0.004478134362,-0.124251042533,0.034774337197,-0.030865854639,0.039166799755,-0.013049647871 &
            ,-0.041732198629,-0.039180567971,-0.005049204167,-0.028007788470,-0.069809726809,0.005651823542,-0.012699499183,-0.196518742453,0.011442557091,-0.006133332248,0.005322484023,0.333969525784 &
            ,-0.011318789169,-0.014037895860,0.107872945068,0.035684501667,-0.009857427308,-0.084395067501,-0.002120495850,-0.021603447260,-0.023746362140,0.034204086779,-0.034714339109,-0.178577658896 &
            ,0.026189247683,0.029479914315,0.005760345882,0.096200084895,0.232933472839,-0.089400610641,0.170231551334,-0.174468544589,0.060731673178,-0.231258287394,-0.044933239488,0.568541499330 &
            ,0.078150092186,-0.057763479646,0.041575959213,0.054148484580,0.047330994044,-0.116069185943,-0.037748637814,0.141652103628,0.200001677771,0.001526187792,0.053842369898,0.522133026881 &
            ,0.064835759153,-0.113356816238,-0.027081357179,-0.370755346187,-0.022867372563,0.008628806140,-0.066598879324,-0.068825448212,0.010487875107,0.062300573841,0.001201080686,-0.075301757459 &
            ,0.144824613267,0.020895671905,0.081409517780,-0.074281915074,0.058546539007,-0.093825183122,-0.005637268557,0.135408665934,0.191425701686,-0.003979747942,0.043714081265,-0.036036267772 &
            ,-0.023626713226,-0.004808468016,0.009481099256,0.121861936297,0.041518315835,0.011162294801,-0.126088158846,0.015509370244,0.042802145034,0.069292506103,-0.010754180987,-0.107728414146 &
            ,-0.022987600376,0.053184973235,-0.136278478352,0.074778655797,0.068164199128,0.128429565259,-0.000776167989,-0.307409967540,0.082948585991,-0.116541536417,0.235580310891,0.310823004724 &
            ,-0.082914188887,-0.265939894081,-0.028213792047,0.039717885061,0.243841878565,0.157359406295,-0.366777828617,-0.378078814958,0.152970509616,0.287382321095,0.027613147604,0.234940674054 &
            ,0.233629918480,-0.039130373284,-0.011023795605,0.249951226311,-0.059865824698,-0.007980999904,-0.003052211349,-0.199933700203,-0.049975230271,-0.051739613493,0.016175437227,-0.035293316440 &
            ,-0.011655573843,-0.023377537726,-0.015230295874,0.130521731215,-0.032196932414,0.019367720318,0.007111838202,0.133501323576,-0.020744777755,0.004814666689,0.003315081799,-0.312629846549 &
            ,0.215331381963,-0.062579316970,0.036973980107,0.316527387939,-0.046924741648,-0.060891654678,-0.012460162507,-0.093287674504,-0.193240953071,-0.000024633798,0.087195002008,0.073298193899 &
            ,-0.016481543766,-0.034989502057,0.001755994574,-0.114095130606,0.205818472343,-0.069664585514,-0.013846889215,0.291964461074,-0.061345662385,-0.029853454954,-0.023641602544,-0.348337532834 &
            ,-0.105816920240,-0.030496373923,0.173061014902,0.164757212318,-0.047753844525,-0.111950714743,0.001536733631,-0.052010121396,0.084925822089,0.021660448468,-0.065540221797,0.050159304353 &
            ,0.025094802775,0.053710292270,-0.000284240133,-0.074574170542,-0.207532072902,-0.091880868844,0.461948913631,0.616913073544,-0.104760551352,-0.329931691679,-0.024632905873,-0.572809147846 &
            ,0.105038532966,-0.250848451064,0.273889723682,0.993976896350,-0.226607428137,-0.328157500593,-0.077883938194,-0.936353332602,-0.099214162559,0.031514134337,0.103650892502,-0.285169596019 &
            ,0.052311828567,-0.093896829086,0.009310909902,0.426438871127,-0.217765728686,0.038759492872,-0.032670240079,-0.451940876668,0.064043105137,-0.019441676093,-0.002174524678,0.345237645310 &
            ,-0.319614201452,0.148226258643,0.024750968376,-0.616327405149,0.181923875260,-0.018074061676,0.017495714027,0.550999736384,-0.007404490849,-0.006427721579,-0.173847074421,-0.264697180910 &
            ,-0.007448855992,0.118359426707,0.001163955721,0.176094033683,-0.259535102448,0.081511645362,0.101973813391,-0.415713754253,0.054530283878,0.039188123647,0.036614099361,0.357580956670 &
            ,0.146739915797,-0.139779587233,-0.022544388623,0.296224125325,-0.147105600702,0.013270756400,-0.023549605618,-0.308438179723,0.230472819370,-0.081734191204,0.034971956501,0.264990913784 &
            ,-0.094524651894,0.022591803564,0.002020011591,-0.063625309852,0.021380095529,-0.060190205333,0.021472135379,-0.087396950556,-0.081383955926,0.022410412985,0.007097051956,0.101199661294 &
            ,-0.055644249435,-0.009055625944,-0.011734432579,-0.032037896559,-0.004273239994,-0.011885329383,-0.010931637700,-0.083004853334,-0.014904154784,0.002273530077,0.004304269727,-0.009207275321 &
            ,-0.014008983405,0.014381548113,0.008244748541,0.010054469724,0.032825185149,0.006873635450,-0.004074438381,-0.007603858228,0.015296221595,-0.006421283320,-0.006037717983,-0.050161662037 &
            ,-0.041718132060,-0.004203637231,0.003447966112,-0.042521849515,-0.011852631249,0.001240192500,0.002417832793,0.041882363212,-0.033254087595,-0.008838477351,0.000035849646,-0.024318739289 &
            ,-0.003174376777,-0.002485536469,-0.002436259679,0.023766157776,0.002602010764,-0.002942025214,-0.006315048180,0.032941401808,-0.016074358738,0.006219241016,0.002891237449,-0.045473484507 &
            ,0.011535489763,0.001927074458,-0.025995600633,-0.042295381121,0.006256654168,0.024990443667,-0.000061042770,0.062832475621,-0.024392843826,-0.013496299563,0.007546794760,0.011023320639 &
            ,-0.008961278086,-0.017190579651,-0.006536025701,-0.059202296903,0.042631622959,-0.001782793633,-0.137741053854,-0.061352562896,0.012991355953,0.074891589107,-0.011129239474,0.112592696479 &
            ,0.037855588542,0.077127086515,-0.131556966977,-0.311440239591,0.098369126212,0.147839465947,0.007854318095,0.273259489456,0.038418855813,0.031571448631,-0.091112643339,-0.284187456070 &
            ,0.064553962605,0.111093348047,-0.011846908719,0.017682300503,-0.015099929092,-0.000183660953,-0.006283415789,-0.037763615132,0.087419875726,-0.020676079545,-0.026075606621,0.130206562673 &
            ,0.021491276029,-0.012949286825,-0.038829274372,-0.086802490797,0.047083622886,0.029009626124,-0.016787950564,0.164843707846,-0.236059057585,0.045730158294,-0.109050930116,-0.066753686876 &
            ,0.067000378802,0.099296551850,0.001529550918,-0.063352729374,0.254714146184,0.007309008601,-0.128553067138,0.139228151574,0.010613010696,0.072257703116,-0.001777370650,-0.089488935912 &
            ,-0.058538050808,0.007455090240,-0.001863009241,0.008941006799,-0.006623687877,0.014358655540,0.006596643620,-0.064212196472,-0.184711782002,0.002332308817,0.020980210302,-0.051248743420 &
            ,-0.001540025765,-0.001803506890,0.003709846961,0.015639220424,-0.088704540990,0.024900619524,-0.080842291157,-0.095288477124,0.021823842819,0.063919711391,0.006195297660,0.067570728591 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.17247,2.2277 &
            ,3.4682,-1.1263,1.5264,-1.7456 &
            ,0.39028,-1.0561 &
            ,-2.2274,-0.56496 &
            ,1.7954,-0.76076 &
            ,-6.4039,0.78678 &
            ,0.34593,-0.16614 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-3.8787,-0.46518/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/0.39764,-4.4344,-1.2083,-0.11048,3.2458,0.80522,-3.5978,-3.029/)
real, dimension(2) :: bias2 = &
  (/0.70721,-1.487/)
real, dimension(1) :: bias3 = &
  (/2.4417/)
contains
subroutine fnet_middl_initall()
end subroutine fnet_middl_initall
subroutine fnet_middl_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_middl_engine
end module fnet_middl

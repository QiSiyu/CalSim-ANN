module fnet_mallard

! a = 
0.0000

! b = 
0.0918

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.105525979429,0.027459280259,0.239641143830,0.364377221263,0.567053049469,0.145549527150,0.316613223497,-0.103179988273,0.170960994070,0.304314437750,0.233853664797,0.380071750600 &
            ,0.297200323333,-0.049893411020,0.431707345194,-0.108217598989,0.216023966904,0.411652996894,0.148751524789,0.750287385425,-0.004136659056,-0.028152272684,0.366976676996,-0.380083444123 &
            ,0.054005878113,0.319537413851,0.159740924888,0.455914559744,0.034971366261,-0.107020192349,0.432483306926,-0.201345023643,0.411066616767,0.263623387029,-0.180140346117,0.312381529119 &
            ,0.160313953970,-0.251183068320,0.368512933158,-0.226313402952,0.172386662501,0.431678556617,0.134446103989,0.416676817820,0.008898531997,-0.339627559094,0.178962643463,-0.298032832664 &
            ,0.192192317950,0.501981257627,0.232384129200,0.255411485413,0.080499426100,-0.345232637879,0.323213747988,-0.091501466520,0.188041019082,0.501910434983,0.236517746854,0.253052670897 &
            ,0.078980830097,-0.344100892840,0.327183239135,-0.084096343943,0.641613168010,0.636361361156,-0.449244777413,0.459805577646,0.137280408034,0.121943240457,-1.068738402225,-0.326107977402 &
            ,0.208479040369,0.309925013057,0.166451393746,0.046479053857,-0.097540642783,0.251870111731,-1.337959395432,-0.139540957324,0.293894539227,-0.428161445081,-0.033167049055,-0.344964032823 &
            ,-0.249087466771,0.295132038047,-1.386471537890,0.171381921006,-0.051301675510,-0.349501715952,-0.264935060089,-0.151188059430,0.069960899018,0.201554398201,-0.609922625654,0.115140979280 &
            ,0.065302933583,-0.530392868164,-0.132043743531,-0.215558572232,0.042197635549,0.126386733489,-0.224776133199,-0.083747017132,0.385839348816,-0.321519627969,-0.038377007556,-0.202845142129 &
            ,0.013513592518,-0.026184621285,-0.088916611687,0.122142093063,-0.272471324275,-0.540438087531,0.027860249900,0.199740046764,0.001336887991,0.069529292503,-0.072342102694,-0.125322339336 &
            ,0.048457280946,0.153796179370,-0.010002498046,-0.074357852113,-0.043051267991,0.241809420194,-0.043642805535,-0.005143807228,-0.043720803465,0.108498727419,-0.313250029663,-0.193806601665 &
            ,-0.280163384709,0.176633699373,0.020993997870,-0.099067586406,-0.021590553379,0.026561492808,0.034976814345,0.082688058384,0.106377215326,0.177290765390,-0.015265923658,0.018570961284 &
            ,-0.403180181671,-0.127885979032,-0.208854778304,0.047016850191,-0.004028938071,0.046439330190,-0.170337275051,0.012277296513,0.199214167095,0.122089779491,-0.056614373828,-0.007112829595 &
            ,0.075839831776,0.094111269100,0.118057145435,0.054694202118,-0.075784963934,0.141794513519,0.139594811148,0.008149150810,-0.027761098113,-0.028040731840,0.044971587464,-0.085989881514 &
            ,0.084413026796,-0.128128620463,-0.238183544389,-0.143098118517,-0.167328010766,-0.008122581964,-0.034358856115,0.031341653616,-0.159135491720,0.129267637643,-0.023095946999,-0.157124467645 &
            ,0.039892375429,-0.109925950878,-0.064537693488,0.042470021781,-0.138554770505,-0.151106573441,-0.155396400857,0.124898868464,0.029813822698,0.006597336464,-0.000687951260,-0.002552236715 &
            ,-0.094388710392,-0.222844848755,0.042424717029,0.011347672601,-0.163428756078,0.266315566207,0.016713861153,-0.133261017662,0.187441135101,0.183222526755,0.047564405075,-0.049449957876 &
            ,0.147610466877,-0.031982397960,-0.123060857732,0.195766487218,-0.036456360767,-0.107752123136,0.122508811849,-0.002223858670,-0.015224100007,0.161604725930,-0.017531506873,-0.006587741086 &
            ,-0.035115506354,0.130397009807,-0.075161849403,0.068749520677,0.244817060833,0.015296259976,0.165085907751,0.087648318314,0.132434662493,-0.041132471429,0.198761785937,-0.024451055114 &
            ,-0.104848141510,-0.118401006927,-0.037270838947,-0.005403141208,-0.078327564114,0.039820183093,-0.081273798243,-0.014694651332,-0.089733491383,0.017449926606,0.066483064672,-0.057065669290 &
            ,0.174428012073,0.027398548721,0.217482384043,0.088831351440,0.144609468312,-0.067029542518,0.001499753213,0.079514930045,-0.100028145771,-0.266831362231,-0.150768465965,-0.065042141761 &
            ,-0.262142354377,-0.159545540882,0.140850939089,-0.160468397887,0.180133246155,0.177375377183,0.207907780363,0.058152033292,0.159594570075,0.051336104217,-0.077222492219,0.116231786686 &
            ,-0.164824745463,-0.050878422775,-0.154398192745,0.005707906472,0.037997235916,0.050719508773,-0.003131905979,-0.009496507520,0.145517877204,-0.169277420779,0.147358283565,-0.031324278687 &
            ,-0.087675241030,-0.328248368544,0.038484245227,-0.004468078685,-0.148946578036,0.186436658963,-0.173192498335,0.015644499093,0.032787132934,0.297087319183,0.003588493703,-0.025260879697 &
            ,-0.223196831411,0.283621141178,-0.096486204177,-0.436155431718,-0.138077717316,-0.102985520856,-0.135039623460,-0.112409529465,0.072497429354,0.403980995341,-0.003298806094,-0.074586341547 &
            ,0.004007299016,-0.174323834320,0.136869906909,-0.251669010944,0.148048414661,0.369300178506,0.074250200574,0.247537738279,-0.024302585786,-0.053954460891,0.399681366453,-0.014881795219 &
            ,0.030554508320,0.202668740192,0.159214018091,0.163036586719,0.005395341811,-0.015349550559,0.354284868246,-0.033772778540,0.178611116719,-0.003102862852,-0.097502375123,0.034783258892 &
            ,0.076143465244,0.006382563544,0.172710847019,-0.107888016316,0.161483438822,-0.085285858001,-0.158148549547,0.110793555205,-0.002234525298,0.078382995232,0.126007897411,-0.103887541483 &
            ,-0.161424834301,-0.075284640031,0.092113949078,0.136740504031,-0.064461354397,0.105045724974,0.220028273533,-0.032012112023,-0.179114731618,-0.043980463464,-0.009741663552,0.255796056644 &
            ,0.021681669925,0.017341048021,0.123843075167,-0.272493387996,-0.273012397994,-0.352653412502,-0.507973340513,0.281434764123,-0.047410653587,-0.003527181309,0.173524292572,-0.252246262035 &
            ,-0.413822702047,-0.260100331543,-0.563644617718,-0.012855641041,-0.370949971618,-0.008434168853,-0.244831649456,-0.165094552578,-0.329354658793,-0.252479010829,-0.462391079135,-0.497655336563 &
            ,-0.151359947602,-0.194291732389,-0.558367906720,-0.014472496509,0.243618760906,-0.136919756936,-0.151839504360,-0.345216778340,-0.149311884713,-0.194809966134,0.042049696254,-0.004271168891 &
            ,-0.039436025782,-0.153566483101,0.031423285115,-0.030062778144,-0.374540387761,-0.301596763167,-0.010973766601,-0.122982889526,-0.124529666191,0.135783404306,-0.030371619386,-0.144995669225 &
            ,-0.088384050986,-0.228093784016,-0.073055677415,-0.105669542885,-0.027196097340,0.122084268473,-0.052325640636,-0.190013023760,-0.118519071284,-0.293448921430,-0.144090203402,0.050916302150 &
            ,0.188297907400,-0.192342444721,0.207048533954,0.106293719361,-0.217734006431,-0.038384970910,0.165199348942,-0.120659071228,0.092880693366,-0.128235580389,0.072542493646,-0.090923935391 &
            ,-0.016161712047,-0.083768830114,-0.061544607607,-0.054090651051,0.069042991596,0.039940415619,0.206031292142,0.089355553471,0.024964124675,0.139952259671,-0.135579589075,0.073834471245 &
            ,0.258027404515,0.143460155256,0.222361820684,0.059482312631,-0.132423430497,-0.446774342321,0.073799474446,0.046072112491,0.107628143788,-0.006705547851,0.075149585323,-0.231693620565 &
            ,-0.093705287073,0.171565155946,-0.271697760898,0.059628405053,0.109448584421,-0.086902239536,0.210922154080,0.013576130809,-0.005942388196,0.056641521716,-0.108141692894,-0.042388485159 &
            ,0.197018841888,-0.310104404333,0.171544428872,0.141824169336,0.141927217464,-0.081003926229,0.229392965325,0.065325365874,0.055183621924,-0.335039505253,0.245296658781,0.067929373549 &
            ,0.069563652773,-0.135807746980,-0.108711575524,-0.031383585082,0.213858922226,-0.113921353688,0.125289965054,-0.042534018789,-0.182579629451,-0.023304189441,-0.181591635779,0.168606097171 &
            ,0.020743095037,0.115808314240,0.154576342349,-0.087091568621,-0.063268016417,-0.078714863816,-0.015283548304,-0.159958177306,-0.220778139830,0.002257764459,-0.411256335295,-0.117784332101 &
            ,-0.239718561420,-0.109011246036,-0.002432931854,0.023026701177,-0.398292841791,0.192942743782,-0.430207362774,0.044696561911,0.165909556459,0.279363632657,0.205135507704,0.010451990975 &
            ,-0.307308687326,0.773178195645,-0.412773729154,-0.005703502415,0.339769187376,1.070384945340,0.166021391564,-0.031821647275,-0.151979437624,0.125819754574,-0.104528328521,0.116996758831 &
            ,0.310968333976,0.240377562119,0.193377079060,-0.035648737779,0.059124725943,-0.101173389972,0.053292275796,-0.113637034334,-0.305667404396,-0.073357018590,0.007485141189,-0.114558486384 &
            ,0.410907247317,-0.302572233930,0.417643681471,-0.010828785103,-0.296460529029,-0.144763938980,0.066142313754,-0.147976134428,0.229680845888,-0.142871076434,0.174491483067,0.034379897607 &
            ,0.195327542118,-0.222417079679,0.044971520700,0.113530103343,-0.522883141383,-0.089873905488,-0.401991233373,0.135470238961,0.288373745964,0.210280055921,-0.006519738247,0.044380548911 &
            ,0.036525883539,0.135849427192,-0.020604316777,-0.225092866538,-0.549136931793,-0.358061845407,0.196325043129,-0.293671078996,0.255247388487,-0.143607858264,0.136099062343,-0.057675907069 &
            ,0.094395497342,-0.174288568771,-0.064798430598,0.149694040343,-0.395228536078,-0.051672396226,-0.291282019754,0.054224230927,-0.169961518199,0.315728519500,0.032583074037,-0.180270004015 &
            ,0.257338004372,-0.095641154882,0.249519795085,0.033683068492,-0.003392279780,0.054470065069,0.013767301386,-0.007132421042,-0.068078072838,-0.042461521074,-0.029238016526,-0.002237461586 &
            ,0.034881610265,-0.022556865126,-0.096068652296,0.062008468887,-0.054419685582,-0.020015616033,0.003924464838,0.102142769730,0.135352270778,0.131393636612,-0.021295122188,0.040577182068 &
            ,0.198027393957,0.116633459847,0.177120959789,-0.037921290424,-0.030215745519,-0.088870006108,-0.032782412063,0.035421129811,-0.031296985758,-0.016481693048,-0.034456069291,-0.031416064814 &
            ,-0.080926991367,-0.054501067426,0.082024863281,-0.087499780694,-0.004866055592,0.099223995844,-0.079727409189,0.005745064975,0.072553005949,0.245670598884,0.029503512449,0.007242635362 &
            ,-0.163698160690,-0.022751891103,-0.194924125229,-0.020946907482,-0.083820404038,0.029089581013,0.025048423901,-0.044349016048,0.009304509420,-0.044939468563,0.041430024739,0.044575263857 &
            ,0.123069405813,0.081941305372,-0.040814589083,0.042838628018,0.126068326056,0.094644942497,0.101088143033,-0.008057761784,0.034682178771,-0.230256842137,0.009987412225,0.063533954278 &
            ,-0.322144485614,0.017238850943,-0.352768469360,-0.060459173586,-0.109954465038,0.265674313146,0.086215725626,-0.146243446067,-0.028753887881,-0.072111252263,-0.118226896369,-0.106301526756 &
            ,-0.246499771939,-0.103913630795,0.071608456888,-0.123038159086,0.078437669609,0.161270364473,0.144804374152,0.095068506310,0.338014878948,-0.063386553799,-0.041906939973,0.174320190980 &
            ,-0.100075675958,0.062166407460,-0.142608601146,-0.102917910743,-0.196830803948,0.234901113627,0.010096549392,-0.130866003676,0.391721529980,-0.442181372709,0.511885203112,0.128512034666 &
            ,-0.027950334180,-0.486881550053,-0.159294885742,0.145109027232,-0.126469868320,0.303768639997,-0.183271046877,-0.081776896344,0.158916812220,0.002873001068,0.098635387029,0.011972563430 &
            ,-0.119435886117,-0.247190118533,-0.043031553858,-0.039926558785,-0.291484254536,-0.175125177984,-0.049036770055,-0.098479128917,0.156550240077,0.031165219612,0.173087435307,0.109502218535 &
            ,0.111327583172,0.253186183484,-0.019634365170,0.032990337038,-0.067650641600,0.179208369137,-0.149991777839,-0.051768628156,0.073559551746,0.106484208617,0.098223795685,-0.020221398862 &
            ,0.062647974543,0.077958106974,0.033550721943,-0.025388915337,0.072504555703,0.255335186892,-0.108051631790,0.080253059065,-0.087324020375,-0.025619489400,-0.094405895897,-0.032287523910 &
            ,-0.034008311755,-0.040937768202,0.044753755482,-0.042224028891,-0.053462446003,0.146952342178,-0.045261903493,0.017315371169,0.118731374625,0.072454957183,0.025304837899,0.029226947607 &
            ,-0.096836624457,-0.067262776306,-0.089503387043,-0.044889770481,-0.137888687532,-0.017884216376,-0.069204242291,-0.031382009873,-0.025834121238,0.155105916071,-0.040565659083,-0.002414331278 &
            ,0.121459277302,-0.008626204050,0.038014490064,0.038734123827,-0.018184735388,0.108447288606,-0.037393985120,-0.019411018961,-0.042997099932,0.073892051709,-0.001077706645,-0.026011129419 &
            ,-0.104086599528,0.028194202444,-0.055546533806,0.039973839876,0.121025396660,-0.073578255938,-0.016521554882,0.057537558530,0.149299412678,0.104184139704,0.070949882008,-0.045345601777 &
            ,-0.031983540085,0.007317397444,0.041773193349,-0.019056168411,-0.216679452993,0.174375177717,-0.174038593075,-0.070906554354,-0.049685443968,-0.349539912140,0.029138589387,-0.012532446113 &
            ,-0.099609300367,0.069277730614,0.020876207009,0.072504475758,-0.012855157379,-0.035053820063,0.049360489849,-0.088958329815,-0.157571008069,-0.089415825928,-0.148275362813,-0.000158332356 &
            ,-0.018984201067,0.211461874206,-0.024504436373,-0.027459476577,0.265298201440,-0.255968849776,0.241887015475,0.062655475525,-0.100048184700,0.243523791999,0.031135632990,-0.082372486575 &
            ,0.006715155260,-0.051669774059,-0.119532086217,-0.099501634655,0.071263814517,0.121107616316,-0.028694443744,0.047590685685,0.342218613040,0.011209661274,0.246856065428,-0.000431699732 &
            ,0.039264612356,0.317358324647,-0.060606426675,0.039208086823,-0.019113436474,0.110900727330,-0.129730995508,-0.139059678003,-0.009482551730,-0.094463010465,-0.078484987783,0.094266265261 &
            ,0.157597168143,0.021427272851,0.180717938074,0.024276868936,-0.046030803259,-0.035150368787,-0.031573255649,0.002047651376,-0.140535081616,0.228818502475,-0.170044566186,-0.020236443877 &
            ,0.051348952487,0.064633112704,0.006138977504,0.011684679210,0.162899917979,-0.064412144444,0.190586096503,0.061633514092,-0.153351405690,0.043447771055,0.046056936164,-0.088465886277 &
            ,0.014268064613,0.037588012674,-0.002994881228,-0.025325307997,-0.017100350764,0.002670002698,0.014297533083,-0.014719335810,-0.058568438970,-0.016300290125,-0.065361384456,-0.026610120009 &
            ,-0.043151695552,-0.057624347431,0.015891530947,-0.021805031470,-0.011516134460,0.031329013541,-0.036297875306,-0.016452745835,-0.019969583904,0.023103276735,0.016684649977,-0.014041826222 &
            ,-0.029040349992,-0.035164469815,0.005713947429,0.031439639405,0.030030727770,0.014293733238,-0.013255438704,0.007112478012,-0.001775031485,0.039317174038,-0.016301381282,-0.009903074804 &
            ,-0.007365592406,0.018105734664,0.017385484477,-0.011354935465,0.036577475572,-0.045520035848,0.051896642847,0.006691569884,-0.025312921353,-0.058110947374,-0.021440659547,0.010324639774 &
            ,0.035821772830,0.007756307329,0.038106935286,-0.011285056520,-0.035880553446,-0.043709455245,0.012445734765,-0.014680808703,-0.044742207325,0.000513336361,-0.045427414561,-0.034009667959 &
            ,-0.056496317717,-0.030444089560,0.024615468035,-0.040219676778,0.118851898887,0.114729797273,0.061280980357,-0.045703005145,-0.034222102611,0.073480216169,0.000932544174,-0.009113479457 &
            ,-0.114218295843,-0.028863606426,-0.130038316068,-0.041000951255,-0.080244884242,-0.151124805084,0.042104010434,-0.035485866021,0.059081686894,-0.084099552008,0.077506687342,-0.061098552361 &
            ,-0.110820413832,-0.049375361701,0.011510135758,-0.072582183845,-0.145455077100,-0.094726730044,-0.165390218111,-0.036604287970,-0.021174847483,0.013967691351,0.007611343077,-0.030888151773 &
            ,0.187461078923,-0.005067704176,0.208598955667,0.008082690342,-0.028187245746,-0.071890229807,-0.000163910809,-0.002598641559,-0.150629763727,0.016641809053,-0.141378388489,0.012677764662 &
            ,0.059059699890,0.074223853184,-0.002555190316,0.005384018722,0.046080272683,-0.071039422729,0.030462557115,-0.041740402848,-0.067768533891,0.041798029438,0.021461773411,-0.056040999688 &
            ,0.098094291639,-0.345278247134,0.109003072967,0.011471177003,-0.014842240006,-0.063634119853,-0.011403967985,0.000761319098,-0.044798393411,0.107383887193,-0.035071098621,0.030892281587 &
            ,0.068239440074,0.230427797745,0.032569135465,-0.032475915713,0.231318956335,-0.068542868336,0.159710258628,-0.017784814789,-0.026824443869,0.063342308811,-0.035849090993,0.036415906467 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.5314,0.017781 &
            ,0.65677,-0.012981,-1.4963,-0.012169 &
            ,1.9221,0.029648 &
            ,1.7194,-0.040448 &
            ,-0.52632,0.0060925 &
            ,-1.9382,-0.0034915 &
            ,-2.8656,-0.015124 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-2.2011,-0.25383/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.3693,0.2643,-1.4141,1.5832,0.87311,-0.78649,-2.3288,-2.3849/)
real, dimension(2) :: bias2 = &
  (/1.8166,-0.19308/)
real, dimension(1) :: bias3 = &
  (/1.1573/)
contains
subroutine fnet_mallard_initall()
end subroutine fnet_mallard_initall
subroutine fnet_mallard_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_mallard_engine
end module fnet_mallard

module fnet_ccfb_

! a = 
0.0008

! b = 
0.0160

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.150492873047,-0.303771157308,-0.081644558574,0.078984400323,-0.056304349652,-0.164857788093,0.242700195755,-0.182720160470,-0.143492849621,0.202566228156,0.252799496099,0.024715437229 &
            ,-0.043455629171,0.175973611220,0.175313557827,-0.139936670591,-0.238488451027,0.150186974452,-0.183899789028,-0.134926874228,0.141835852405,0.478400285161,-0.051489183848,0.089485226852 &
            ,0.097323743668,-0.118770098520,0.032753787994,0.103524214114,-0.058073173459,0.565435329573,-0.114317617454,-0.045740582581,0.053885259151,-0.161151724893,0.007035126909,-0.035453667198 &
            ,0.102373363498,-0.028426100444,-0.023376663154,-0.316387989095,0.172810412293,0.327780366919,-0.104366031965,-0.206716166542,0.034198184184,-0.734228946745,0.284685797988,-0.416075956708 &
            ,-0.000282146249,-0.062680323874,0.079566308918,0.121353877334,0.025880708016,-0.687161178804,0.040578410164,-0.075637582052,-0.000321830538,-0.062733982165,0.079590269427,0.121299050968 &
            ,0.025838143795,-0.687177353452,0.040507468316,-0.075675480969,0.494974794622,-0.279248021377,0.123561646479,0.010271502306,0.028005620542,0.090125456281,-0.038711259191,-1.397225770474 &
            ,-0.447905050577,0.175642040759,-0.166904921138,-0.005267217175,-0.384485096952,-0.047175790609,-0.242924552788,-2.089220218023,0.065266841831,-0.076029603907,0.092964599704,0.089518424153 &
            ,-1.245244293276,-0.090117496597,0.357301878169,-0.434534602209,0.006571356490,0.299057628937,-0.083040945654,-0.178583314433,-0.320875943938,0.524529110826,-0.674966247669,-0.159973409614 &
            ,-0.221334670785,-0.001621796267,-0.047682541323,0.041862345771,-0.620962525940,0.025859525460,0.119074327098,0.401880124212,0.216340184599,0.114535360776,-0.074981312520,-0.138185374476 &
            ,-0.541963693377,0.382023553987,0.122459759034,0.152734613077,-0.479083446779,0.200247133828,0.093822214574,0.093786971683,-0.202480914004,0.383821822035,-0.300010371709,0.351768219888 &
            ,0.026215261341,-0.078654864260,0.077266841151,0.094764899645,-0.454949832050,-0.675201888974,0.287755062870,0.607952227211,0.292563743043,0.112045137571,0.106087615994,0.006101687287 &
            ,-0.052009694084,-0.744574726995,0.073096667595,0.004483054281,-0.191207799202,-0.077425268347,-0.072154729399,-0.016210136615,0.035231748724,0.181442407830,0.254611370341,-0.265320964125 &
            ,-0.188441789154,0.079985838114,0.036417896545,0.031467630844,-0.057138007051,0.531400936861,-0.299562034951,0.275507515733,-0.020338938948,-0.236444103089,-0.043953899655,0.043115700709 &
            ,0.014404526061,-0.232636504094,0.335638436541,-0.170447433647,0.112969274873,0.179842050589,-0.255835934445,-0.225808691130,0.123970039241,-0.201227716024,0.009572275757,-0.283345212006 &
            ,-0.105206082397,0.031745682673,-0.090880331905,-0.106087707359,0.089628937763,-0.060498866279,0.299497506540,-0.201517649370,0.137735344977,0.005396548722,0.007124339016,-0.008117253959 &
            ,-0.100234408983,0.115361884092,0.204103989283,-0.123045145045,-0.106061881822,0.152551038791,-0.152617542970,-0.134607021296,0.117012889517,0.000098941171,-0.032982402533,-0.098811766469 &
            ,0.074904286841,-0.203502045990,0.198105684654,0.168669797825,-0.069180039844,0.087780576718,-0.049756747644,0.136375762003,-0.114772932677,0.216678493114,-0.111073954560,-0.091314582373 &
            ,0.045836994912,-0.197377001368,-0.169761440970,0.085981663229,-0.130328942538,0.113821883809,0.024861108013,-0.037453394757,0.000684029991,0.201708757495,0.165822455967,-0.034653787603 &
            ,0.053677638872,0.163182227375,-0.075221071576,-0.124677060410,0.069261891066,-0.047562733005,0.102376892970,0.053791551598,-0.181480318413,0.255264115111,-0.049234350141,-0.049861628760 &
            ,0.156807342643,-0.038023403041,-0.254905127535,0.070094660990,-0.032867829419,-0.108205541513,0.000883802946,0.038325326089,0.003926450391,0.257097152966,0.100157355441,-0.046631622879 &
            ,-0.159238487579,-0.020353910421,-0.045966126653,0.018827897122,0.025950097491,0.159854201510,-0.047195888293,0.062844442463,-0.003632768382,0.137949325553,-0.042678296686,-0.049548620885 &
            ,0.033343792664,-0.233028987734,0.059265953368,-0.054337833735,0.139105418655,-0.058908068370,0.090104494786,0.002940519567,0.010104471417,0.153791944437,-0.011015715612,-0.022333811823 &
            ,0.215421214112,-0.065854308947,-0.067557145833,-0.092607578218,0.057419078086,0.017659383659,0.040743217026,-0.124470937428,0.072955705632,0.078128653913,0.068391616218,0.020867484899 &
            ,-0.018394231054,-0.572775769000,0.192892676801,-0.132205994410,-0.152350433500,0.153022368292,-0.046288516204,-0.036956197489,0.025849355912,0.193565029406,-0.206597461393,0.135745394891 &
            ,0.110696019145,0.033789993308,0.195500389488,0.050680472366,0.125053838845,-0.199909019655,-0.251727422095,0.121800850256,-0.041562685621,0.142520946585,0.177111254838,0.339177548718 &
            ,-0.150220379003,0.514296800469,-0.358311509391,0.083445351912,-0.186443208258,-0.096760854953,0.463515540202,0.145870070549,-0.186252210820,0.954966369538,-0.071681948146,0.374942480093 &
            ,-0.344036513322,-0.123779406011,0.535259462138,0.288061036796,-0.288350515586,0.934829943970,0.182506088868,0.263213714743,-0.293777591417,0.231314260009,0.377879890733,0.401876027744 &
            ,-0.252635817559,0.492134398132,0.092159038370,0.033515298296,0.160045324102,-0.214963321383,0.191591065848,0.234553778728,-0.034865458561,0.175223370272,-0.055483718560,-0.013434553309 &
            ,0.043925931897,-0.094548852475,0.007780800275,-0.054808631295,-0.095039543354,0.007047783209,0.052507815775,-0.107078967192,0.136594389858,-0.140343403138,-0.111311245955,-0.013009404748 &
            ,-0.147056110655,0.115494556324,0.206023910788,0.232108781724,-0.415831870640,0.359431494810,0.290950589937,0.326081020428,0.004295947719,0.291661112750,-0.406419421492,-0.260293404650 &
            ,0.273161076959,-0.143440155043,0.272046705599,0.171892163590,-0.216286994152,-0.678476397747,0.003720090335,-0.689762500075,0.337345143046,-0.480452181991,0.011881786737,0.067256868863 &
            ,-0.493998400895,-0.825264109590,0.292719141223,0.413590850910,0.292452248220,-0.077023487009,0.404804485839,0.275515205079,-0.227044917728,-1.276665012099,-0.067669226023,0.127168071662 &
            ,0.123955723809,0.237984983032,-0.049979769631,-0.114169261396,0.167867539064,-0.525642750641,0.054974961982,-0.620089864099,0.424102390056,-0.391814948944,-0.258767106874,-0.211551555660 &
            ,0.166789180268,0.045530386424,-0.031538351389,-0.204632019104,-0.049928181592,-0.007998307327,0.221497499558,0.212582575698,-0.245373051528,-0.331205113522,0.095288194639,0.395427435447 &
            ,-0.308540830756,-0.053909843235,-0.018816999031,0.066284220525,-0.089321185664,0.092493514658,0.063434802834,0.069658330547,-0.296243054313,0.161606796758,0.014055610935,0.046551269715 &
            ,-0.084124373035,0.123223020366,-0.197660984845,0.238040626187,0.451563272692,-0.351920583374,-0.040633604829,-0.075413546281,0.153086199289,0.247473023133,0.267419609556,-0.480635741052 &
            ,0.431943204050,-0.170720562660,-0.070781914847,-0.033812925404,-0.018848610774,-0.330496975837,-0.195197628671,0.059627768111,-0.283015854634,-0.076014303537,0.090054856092,0.062035030501 &
            ,0.064147993219,0.100140056168,0.188418292655,-0.080153607981,-0.110624839664,-0.116083245904,-0.169026516427,-0.006503730887,0.023413082950,-0.113847655817,-0.175496755908,0.096284561553 &
            ,-0.012384141189,-0.093078421436,-0.190385631957,-0.067248220194,0.030025407911,-0.016223478062,0.089943743375,0.001317931666,0.088608706571,-0.162891632370,0.205881519113,0.096897778810 &
            ,-0.034596330650,0.178170810685,0.096084013524,-0.117277479469,0.147141734188,0.156589594342,0.106856420977,-0.038435732941,-0.023056598874,0.110995070722,0.014670813250,-0.022819072228 &
            ,-0.068213508939,-0.005781277896,-0.056787253140,-0.036758460721,-0.013197063454,0.146567183694,-0.179106499057,0.152455591689,-0.300733527153,0.353129702363,-0.152571450692,-0.081202748975 &
            ,0.047527490007,-0.188280187019,0.153085216308,-0.158739699711,0.433971087283,-0.004281706139,-0.035680080390,-0.188924722450,0.125320706633,-0.359076723079,0.011771346786,-0.128432125919 &
            ,-0.103350479298,0.073762330887,-0.224106866972,-0.139233308272,0.082653576946,0.035852313252,-0.073348501099,0.187486968546,-0.128335836797,0.284177587232,0.086550611486,-0.012149753556 &
            ,0.117645009900,-0.212992883083,0.316703578106,-0.363807214515,-0.121852638621,0.011960850746,0.073662950678,0.052306789485,-0.009179572122,0.372451165521,-0.065387593665,0.042675988026 &
            ,0.088585940856,-0.064355944623,-0.230243974590,-0.120076307362,0.097180145255,0.021654243948,-0.490457187713,0.365177281462,0.320102066106,0.143266068902,-0.203485917942,-0.247864021206 &
            ,0.117845189928,-0.116208901246,0.045210282483,-0.177035259661,-0.390153446678,0.042685367789,0.338610714570,0.249034152829,-0.060225293058,0.500665727314,0.027796743154,-0.049392052457 &
            ,0.314260613890,0.047576542526,-0.043437852544,-0.085940762815,-0.081355814328,-0.542336096381,-0.124309673136,0.284183831523,0.341634653627,0.062433730567,-0.094100694119,-0.147118429875 &
            ,0.096814766347,-0.438539071687,0.005501127272,-0.126058049332,-0.090405026277,0.044845294994,-0.117255868132,-0.079691450128,0.122080316824,0.010202001764,-0.064910454503,-0.135386243710 &
            ,0.017232994250,0.047571567176,-0.063721329957,-0.044326202379,0.029188605147,0.039554535200,-0.119141095656,0.061553098790,0.066011951693,0.079388384316,0.005176501854,-0.043832596587 &
            ,-0.010184820353,-0.176066675557,0.124872928127,-0.085603456345,0.001169056872,0.065515439723,-0.116800771572,-0.065433999404,0.034418811335,-0.111088173701,0.148360415368,-0.172737690839 &
            ,-0.302015311093,0.087017949903,-0.158057611214,-0.009169270989,0.020287685993,0.343967867184,-0.113094340592,0.058511218235,-0.086901679187,0.001599578698,0.001449574288,0.052129502167 &
            ,-0.026726470029,0.021891303525,-0.040779840613,0.082103764729,0.008389225462,0.085704017539,-0.073494129192,-0.039663500883,0.033622546215,-0.024500845613,-0.094666173031,0.005843459486 &
            ,0.040105743587,-0.023495621300,-0.070469713134,-0.032748517090,0.018659686433,-0.012656572867,-0.016520763951,0.004121450516,-0.083511700986,-0.080719464905,-0.045327917484,0.047937658956 &
            ,-0.003397303726,0.077761411920,-0.149315066576,0.136058322341,-0.058762819684,-0.030597173034,0.067374772498,0.083655056523,-0.048375504498,0.207425543527,-0.097021582403,0.118537671816 &
            ,0.064445106850,-0.042229696373,-0.018527656596,-0.015809425325,0.007038947700,-0.091792683735,0.144733581875,-0.144170408306,0.105148227940,0.090830668072,0.067261733077,0.005983109707 &
            ,-0.026739206636,-0.307099730149,0.025802483104,0.000454479513,0.219764632433,0.033084419469,-0.038441677274,-0.084109821647,0.021622036107,-0.471009118289,0.087550231376,-0.059517496414 &
            ,-0.164177814136,0.058234682116,0.029191945159,0.068004790876,-0.027643257058,-0.102317499514,0.013439627253,0.021816515369,0.005768009245,-0.021829824075,-0.001452975334,0.006250951794 &
            ,-0.009026709717,0.008445814883,0.002617359916,0.027841877272,0.206249532082,-0.017389933374,-0.041610564392,-0.080346384338,0.028558332463,-0.247324884107,0.000396720487,-0.007372238896 &
            ,0.155054041410,-0.128664286768,0.014850214584,-0.007214291742,0.029044181409,-0.064912811664,-0.034059344813,-0.010656555491,-0.166417460971,0.059996580678,0.065885609080,0.090638983859 &
            ,-0.033121129633,0.055738242578,-0.153104748018,0.167959050462,0.124961767936,-0.040319667981,-0.045068323686,-0.058461170627,0.021774071178,-0.146135062328,0.197947156714,-0.190697847070 &
            ,-0.089580971068,0.009334629856,0.060077956055,0.046726240753,-0.028403308645,0.111596433298,0.050538316500,-0.012303620610,0.062139578217,0.021354060297,-0.075449508389,-0.072403475838 &
            ,0.034693334301,-0.009738476418,0.045810162662,-0.091686724949,-0.015118213163,-0.056227028366,0.029395371234,0.036611185101,-0.038177609564,0.086210674497,-0.044566912726,0.095973730253 &
            ,-0.127542244477,0.050289599975,0.054071258728,0.047551759974,-0.027908645492,0.115639271714,0.048886458765,-0.017871281411,-0.031665639988,-0.008096827727,0.013600888807,0.002864348558 &
            ,-0.019840149163,0.111563781903,0.034344908889,-0.006406413679,-0.074433492264,-0.044728882814,0.006029903759,0.038878947285,-0.019273822223,0.223871839035,-0.065770711472,0.074947619450 &
            ,-0.007870668391,0.000284895669,-0.015192831336,-0.023304273570,0.000106296662,-0.047147909571,0.124788332532,-0.100156105420,-0.028424785690,-0.002665400515,0.050776242911,0.036969203028 &
            ,-0.029528399371,0.081136957729,-0.056268305160,0.082062339446,-0.250723298437,-0.059363640270,-0.016600177276,0.031803849958,-0.041533161437,0.438284646853,0.207138984479,-0.123085517919 &
            ,-0.010387201249,-0.095761217615,0.076191564634,0.052226595232,-0.092030992802,0.010715964729,0.199886781924,-0.012955433800,0.156443646152,0.124561826541,-0.069725319397,-0.077596283568 &
            ,0.064410931653,-0.681521478516,0.083425881177,-0.127378249632,0.451198750958,0.018200722503,0.051880567781,-0.047536568685,0.020778008893,-0.924148603351,0.005684740091,0.017334415634 &
            ,0.487176298739,0.040411025816,-0.048203507185,-0.099595707916,0.072567805265,-1.112771678409,-0.147021676556,0.070767591134,0.324221984378,-0.015557724994,0.054114463610,-0.019124649507 &
            ,0.007180935179,-0.458481981447,-0.174002725225,0.139574334659,0.040225139444,0.022020833842,-0.045041457048,-0.036215629959,0.030878689671,0.007485981559,-0.116710962839,0.035447378350 &
            ,-0.060252210075,-0.082150657803,0.080931496149,0.062266054545,-0.072513820473,0.387571685811,-0.053043013365,0.134763516801,-0.318938071930,0.045206843189,-0.009796348944,0.041755496364 &
            ,-0.021956227394,0.554494196409,-0.011480678475,-0.005399798502,-0.203628466891,0.011050635536,0.012810283601,0.027570802241,-0.014745583644,0.526319683596,0.027515346282,-0.028524265212 &
            ,0.031183425217,-0.006954406718,0.007393880301,-0.002934326375,-0.002992652024,-0.096967149198,0.029700385692,-0.015691402347,0.041960038088,-0.006544459724,-0.014029035538,-0.017911864947 &
            ,0.003982607244,-0.055376863040,0.017735146188,-0.013022881710,0.044029882607,-0.012707587117,0.012987178662,-0.003973481897,0.002049091620,-0.070002147883,0.010682769514,-0.007785219281 &
            ,0.002358824089,0.019355751939,-0.004596776552,-0.011515563510,0.007143876997,-0.046203564382,0.044905615726,-0.055245595293,0.025004950742,-0.006187785911,0.026059984804,0.008331239573 &
            ,-0.004251015519,-0.107074700828,0.026076594327,-0.014447211293,0.015786480784,0.013408201558,-0.019279274451,-0.017919685945,0.010122632766,-0.061331933079,0.029414691757,-0.040531378009 &
            ,0.020543877906,0.000117023540,-0.001715815912,-0.003785947435,0.001712515015,-0.076600922935,0.014938848962,-0.015774849029,0.021240174442,0.010681222076,-0.000040295275,-0.009363727177 &
            ,0.006340362890,-0.008449850325,0.012302805868,-0.030480478786,0.085505911274,-0.001989433636,-0.060247025276,-0.077625425588,0.058235107359,-0.265115145315,0.247291997629,-0.317182648775 &
            ,-0.043512082120,-0.022428051156,0.071767797240,0.046050794965,-0.017845636735,-0.089941026897,0.147372047793,-0.111158854860,-0.115248962316,-0.007283100449,0.050575244522,0.055860577248 &
            ,-0.041476768308,0.108136598644,0.028392071592,0.039759630870,-0.000723720967,-0.035992901195,0.014710477213,0.023013209055,-0.028616377777,0.088065630590,-0.067188212774,0.108579041783 &
            ,-0.055045268335,-0.017211500415,0.036306453842,0.038109737917,-0.013683518813,0.123281377532,0.025535375702,-0.028211147533,-0.072056225769,-0.047785592196,0.030276770375,0.044796112362 &
            ,-0.015306401805,0.122886663943,-0.020437545733,0.039556718688,0.009002678456,0.003781266605,-0.018771474957,-0.017790367541,0.005389377130,0.016370073220,0.076564658332,-0.072852687669 &
            ,0.054215645831,-0.053721149250,-0.005929731180,-0.002765298593,0.007176931884,-0.050649374301,-0.006978711968,-0.004480812358,0.025145335143,-0.049038388667,0.010697348050,0.019770625215 &
            ,-0.001210054604,-0.085842975643,-0.021167471428,0.024417197627,0.054308451094,-0.039331906320,0.036223009331,0.026249108099,-0.008282457487,-0.139665645005,0.024869808170,-0.005174036912 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.41428,-0.82494 &
            ,0.61388,-0.85072,0.2059,1.7798 &
            ,2.1013,-2.3178 &
            ,6.0707,-0.021943 &
            ,0.34411,-0.22955 &
            ,2.9763,-0.37739 &
            ,3.7088,-0.045548 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.8188,-1.3759/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.49476,-1.2105,2.0337,2.0168,-5.4034,0.37999,-0.17662,-2.793/)
real, dimension(2) :: bias2 = &
  (/-1.0902,0.20415/)
real, dimension(1) :: bias3 = &
  (/3.0147/)
contains
subroutine fnet_ccfb__initall()
end subroutine fnet_ccfb__initall
subroutine fnet_ccfb__engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ccfb__engine
end module fnet_ccfb_

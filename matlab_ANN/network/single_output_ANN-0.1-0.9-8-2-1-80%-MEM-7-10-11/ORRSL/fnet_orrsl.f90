module fnet_ORRSL

! a = 0.00042892
! b = 0.02218


intrinsic Reshape
real, dimension(8,119) :: input = &
  Reshape((/-0.397582037547,0.459024220485,0.317469014284,-0.100839761793,-0.293060134024,0.130764718927,0.123015748135,-0.061258515668,0.002137843691,0.091305976904,0.018021368630,-0.144495507730 &
            ,-0.051153195709,-0.027963811456,-0.023539053876,-0.078957476543,0.209492193011,-0.041918143931,0.034764963558,0.080242246138,0.164780040349,0.034723631113,-0.051572654757,-0.015205726128 &
            ,0.131776543528,-0.345748779362,0.034489500320,0.052521845353,0.135046985105,-0.283603140764,0.017740407811,0.081292917603,0.507646387726,-0.161863026161,-0.055764518156,-0.008407163056 &
            ,-0.040446667242,0.528315747207,-0.169058604085,0.142817557063,0.651414553882,-0.123612689663,-0.282055587471,0.035268573300,0.130521269180,0.290667966212,-0.291492461081,0.232911204434 &
            ,0.221879736542,-0.268432400728,-0.078041064170,0.067517056402,0.130475196522,-0.135184319786,0.000403494751,0.066640937392,0.921633532612,0.603717420843,0.570587323972,0.234586608208 &
            ,-1.087554880909,0.183635690048,-0.931767165283,-0.198627546186,0.873061863620,0.139901298155,-0.303271044328,0.213073444017,-0.250518458812,-0.190725693315,-1.697862950598,0.106807778990 &
            ,-0.093562413969,-1.501342269220,0.551822754037,-0.245613859180,-0.142082424265,1.041520042458,-0.708286103889,-0.223033215187,0.780019649757,-0.225783510074,-0.283756907136,0.259540598818 &
            ,-0.083077343679,1.103327690906,-0.664127096161,0.172416763868,0.108819622727,-0.480118868492,-0.127277210138,0.065019571337,0.772557891004,1.030019136352,-0.523331762161,0.104268993441 &
            ,-0.517069024588,-0.603122632121,0.301225517177,0.035566627498,0.624823673995,0.015468601482,0.006635097545,-0.065134849683,0.874469872514,-1.012456059056,0.094154357704,-0.019225758330 &
            ,0.522783324001,-0.309258759767,-0.182967653568,-0.111810487956,0.232067477474,-1.427395808522,0.055461081467,0.026209718340,0.006809440335,0.125444774405,0.092747703541,0.027837514356 &
            ,0.436942849474,-0.061570397026,0.069156767939,-0.189932441234,-0.062666443719,1.263572286455,-0.064622990201,-0.113828997830,0.032969520304,-0.633639725421,0.046595445390,0.090110937880 &
            ,0.059715389111,0.190632372459,0.036540152308,-0.021511169411,-0.092075343557,0.053254281061,0.150997381236,0.013977806040,-0.135867067713,-0.086931376916,0.037195717919,-0.128658798579 &
            ,-0.079007941370,0.132135735707,0.010458901509,-0.009789020774,-0.040835159657,0.047926883607,0.002553392597,-0.045222322491,0.009667626060,-0.019056230712,-0.058753064839,0.150482160850 &
            ,0.117099548923,-0.018087523053,-0.009047736094,0.113406752181,0.035548018684,-0.016341862660,-0.022777254281,0.032800736144,-0.040040607841,0.082111211585,-0.005995485789,-0.001709444436 &
            ,-0.014595025028,-0.025356334457,0.026180495402,0.077707959735,-0.030576262589,0.001536837357,0.016862809997,0.010139644563,-0.062384123907,0.118976109508,0.070454882762,0.066016494170 &
            ,-0.171156089031,0.100684119702,0.015950044292,0.038481149509,0.101858172866,-0.213345260167,-0.027166775173,0.119783101427,-0.030072766979,-0.061845046077,-0.003594379438,0.060332873528 &
            ,0.378873701100,-0.556406302612,-0.072334672809,0.326873896302,0.263166789305,0.131347733041,0.078228652809,0.168359926117,0.180773934584,-0.173931781367,-0.110976681916,-0.185458486656 &
            ,0.109700897603,0.228422835067,0.078399956645,-0.116768207909,0.003929443905,0.120596605876,0.007404987493,0.058912463069,-0.128398822204,0.022950093575,0.050717744927,0.075360306756 &
            ,-0.034539192128,0.073934364467,-0.086555024859,0.071473817421,0.066864137681,-0.023348467930,0.014453167091,0.069524717688,0.025756374070,0.124272133982,-0.235775812723,0.029434289490 &
            ,0.390944895917,-0.019305204280,-0.025234209232,0.053890947272,-0.172585418015,0.270082787102,0.011468894125,-0.094769846240,0.009727282815,-0.013664053709,0.019575820249,0.011128129698 &
            ,0.206653131095,-0.305442174586,0.042026252402,0.030048995640,-0.229323356703,-0.084281511482,0.002255882291,-0.046860002746,-0.108695527474,0.251770308562,-0.037549733391,-0.028993279961 &
            ,0.032138205471,-0.024003802487,-0.020815400533,0.004197494374,-0.150254184708,0.027466446503,0.102437011823,0.085954544261,-0.104321934463,-0.120999791528,0.033471322376,0.066979546768 &
            ,0.130168661053,-0.081708383769,-0.057982613932,-0.080729459049,0.088015810134,0.084597121501,-0.014539569614,-0.096955686051,-0.151046006842,0.095422977469,-0.030735668507,0.053039652634 &
            ,0.421085735266,-0.504611134686,0.002011050987,0.043757807220,-0.113641821633,0.209590487298,0.027497028754,-0.127290859048,0.408807074891,-0.368059378090,0.037610828691,0.052318286985 &
            ,0.002714280110,0.327584129618,-0.209354834158,-0.465119059419,0.186071871578,0.059467904506,-0.006805946778,-0.204192951285,0.134825460470,0.239264467569,-0.309701671547,-0.474758739472 &
            ,0.248293765724,-0.116495191122,-0.223427252942,-0.175342051798,-0.181105957525,0.040338571423,0.173060384228,-0.145515102219,0.545417059329,0.023090602449,0.071769735906,-0.116361529861 &
            ,-0.421027022943,-0.019758242680,0.727393063364,-0.307580275144,0.667286132871,-0.642503519325,0.058460056838,-0.450075753869,-0.222339081598,0.309863709486,-0.146855239773,-0.594407570882 &
            ,0.172306976496,-0.297811339102,-0.066670092572,-0.365347525330,-0.938849859528,0.438994440278,0.641101039930,-0.621575056538,0.331130913821,-0.215066616223,-0.273210984460,-0.236794083381 &
            ,-1.318230417439,-0.085241955169,0.536688534425,-0.491384986749,-0.292274622391,-0.024647783402,-0.120443264209,-0.451020685945,-0.812686030217,0.639443035076,0.733426299769,-0.125168690747 &
            ,-0.087616409240,-0.074282032292,0.153691146848,-0.236207547496,0.227648031320,0.506024871677,0.167034569583,0.257375648937,-0.519690905647,-0.076398833811,-0.171705478564,0.092730556429 &
            ,0.167522426064,0.378465009980,-0.103325180449,-0.039991162450,-0.621460614659,-0.741754085104,-0.146274277149,-0.015900802599,-0.493149939627,-0.284763325749,0.400280451794,0.062042049049 &
            ,-0.351827701956,-0.432839072419,-0.039892792738,0.073737096276,0.382502786384,-0.422924183014,0.438402491257,-0.143070224624,0.054833068552,-0.226223724899,0.114173316681,-0.225759175274 &
            ,-0.229556816444,-0.045364056873,-0.426417061572,-0.147060685923,-0.508143537738,-0.487493414381,-0.052351602776,-0.062129854532,-0.235477408729,0.624416729847,0.289096812353,-0.269112869153 &
            ,-0.036282344339,-0.395824384409,-0.003655200188,-0.024220817288,-0.402509253327,0.787257963549,0.056667019404,-0.168753542480,-0.444774149473,0.067313159709,0.003754680728,-0.162639909425 &
            ,-0.099620212079,0.103603437865,0.124325471365,-0.011622629379,-0.017200153436,0.041655371560,0.042421794306,-0.045831488934,-0.047848815780,0.113944475599,-0.013336597178,-0.012416549523 &
            ,0.078473271820,0.021598565154,0.000620693198,0.034619166646,0.077141602455,-0.035435902987,0.024428270648,-0.108351127138,0.082609543347,0.092665374613,0.014830963460,-0.091623806030 &
            ,-0.097915470921,0.073908755509,0.043185596663,0.059666934160,-0.088910152061,-0.137918697314,-0.001762295518,0.108586160264,-0.249435456410,0.360748288197,0.069865114211,0.091232210246 &
            ,0.037474509346,0.197586579681,0.033589828917,0.053836477089,-0.028923071351,0.011121850755,-0.025042588797,-0.171016804159,-0.087452141039,0.108698582511,-0.008047339479,-0.132946123260 &
            ,-0.028923002290,-0.004271046924,0.199885147519,0.361466384822,-0.262023557601,-0.015287503439,0.044624493098,0.250884962525,0.325481269041,-0.222594096399,-0.398483069302,0.352063472259 &
            ,0.432395610606,0.310548968743,-0.083435391211,0.110621110339,-0.776505204447,1.030595178184,0.150114758557,-0.105368704837,-0.498982338556,0.093763887066,0.114698007364,-0.211141971049 &
            ,-0.542005174501,1.539201495656,-0.430899570922,0.098895866014,0.720186463583,0.369353662926,-0.051231314661,0.294823398982,0.250869383862,-0.109243706733,-0.042409454468,0.229147398947 &
            ,-0.005218789587,0.247692398696,-0.010252717705,0.108822943893,-0.227789275494,0.039669223846,-0.049680204931,0.029620269119,0.659340272648,-0.074417502777,0.070934659292,0.025097749751 &
            ,-0.074390654533,-0.257100153692,0.113467169652,0.124795867229,0.601514227778,-0.177159509736,0.100444601723,0.042328183332,0.266233870830,-0.582536198906,0.259847987869,-0.018687149068 &
            ,-0.487522948924,-0.071158065305,0.049630760392,-0.161402661755,-0.120615789089,0.092005064415,-0.017300707340,-0.003556451040,-0.117396794250,0.053393598403,-0.004228256417,0.053522862052 &
            ,-0.023059300550,0.220588035374,-0.280460943789,-0.144758756498,-0.096655729514,0.954491199485,-0.056072436712,0.015993768186,0.251726970566,-0.474113882687,-0.079790606864,0.150346650548 &
            ,-0.129327335037,-0.081690903879,-0.018667174881,0.059503026725,-0.093956397507,0.173881033235,-0.051635469141,0.095104003637,0.111988667204,0.004587975918,-0.001096412739,0.147309202556 &
            ,-0.111439089773,0.123548827804,0.035465108642,0.010279990280,0.015371631057,0.013463725815,0.025684382808,0.156412207169,0.108683969578,-0.163869591875,-0.027625583481,-0.006629433846 &
            ,-0.024355078477,-0.009846809727,-0.009687245054,-0.048075493793,-0.004505360874,0.065164005819,0.054075623861,-0.006817940428,-0.027309431001,-0.087106359281,-0.002293700478,-0.021180036327 &
            ,0.156583317248,-0.278227206661,-0.018567200899,0.117994238092,0.261088800948,-0.036652663044,0.021788261395,0.032291740265,0.297643244795,-0.335793361108,-0.029842765568,-0.052886145287 &
            ,-0.233361091940,0.019980589698,-0.048516656487,0.056862016084,0.232028669758,-0.235591537592,-0.171691848897,0.053623767317,0.343282886242,0.005038695592,-0.033323133729,0.247742545041 &
            ,-0.390859457758,0.431300548443,0.302809305237,0.351574474823,-0.669857156252,-0.362110837248,0.051868809083,0.492106503487,-0.141665912537,0.410992481049,-0.168687515366,0.016265027703 &
            ,0.637987512122,-0.101336154763,-0.041899370004,0.168473292158,-0.430246288643,0.024531519870,0.459395016881,0.039663027934,-0.369503745068,-0.380678497536,0.163821956245,0.168259381529 &
            ,-0.276162170125,0.587480298249,0.121391558107,-0.097588891467,-0.111979156101,0.078004170085,0.040426025415,-0.173626297551,-0.012339351440,0.339882211162,-0.184362550790,-0.068793201198 &
            ,0.550305243577,0.242051916683,-0.026256258522,0.002212535881,0.048765329232,-0.231798381283,0.219446388284,0.012534344585,-0.347365748279,-0.489600092342,0.010225180506,0.090436425343 &
            ,0.200391825094,-0.500104668318,0.121750521701,0.061344079006,-0.144511907241,-0.354634216880,0.014705920458,-0.063863196756,0.216568128023,-0.343009966298,0.169777635938,-0.264388501913 &
            ,-0.734261367382,0.185192772728,0.026239818479,-0.197827679879,-0.396905610103,0.691311481628,0.114081710695,0.031428065723,-0.117580341815,-0.069928152804,0.027733280020,0.122176602027 &
            ,-0.561080289260,0.548724197933,0.397670374426,-0.156357515946,-0.378557257758,-0.410668988868,0.104608056542,-0.279974370032,-0.037384224904,0.018804895519,0.104274924891,-0.023980352584 &
            ,-0.160832272451,-0.018304305018,0.012251302174,-0.039916995941,0.080003570694,-0.138049606101,0.006356450481,0.067374515237,-0.022544297022,0.015272326897,0.002301407734,-0.007183962721 &
            ,-0.076332290746,0.086222136885,0.030039304134,-0.109544263854,0.084825265817,0.053782189328,0.016405926002,-0.070337636690,0.033494573057,-0.042189914147,0.003973807888,-0.011156555073 &
            ,-0.099184067505,0.022374918948,-0.010586034436,-0.068932180765,0.045569766039,-0.108950758747,0.059775664666,-0.110015194246,-0.040937816842,0.022406847436,0.010358603858,-0.101754141731 &
            ,0.112058582080,-0.156895325476,0.004887853438,0.027172488016,-0.176120754912,-0.002525208742,-0.017016166743,-0.003998220751,-0.010837109765,-0.024216889042,0.092757991844,-0.072307720870 &
            ,-0.073733153673,0.057779622244,0.022254152671,-0.085658033105,0.418024217434,-0.707649451485,0.175782814528,0.003782949878,-0.627302674840,0.094179537640,-0.019781578016,-0.129189417942 &
            ,0.080376213795,-0.203278769461,0.215606456103,-0.161602460443,-0.514164246927,0.224578392555,0.022233049153,-0.184651274454,0.019751045986,0.017239436376,-0.034248499312,0.233725173858 &
            ,-0.160770266281,-0.008252590145,-0.006262620426,0.315534300009,-0.091873431299,0.108182811407,0.030100088500,0.097284600046,-0.099544633409,0.069406196541,0.032314879012,0.217663251487 &
            ,-0.039493619191,0.104849399663,-0.041122551887,0.215418409691,-0.046965393934,0.013174581045,0.005901436911,0.292493790551,-0.368441052308,0.468415778197,0.047024452011,0.056491934103 &
            ,0.175670685029,-0.203869692283,0.036878879555,0.037154429217,0.001551022426,-0.042206674824,0.007876940366,0.150618507707,0.067050365435,-0.319547921591,-0.012034175313,0.015292234629 &
            ,-0.129752261277,0.047311659919,0.150748140219,-0.125020639227,0.034825141613,-0.293194987443,0.026693990082,-0.257786504692,0.010371886237,-0.098543708514,0.090277158049,0.006801980248 &
            ,0.052230656738,-0.360781871273,-0.003263869741,-0.132516942227,0.017966691863,-0.148038040468,0.056679548228,0.002567008212,0.076340031307,-0.263631867668,0.006912517933,-0.080238278349 &
            ,-0.209037171356,0.269092554869,0.058900649009,-0.016848731347,-0.026169610305,-0.027651955283,0.019064671988,0.000621340398,-0.030001519795,0.032224240327,-0.016321576311,0.030513859679 &
            ,0.033798847080,0.027723199853,0.000263695327,0.014941658666,-0.005124370680,0.010787430494,0.023259749352,-0.030767782752,-0.037485262497,-0.016036998030,0.000748347064,-0.024818345313 &
            ,-0.025730448531,0.022851693063,0.000933399804,0.002255589507,-0.000818459207,0.018407763504,0.002262766926,-0.001183911939,-0.036382117872,0.052016184050,-0.010464571650,-0.024310825365 &
            ,0.015369105902,0.026325623041,0.000343287803,0.005065180468,-0.011847696847,-0.004039632200,0.009570393509,0.032369007684,-0.015592020965,0.013238187393,0.002576823248,0.001498860973 &
            ,-0.040087374612,0.053278819790,0.011515769336,-0.084985665926,-0.018496367407,-0.004425134597,0.000907078040,-0.064187420413,-0.212205408814,0.297911963453,0.070727501746,0.020897213068 &
            ,-0.116135597956,0.069435695408,0.009031987284,0.024285753775,0.014153918777,-0.007649100949,0.069107803415,0.059965818218,-0.314458201817,0.076691363713,-0.001435510373,0.020666605027 &
            ,-0.117526563334,0.174351495471,0.151547671301,-0.066925623327,-0.393274411170,0.056012780356,0.020216291093,-0.117993433275,-0.125676056758,0.107411791540,0.163823933346,0.265678662623 &
            ,-0.157754950295,-0.176290118461,0.034432045005,0.158647589645,-0.140222423693,0.103048837877,0.186128637465,0.270415802331,-0.187414375341,-0.307324960844,0.036860549102,0.037160903726 &
            ,0.012698239506,-0.031240756616,0.023867978888,0.166990422151,-0.098743184202,-0.191490920917,-0.002466632713,0.177286291805,0.003074059223,-0.005770173796,0.013784015825,0.015300816978 &
            ,-0.035266219397,-0.088505579653,0.004644613929,0.019616431065,-0.008149691567,-0.013985264607,0.022646555531,-0.053785364913,0.018358213383,-0.093601331907,0.006259205306,-0.131256905101 &
            ,0.047751675350,-0.104221701950,0.016090077005,-0.039386272250,-0.084908091012,-0.086524427587,-0.003800697271,-0.019488904708,-0.066513263488,0.093159545283,0.055007528552,0.031862210386 &
            ,-0.198596015418,-0.045648375109,0.002928252032,0.002211419049/),(/8,119/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.015687,2.8639 &
            ,-0.021631,1.9802,0.24451,-3.2018 &
            ,-0.38696,0.67014 &
            ,0.36057,-0.90893 &
            ,-1.0299,-1.7144 &
            ,-0.026414,5.7036 &
            ,0.63609,-0.70278 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.7784,3.3/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.42973,-0.99302,2.8411,-1.6438,1.7393,1.3876,-5.6233,-0.20923/)
real, dimension(2) :: bias2 = &
  (/-0.08071,-0.01045/)
real, dimension(1) :: bias3 = &
  (/2.8143/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(119) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 119
    inarray2(i) = inarray(120-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL

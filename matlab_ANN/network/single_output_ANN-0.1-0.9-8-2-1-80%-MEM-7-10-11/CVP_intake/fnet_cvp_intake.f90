module fnet_cvp_intake

! a = 
0.0008

! b = 
0.0099

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.132651927121,0.448392398661,0.104514211859,0.109318963844,-0.067063279386,0.254269875152,-0.037840676639,-0.024664004810,-0.003550075058,-0.536463412811,0.055147000387,0.145968251317 &
            ,-0.006409636760,-0.338320462359,-0.245676804009,0.042205083149,0.176332926721,-0.086100121194,-0.089596861875,-0.116249760916,-0.362909592289,-0.326179456965,0.106676692266,-0.111728399943 &
            ,-0.086673926790,-0.029275701513,-0.445796730423,-0.248815325571,-0.208076548286,0.220924206052,0.187352678719,-0.151975520466,-0.027761111215,0.523839062597,-0.530755779251,0.053259238992 &
            ,0.433056188872,0.026395159200,-0.253258904870,0.221437252678,-0.081033557456,0.009317456416,0.072251150747,0.052943843600,-0.105330648357,0.228947889251,0.084964969278,-0.225649983320 &
            ,-0.080495442300,-0.160938650970,0.107861034948,-0.069173519721,0.087860354182,-0.044245445837,0.158369338750,0.038912403666,-0.078186661061,-0.161518636148,0.107586148407,-0.070583989830 &
            ,0.089419972506,-0.043650399180,0.157200507366,0.036735986871,0.483122872393,0.467177901400,0.219139493925,0.359823086853,-0.419031021309,-0.119046674610,-0.746957833999,-0.309908492548 &
            ,1.282276712958,0.148988941341,0.835056921249,0.200416549854,-1.600255365873,0.443291006749,-0.059917851237,-0.960694722650,0.311559117663,0.404615582273,0.066203662280,0.232050203572 &
            ,-0.506438384770,0.057765210155,-0.435781435594,-1.000437920676,0.353306611622,0.315777060410,-0.149636259255,0.105760458859,-0.480788005118,0.187976091962,-0.240398298156,-0.328922724201 &
            ,0.350630343962,-0.304482969510,0.434302567937,-0.042931291496,-0.624135119312,-0.024422997592,0.258154150687,-0.578362526937,0.445480660520,0.127477246955,0.057849362768,-0.058458615333 &
            ,-0.448305314589,0.102055278977,0.082552209243,-0.072587882560,0.067109882417,0.358093171681,0.284824365592,-0.188151729977,0.191297591945,0.199617104953,-0.031774966377,0.168469545049 &
            ,0.257882494349,-0.053708577657,-0.134342109386,-0.037361259440,-0.463508214577,0.092572491914,0.176503497188,-0.168909125020,-0.147376701621,-0.296811183372,0.046535838819,-0.109879165016 &
            ,0.028099393014,-0.116844440528,0.223378976453,-0.048572975749,0.182620866475,0.252894828795,-0.101647398003,-0.011443933119,-0.019107642146,0.097740369568,-0.065354948489,0.124201272482 &
            ,-0.023543919216,-0.349361279368,0.135521821863,0.023282538747,-0.126331977537,-0.145350809245,0.118394232469,-0.109591001818,0.075620010748,0.221263856949,0.041506270239,-0.002365246146 &
            ,0.051423707745,-0.023749318308,-0.213567055822,0.098869388527,-0.022891634423,0.009274760421,-0.376273249195,0.189374374374,0.057989509492,-0.059793608210,-0.116474314901,0.010531392423 &
            ,-0.174709663873,0.085932970846,-0.205035287806,0.045604164995,0.143632763744,0.168904979326,-0.085136837796,-0.046168118741,0.145585123430,-0.152735156899,0.217859208810,-0.041126780046 &
            ,-0.103861186393,-0.199140216693,0.071629567347,0.058479761191,-0.066253346609,-0.164563248724,0.013168931403,0.047623217821,0.009874662195,-0.074070313299,0.037530066192,-0.091299233829 &
            ,0.045313919863,0.148506322667,-0.006398987121,-0.097593197802,0.009289632865,-0.025216053021,-0.065341348655,0.089683160141,-0.019862384815,0.007382821084,0.038415720113,0.011564374889 &
            ,0.014308514935,0.127800605049,0.073926136629,-0.028669579914,0.067299408824,0.030803453832,-0.055407551570,-0.042637918004,-0.007659835544,0.084579186036,0.074321751700,0.130750264085 &
            ,0.090931975780,0.095714685056,-0.014569089656,-0.413593706827,0.113926794666,0.073063264430,0.345923816554,0.325115284567,-0.092170170431,-0.032243895506,-0.248652551668,0.146325649785 &
            ,0.008629537965,-0.014078104388,-0.116781424974,-0.026502311729,0.009004641984,-0.007866859449,-0.101548745711,0.003521431807,-0.004413836165,-0.033037093253,0.009958619187,0.018992942754 &
            ,-0.100763156205,-0.059286624825,-0.093723443260,0.134395092627,0.052855459272,-0.051244892713,-0.101684934654,-0.066760041105,0.009697775036,0.214194882017,0.008746342128,-0.106739834879 &
            ,0.101392885862,0.184839314993,0.074094760181,0.111547342627,0.056882434848,-0.054754440315,0.056106064219,-0.182698066852,-0.062277903372,0.062553023306,0.216141330590,0.064745847426 &
            ,-0.077832400432,-0.060223184601,0.042961686072,0.096938262617,0.075382314584,-0.066376235526,-0.077874960604,-0.053002269109,0.053676826055,-0.063953850459,0.240082142903,-0.051404047655 &
            ,-0.078297730087,-0.024105310899,0.042447912072,0.004684895071,0.020663531947,0.093086363263,-0.244636333267,-0.025679252120,0.032365238095,0.022664094846,0.008258565483,0.045421312782 &
            ,-0.122271552954,0.174315122914,-0.034326208677,-0.135148084468,0.253254733933,0.371137887600,0.182702092845,0.074101433201,-0.111322775857,-0.474631198798,0.784968060240,-0.302496426163 &
            ,-0.338729112046,-0.618804377063,0.255539627347,-0.241518258101,0.276701898672,-0.731382004319,1.044816849051,-0.454628870290,-0.442467107507,-0.272488653656,0.668074032763,-0.288262207810 &
            ,0.028954009179,-0.687226911652,0.684280465210,-0.162389123508,-0.397169345405,0.108783835015,0.681680904440,0.088068517721,0.107471467736,-0.309888748585,0.301280008683,0.074420942342 &
            ,0.015656600882,-0.125134494993,-0.097491686426,-0.005584647046,-0.042243896726,0.239747711646,0.215256782432,-0.092570239373,-0.228103582991,-0.239581335852,-0.323703006116,-0.152948260930 &
            ,0.511591667163,0.156076239240,-0.015489966417,0.171960973054,0.044434862151,-0.307101496228,-0.202045981856,0.200660556303,0.190733556301,0.251181101140,-0.467599732408,0.178076847860 &
            ,-0.167464359427,-0.126099029959,-0.534460285784,0.197545809851,0.021158328761,-0.157610193333,-0.406005582657,-0.512507681674,-0.570265116102,-0.073358229879,0.622219803968,-0.315658437219 &
            ,0.365737234712,-0.115666534830,-0.071020300055,-0.502608000383,-0.492754450844,-0.231068971534,0.536091545661,-0.525989469476,0.576053067741,0.413352007030,0.045299367137,-0.157821282690 &
            ,-0.673067630073,0.662417732510,0.232996775882,0.080809621751,0.214154480710,-0.036496555932,0.782868156748,0.187509289669,-0.298716665757,0.138935014133,-0.137574009010,-0.218503997242 &
            ,0.076577355490,0.059157079429,0.346276533945,0.211967841802,0.034823298363,-0.237592960568,-0.426161258596,0.036371625520,-0.309996183024,0.252577940308,-0.794506492377,0.062416879301 &
            ,0.178793751030,-0.009693816722,-0.197499180515,-0.292100692448,0.069964357129,-0.260744744669,-0.038550005185,0.119118790459,-0.193651718259,-0.035466071441,0.105866559870,-0.053050764659 &
            ,-0.194036424645,-0.246270724297,0.103067371905,0.270085569648,0.029372000994,-0.362373932997,-0.338057318729,-0.265283701030,0.237530389206,0.366661024075,-0.582397616459,0.345306949714 &
            ,-0.192158024203,-0.114270400174,-0.630152871969,0.025088420063,-0.304168469982,-0.551011546283,0.647657067658,0.195943287038,-0.004816799240,-0.161666740440,-0.024156846263,-0.305969368228 &
            ,-0.124906268118,-0.315540022165,0.125064879699,0.195377704605,-0.085257283062,-0.075804063810,0.071111244768,-0.273724693351,-0.029961189761,0.217497732758,-0.076964878836,0.026878791616 &
            ,0.177499602306,-0.091365854569,-0.335141281628,0.142234031971,-0.227097062995,0.156139481404,-0.244506874103,0.013343544257,0.166818665254,0.409482691847,0.086499935518,-0.043725728371 &
            ,0.207238655039,-0.050377932818,0.031959726617,0.058334965727,-0.054579533961,-0.422015761723,-0.286611055601,0.125957740344,-0.223506371900,-0.072818595913,0.158107866188,0.115479952651 &
            ,-0.014199429521,0.006903116836,-0.069554124110,-0.274826721827,0.138796700276,-0.014867812028,-0.064641462164,-0.197784175617,0.038824511221,0.176989484831,0.321367265696,0.231822687784 &
            ,-0.155448953276,0.135268792799,0.081971889181,0.044365005167,-0.002910950871,0.126678634101,-0.144228924836,-0.155783110710,0.260605967603,-0.208495458570,-0.319961448473,0.068560965280 &
            ,-0.192158526067,-0.317896290759,-0.002808992441,0.087893448860,0.132720102510,0.407279259872,-0.340765938932,-0.121948081851,0.037741507779,0.203464506794,-0.073028409789,0.239938851927 &
            ,-0.232505393271,0.283927979388,-0.268929570009,-0.110001035567,0.367703323758,0.503869848792,0.249608922240,0.111348148911,0.079110088541,-0.231143820319,-0.072294103133,-0.065759675639 &
            ,-0.161971920525,-0.092906124977,0.166366375703,0.099094633204,0.103596725346,0.249528641748,-0.225882571808,-0.187074059266,-0.042638181593,0.175906204689,0.103260013362,0.158176136936 &
            ,-0.114800040274,-0.069960048835,-0.185176171485,0.206442296265,-0.006112797583,0.081263495941,-0.089293529912,-0.125116518516,-0.057701378992,0.581498405011,-0.629961906794,0.195623860442 &
            ,0.224063630950,0.276682562990,-0.299723984504,0.062226070155,0.186455457568,-0.050753202194,0.386459125528,-0.633856703788,-0.122781557052,0.166554240821,0.617292429192,0.221899762125 &
            ,0.010616344306,-0.233498540995,0.187624484330,0.279809170913,-0.218734469796,0.058567284182,-0.060382113463,-0.167721086968,0.231481080018,0.264086021436,-0.146246328880,-0.140559350542 &
            ,-0.073119362920,0.063461831122,0.040747817153,0.198168083041,-0.199683176419,0.041446268740,0.016574661215,0.121198924180,0.302381558089,-0.077405164993,-0.194057185675,-0.007155421598 &
            ,0.017330169514,0.013939733794,0.047735821492,-0.063745474441,0.028655856561,-0.016249739459,0.073277525852,0.021660328531,-0.014724326596,-0.047427124725,-0.060089086831,0.083998094710 &
            ,-0.021702071447,0.026946283176,-0.026418680216,-0.026266885469,0.055057634223,0.112823363666,-0.182138537112,0.024318695386,0.059132969560,-0.054467116810,-0.011019091888,0.038003217077 &
            ,0.033636511756,0.139857543641,-0.343559365171,0.067061535604,0.042111737085,-0.037944443624,-0.017449821907,0.000542879421,0.036589353024,0.008927311041,0.030835101346,0.069502705945 &
            ,0.043064848929,-0.104107106670,-0.014977004708,-0.011246501074,-0.060284888374,0.040844914107,-0.304540151027,0.208591133253,0.048077392274,-0.000700039496,-0.056755125450,-0.099358894012 &
            ,0.007804583287,0.005412263760,-0.123401373782,0.046210344923,-0.033018177902,-0.016519674419,-0.035971646209,-0.012702445694,-0.082295187557,0.013943991355,-0.142808972657,0.141149966826 &
            ,0.052173808819,0.027326023278,-0.054794426449,-0.077075738625,-0.122272446235,-0.138588945920,0.189868510832,0.083255825122,-0.001860029096,-0.156004543089,-0.075044087565,-0.181684673686 &
            ,0.000391430067,0.054628336753,-0.125799617912,0.112192344573,-0.002746084477,-0.023457494403,-0.108197543699,-0.040193123109,0.137704630465,-0.035994172996,0.293715018590,-0.247162306784 &
            ,-0.065076083601,0.084058632330,0.272865435016,0.144731934661,-0.094966914844,0.013590523446,-0.156714858174,0.039548544400,0.032744537795,0.027585591817,-0.023356843195,-0.084188326219 &
            ,0.015553671096,0.020708915370,-0.203448745386,0.147597454431,0.000646819484,-0.088344178192,-0.121400940675,-0.021536894391,0.078315644567,0.102616349786,0.119755224556,-0.157453620707 &
            ,-0.006220416358,0.149741405523,0.152537193648,0.102572121204,-0.059772249885,0.025024220919,-0.120555586808,0.010326858798,0.029199325812,0.031241761785,-0.015130423252,-0.036873721594 &
            ,-0.086759634223,-0.112859935633,-0.000304704957,0.187188955578,-0.047808763206,0.000017568061,-0.117672565632,-0.121368437732,-0.011770577932,0.003935084947,0.144019488853,0.006214445110 &
            ,0.012445689318,-0.019544237346,-0.038402205932,-0.016376370802,0.007476194856,0.025847692031,-0.039309343821,-0.078607318452,0.060120413961,-0.031732915642,0.048478285461,0.056477954575 &
            ,0.016607897678,-0.028092853823,0.090576544921,-0.037148360360,0.003314636449,-0.023593247243,0.019951680797,0.020926531569,0.035778275846,0.037291725200,-0.007628093951,-0.046936355045 &
            ,0.002388865818,0.002296508452,0.037104274872,0.035097731921,-0.009237798818,0.022541103519,0.035215489433,-0.011876116607,0.015927121358,0.025599577155,-0.019401988920,0.010879470885 &
            ,0.011966070707,-0.006860597480,0.054106638256,0.019487220571,-0.017532170539,0.000237106866,-0.014723324951,-0.008385941829,0.012108338074,0.010421449248,0.080731096432,-0.071959836855 &
            ,0.046572005389,0.030014928162,0.070544337575,0.049409957298,0.043724618703,-0.007852994953,0.071013347549,-0.007940300297,-0.026048290583,-0.048850284980,-0.020762009198,0.022790022948 &
            ,-0.020429249373,0.034099781661,0.079081033869,-0.070713120312,0.051767152650,0.125661306834,0.114787947711,0.019618500004,0.026964567308,0.010649729516,-0.005672000534,0.003173215140 &
            ,-0.019497564596,-0.025829372103,-0.044134791237,0.024602231122,-0.005976535097,-0.032540716384,0.148641961771,0.034978082567,0.032028005100,0.024689621059,-0.028096990303,0.015529060322 &
            ,0.067761633340,0.145540832734,0.169882996437,-0.075475911594,0.091988656053,0.063934099717,0.018174338382,0.106262450799,0.016041450616,-0.130863284681,-0.232870407420,0.197971120019 &
            ,-0.133362724062,-0.241955637237,-0.204902161978,-0.107674659047,0.027895078596,0.017403388554,-0.145830806815,0.081289469557,-0.053121692541,-0.120258285208,-0.113827709715,-0.043328161512 &
            ,-0.022355717327,-0.037429690130,-0.260525193524,0.191091370943,-0.084035323870,-0.055420096511,-0.127527694660,-0.099422146949,-0.019239687393,0.079500251496,0.001022198088,-0.037334539711 &
            ,0.042013810591,0.091658538574,0.063109771126,-0.000988617240,-0.043599453962,-0.054495445265,0.022708901363,-0.015200631845,-0.013585170088,0.090898654347,0.098977492763,-0.031717449447 &
            ,0.018164034243,0.151912617948,0.246308015125,-0.271372092145,0.113916200675,0.243535007482,0.281342609220,0.124388678530,0.042556132380,-0.054092263007,0.232264084036,-0.180469349472 &
            ,-0.017515167861,0.045672621836,0.184587597245,0.064540565060,-0.003454901580,-0.015665631749,0.131828911036,-0.093306924470,0.023376436928,-0.001590206647,0.067832611181,0.018693637533 &
            ,-0.015649804482,-0.000310905862,-0.004176947980,0.000092455030,0.013487943561,0.020833686759,0.014251898235,-0.005378199135,-0.002773568512,0.012435975501,-0.013651799591,-0.001250408391 &
            ,0.012504002400,-0.001796436062,0.006583184054,-0.003703429550,-0.005420373634,-0.004196668699,0.003635650281,0.019317048263,0.002404089073,-0.005703878160,-0.010766678556,-0.011358700580 &
            ,0.005912822344,0.008677150035,0.041329773735,-0.039073452307,0.026153599076,0.019673291748,0.049942651458,0.024241559895,-0.001844039491,0.000375246385,-0.020224685347,0.033280845426 &
            ,-0.013127800559,-0.018785240278,-0.052571657981,-0.013764207870,-0.008595661536,-0.001454110919,0.018672461801,-0.003614648921,0.008567265669,0.001991860347,-0.001213329692,-0.002321215146 &
            ,0.008509921922,0.010419271195,0.025616964337,-0.007435511120,0.007162948535,0.006848482962,0.002364386486,0.012378353917,0.010132667220,-0.002488096427,0.068190664101,-0.042788915469 &
            ,-0.001313618418,0.006156482548,0.033155290983,0.012811778917,0.014263528235,-0.020503263237,0.107413983066,0.010159380390,0.000082037966,-0.050712297215,-0.061117477130,0.005941629874 &
            ,-0.000400562272,0.071344975955,-0.146775089952,0.073205271806,0.049850885300,-0.031383022354,-0.080466456190,-0.004630021841,0.019313010636,0.032513851833,0.000346855021,-0.054833800501 &
            ,0.019078128786,-0.006364045507,0.029092285857,0.029671291218,0.029074887167,0.051249208044,-0.025042791251,-0.019147521934,0.015164105680,0.010001609290,-0.001269712696,0.039998561080 &
            ,-0.020683062183,-0.008605963132,-0.119509521337,0.032064121656,0.001857923227,-0.008046252400,-0.008044496136,-0.029659309993,0.014514673737,-0.039857997575,0.065876538183,-0.017755138307 &
            ,-0.049038137551,-0.036929939198,-0.021719461650,-0.007143603332,0.029252116864,0.051947762764,0.021370095807,-0.011498665812,0.024075297370,-0.022598517998,-0.031855433321,0.041116875205 &
            ,-0.018548787063,0.015924072683,-0.021073930720,-0.002945023514,0.020049878308,0.019659964599,-0.003031935454,-0.002419000011,-0.004116232280,0.019950562869,-0.041634778653,0.047903844964 &
            ,-0.003898012343,-0.035847188429,-0.075981179123,-0.016402512849,0.013596121102,-0.012967879976,0.058227074215,-0.003482190987,-0.029041566246,-0.007745613874,-0.007077790669,-0.004359259668 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/4.806,0.14699 &
            ,-3.5773,-0.26222,-0.87088,-0.078527 &
            ,-2.1953,-0.41291 &
            ,3.6017,0.20202 &
            ,2.0008,0.24318 &
            ,-1.3908,-0.41673 &
            ,-4.5782,-0.091793 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-3.7247,-2.9751/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/4.8818,-0.21761,3.3739,0.4396,-7.184,-0.9741,-0.52669,-5.7607/)
real, dimension(2) :: bias2 = &
  (/-0.83033,-0.18134/)
real, dimension(1) :: bias3 = &
  (/2.5169/)
contains
subroutine fnet_cvp_intake_initall()
end subroutine fnet_cvp_intake_initall
subroutine fnet_cvp_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_cvp_intake_engine
end module fnet_cvp_intake

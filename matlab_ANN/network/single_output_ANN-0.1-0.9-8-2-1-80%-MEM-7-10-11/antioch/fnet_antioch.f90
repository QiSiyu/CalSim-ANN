module fnet_antioch

! a = 
0.0001

! b = 
0.0870

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.091295978395,0.012234462503,0.019944206062,-0.119729476232,-0.312147469212,-0.370462667540,-0.130243438240,-0.057128916436,0.076494318794,0.013361034065,0.011809272844,-0.043339697291 &
            ,-0.250977324670,-0.276546478544,-0.146265649092,0.022945933571,0.305903522243,0.012925995956,0.004194900844,0.013354882191,-0.565429928299,-0.085031669111,-0.156728268756,0.174451227185 &
            ,0.431828138273,0.006678766885,-0.002354263050,0.033289131623,-0.651271262728,0.000337429111,-0.156477860477,-0.056962478711,0.338281427136,0.007882135779,-0.007543450324,0.036808667902 &
            ,-0.539890983902,0.005688077082,-0.153799520770,0.343843353091,0.243409614527,0.040370341243,-0.011107541340,0.053620393825,-0.517105494615,0.120131716155,-0.151205976777,0.245441901841 &
            ,0.160260386809,0.055136594840,-0.008279527974,0.058825405031,-0.643367063663,0.251247842615,-0.153779318442,0.025017418542,0.160260383490,0.055136591424,-0.008279543024,0.058825404025 &
            ,-0.643367063192,0.251247850405,-0.153779317933,0.025017425466,-0.711140943611,0.056606753285,-0.031955574411,0.069997340927,0.112660404007,-0.087363541052,-0.185889890066,1.187181993515 &
            ,-0.417391131891,0.106280448452,-0.054436445572,0.022767140476,1.166194199258,-0.128960512416,-0.203675067062,0.720830353898,-1.159932586469,0.137709972444,-0.080551969005,-0.126545295162 &
            ,1.434940089208,0.112339481210,-0.202028405549,0.558395820733,-1.265233807221,0.130503558701,-0.062644946766,-0.162003866219,0.903957937064,0.632568206119,-0.219620478564,0.155336092822 &
            ,-0.389064110099,0.097263492382,-0.062412612750,-0.049412727362,0.716176413215,0.490922776893,-0.245541413199,0.184920464352,0.022681639214,0.138530537266,-0.075295633641,-0.033585617906 &
            ,0.851708766021,-0.012744851717,-0.270952277388,0.225557813852,-0.040115128602,0.153856410341,-0.094616550600,0.025975668680,-0.210856362363,-0.301685895642,-0.301734683808,-0.035346440390 &
            ,-0.354732658456,0.062786837351,-0.069891802246,-0.071391193091,0.108494319916,-0.319827748887,-0.230494956922,-0.051985890109,-0.102201590295,0.007463897076,-0.020618666458,-0.040303224577 &
            ,0.193956045470,0.192979214337,-0.188152974597,0.034987714838,0.197954095611,-0.037520934182,0.055587733702,-0.009613340301,-0.040471012466,0.899836827016,-0.181394975958,0.025368455948 &
            ,0.068082183797,-0.163626856168,-0.051160904988,0.153561861933,0.032468019670,-0.034273699827,0.090685742222,0.020207686958,0.014371152042,-0.050695653403,-0.082556293361,0.024134935970 &
            ,0.078666495134,0.048681337058,0.083015755469,0.015860743426,0.047319714349,-0.004757013229,-0.082940825796,-0.065520314773,0.000135025663,0.089234033551,0.045879813028,-0.014986417044 &
            ,-0.184417890207,0.047418292084,-0.085744503180,-0.086570522547,0.197876141903,0.293423900279,0.004568474371,0.012454847383,0.008242096411,0.104462278445,-0.085662728512,-0.047529649652 &
            ,0.080479803474,0.286835441930,-0.013867595592,-0.022209599848,0.032020250558,0.110340654791,-0.069133375483,-0.060985896641,-0.176030118573,-0.022059211186,-0.034664308169,-0.006234622375 &
            ,-0.058570999067,0.104621733957,-0.038703075211,-0.107352564116,0.120586396973,-0.360299862252,-0.056472897391,-0.033636414491,0.069186365810,0.124545529788,-0.005957971392,-0.143587703590 &
            ,-0.002872939220,-0.142014039156,-0.064843977192,0.010933586177,0.011191474937,0.061046151322,-0.084956547930,-0.282498309983,0.008841050028,-0.159459807070,-0.211900905428,-0.076006528178 &
            ,-0.019224824053,0.029726437717,0.020007013860,0.152264240757,-0.075579641446,0.377015470208,-0.297309822915,-0.054688029357,-0.050940411841,0.101742951112,0.010843120743,-0.215312220099 &
            ,-0.054455722311,0.028155418994,-0.382330182773,-0.046213775275,0.163327050083,-0.025093337079,0.055801614626,-0.248486298007,-0.099403852539,-0.212631123220,-0.198036409621,-0.004245836104 &
            ,0.014576001395,-0.089967477676,0.064132944164,-0.305214949834,-0.036675418212,0.046365424920,-0.410841774904,-0.006121495869,0.069743521388,-0.120959681104,0.020538567865,-0.447933873144 &
            ,-0.061684399839,0.130704043266,-0.411795709997,0.003809317060,0.010820384953,0.028138594379,-0.038159597248,-0.568645272066,-0.022450230482,0.535144546760,-0.588407799749,0.000049460539 &
            ,-0.062547292202,0.108314229709,-0.027329982103,-0.077414514396,0.023217088178,-0.597014398651,-0.665223849841,-0.009923426770,-0.083018885102,0.114624721322,0.212172982015,0.070957592953 &
            ,-0.049512700428,-0.014904559521,-0.608977937919,-0.025424232372,0.123002038307,0.027336685496,0.014758329925,-0.386953989801,0.028149249662,-0.488905889298,-0.491269012960,0.028141149461 &
            ,-0.579862170266,0.073994181806,-0.041900348033,-0.308668460151,0.059200347293,-0.221032024908,-0.067012500622,-0.068019416551,-0.295270412084,0.076488587389,-0.041554397347,-0.229591407783 &
            ,-0.048446967871,-0.102676819189,-0.079857425478,-0.069499910081,-0.121960230272,0.071341074501,-0.041191550529,-0.169204295768,-0.229239868402,0.036229353262,-0.093515427201,0.043401179811 &
            ,-0.081331521772,0.060001899554,-0.041758905274,-0.138013491591,-0.307523520045,0.106280453429,-0.103422568923,-0.209003628034,-0.164351786584,0.052344140426,-0.043497289592,-0.124925796061 &
            ,-0.308024165639,0.105841622714,-0.108363691836,0.114409011285,0.072126483651,0.056057333748,-0.046400884221,-0.118572764564,-0.146715159056,0.110574244980,-0.111190101371,-0.204250394814 &
            ,0.180502164686,0.064909566948,-0.050445228107,-0.112559750289,-0.127441107277,0.146225382403,-0.113351010802,0.291733789585,0.543055489431,0.079272990925,-0.055169417460,-0.110819786866 &
            ,-0.145428071539,0.246100879357,-0.113938127523,-0.056405965053,0.825724938324,0.086192369893,-0.088932490338,-0.097037816763,0.119043617125,0.122204822940,-0.118983494620,0.544075134430 &
            ,0.630816190530,0.066115337083,-0.081473612044,-0.136208361270,0.915279397210,-0.246314914710,-0.089346719560,0.419797898760,-0.748189670090,0.061656060484,-0.092099361330,-0.225041237733 &
            ,0.644736483722,-0.161468426814,-0.088517133931,0.185554338567,-0.906170836969,0.161957715070,-0.089189137848,-0.203944750568,-0.084545271729,-0.100423035303,-0.114073950879,-0.228508913439 &
            ,0.403987237534,0.168051602670,-0.073582856367,-0.254433018344,0.118654626471,-0.035552407334,-0.116843437737,0.118826663264,0.585245618876,0.144306835103,-0.087685905795,-0.323980446024 &
            ,0.042783777747,0.185752064162,-0.124931317406,0.176641501234,-0.458610068786,0.117537005995,-0.074764524157,-0.237191925275,0.064386411390,0.198705769074,-0.148308404711,-0.085761905094 &
            ,0.151692530450,0.127944075065,-0.067559694209,-0.105694302302,0.159885907756,0.022955478961,-0.204232460175,0.062511593244,0.175504602764,0.051398301586,-0.066257159506,-0.141433854507 &
            ,0.066079152416,-0.014195006311,-0.175942106746,0.054673434436,-0.167260519321,0.035009562324,-0.050143315616,-0.167651249811,0.052142433180,0.110333657175,-0.179492984909,-0.022935521049 &
            ,-0.172006065101,0.018033732281,-0.050664724665,0.312408500013,0.328696629919,-0.241147299291,-0.251856685495,0.013525554394,0.122333897200,0.007785633299,-0.045113443102,0.106915933998 &
            ,-0.130068578458,-0.015780240252,-0.192889092123,-0.004923032374,0.000948923284,0.000862099506,-0.039341232626,-0.041099217473,-0.066970384176,-0.127794993762,-0.133405881969,0.027517371036 &
            ,-0.034768044108,0.024210313514,-0.039790480876,-0.073568215105,-0.148359677068,-0.188788926949,-0.102275794842,-0.137172161192,0.020618127126,0.047292978644,-0.043166275211,-0.048026108103 &
            ,-0.002065607161,-0.195094756252,-0.094232392542,0.093329846541,-0.011981389737,0.049167410910,-0.042411139942,-0.021255805093,0.091692512344,-0.144886143867,-0.102022117795,-0.076084082067 &
            ,-0.001013189267,0.042856618100,-0.043139835178,-0.043279749958,0.169371300459,-0.218385402838,-0.109724897746,0.092178557407,0.122407846506,0.046407546193,-0.045311325949,-0.087653188288 &
            ,0.125865983090,-0.464308268843,-0.103781795482,-0.000861576353,0.243149902382,0.108444360551,0.033747063040,-0.372358571220,0.090282658780,-0.026495749009,-0.018770180302,0.000003778338 &
            ,-0.091196919859,0.093062729552,0.040540714853,-0.528084122478,-0.571797223013,0.653664288138,0.042464697855,-0.163168661090,0.012367166726,0.083178783446,0.038860193470,-0.400965974372 &
            ,0.218023464041,-0.490762839704,0.059189831292,0.048376505810,0.064803059396,0.018149211382,0.010907664845,-0.067118244984,-0.103985992729,-0.035241550028,0.052781942827,-0.028108340549 &
            ,-0.088569973308,-0.041813150781,-0.010650254315,0.056626919066,0.034718424654,-0.652565294465,0.194002903967,-0.017078943477,0.173568085952,-0.030105701640,0.063280618332,-0.113028831383 &
            ,0.058276343790,-0.764240058961,0.314543247712,0.061172184210,-0.212186626451,-0.018439165659,0.095983209692,0.149371212610,-0.074492065966,0.442979691508,0.203205008109,-0.054954247193 &
            ,-0.140682866300,0.042489972289,0.115868184418,0.124692635038,-0.096127550172,0.826307402987,0.260271913536,-0.042114473793,0.025030311537,0.122568176754,0.133511041496,0.041249168529 &
            ,0.217554590024,-0.226594184571,0.275072650387,0.049690523196,0.114873021748,0.105957570961,0.050328578828,0.153460940757,-0.026900860683,-0.000542693789,0.175067205606,0.008165087761 &
            ,-0.020106816916,0.055133374580,-0.009431051488,0.161174041947,0.042652300142,-0.012055884137,-0.176896153712,0.002176284296,-0.010988638529,0.057616454718,0.029104592263,0.118506158215 &
            ,0.007867011626,-0.011350030264,-0.184140822474,-0.000549428419,-0.032243758070,0.100985983472,0.024673450742,-0.031011230944,-0.029039389209,-0.051018330856,-0.228282000654,-0.012093010422 &
            ,-0.054274202295,0.008413211762,0.019133508499,-0.140238121223,0.000898438028,-0.192250187484,-0.207988714477,-0.013182734144,0.022344750488,-0.100937084137,0.006477357240,-0.242319746413 &
            ,0.074149661783,0.200178979349,-0.156316202003,0.022258439073,0.085956963625,-0.162825467194,-0.011970696090,-0.306653406016,-0.044891237655,0.288219525196,-0.094356301101,0.016506008397 &
            ,0.034082223990,-0.131099017599,0.002829727684,-0.247904873718,0.054101808149,-0.154930269922,-0.105316104976,0.012289352083,0.073737510110,-0.119890735792,0.025100804165,-0.179106329829 &
            ,-0.004435862918,-0.430490110230,-0.071994971767,0.014236088383,-0.103373737568,-0.089280919179,0.020097080629,-0.124012499228,-0.128146612269,-0.753312640513,0.008616634315,-0.047226934554 &
            ,0.008662723688,0.108319602843,-0.026585784214,0.090775623171,0.013542000023,1.334142798707,0.098406378953,0.011577982103,0.073606586046,0.171551018617,-0.127541529950,0.262102838295 &
            ,0.146774804784,-0.087484672833,0.110878148979,0.040505523213,-0.251915157045,0.061766512575,-0.163745198021,0.032011521500,-0.184337420281,0.233536300999,0.258582855477,-0.086310975815 &
            ,0.185589601427,-0.148018883626,-0.011895181978,-0.333652402725,0.075021637170,-0.140754984096,0.328844424907,0.048943477551,0.090937041325,0.062346703918,0.040343488423,0.176666906856 &
            ,0.071019777200,-0.325530830674,0.287094723437,0.030564509050,-0.147178252679,-0.033824844694,0.020019244473,0.142372361172,-0.165646051950,0.142546279467,0.264059236211,-0.064078834760 &
            ,0.180735816843,-0.047765142939,-0.105440271716,0.238059431841,0.128321883473,-0.019467521339,0.420646844533,0.058991313697,0.042001572013,-0.048516744720,-0.031216676623,0.226281561761 &
            ,0.096161971638,0.641178453535,0.437032253684,0.028043068768,-0.096363329739,0.060849150327,-0.059359643131,-0.093141861649,-0.159531560650,-0.703917895643,0.394685920424,-0.055098028708 &
            ,-0.073357203997,0.035247494134,-0.139765724820,-0.146232834172,0.003416580086,0.275318362267,0.090253459621,-0.026197044713,-0.032844251116,0.108525354491,-0.046640827301,-0.045639678604 &
            ,0.008934661479,0.066206355239,0.052412023619,-0.012592688483,-0.052995701223,0.089575324580,0.011115935748,-0.112225740737,0.044587589311,0.281497014626,0.033562631750,0.001656961103 &
            ,0.070083149076,-0.029437389425,-0.052790234566,-0.055781796051,-0.053550239312,0.110338768521,0.023071797117,0.004206151202,-0.091044730397,-0.081508943469,-0.040642741289,-0.024649223046 &
            ,0.075148042203,0.518750864157,-0.051007374155,0.000498324105,-0.012566443746,0.045097517654,-0.045598537241,-0.024125059001,-0.020911259450,-0.103618969778,-0.095759801272,-0.008371884489 &
            ,-0.074700552235,0.099720338407,-0.009209280273,-0.115314304205,-0.108581948089,-0.050145537537,-0.104981822515,-0.036781296323,-0.029530245212,0.072287027238,0.055319040845,-0.306186978872 &
            ,0.045257725090,0.364668501755,-0.033081446384,0.011517629523,-0.005319061989,0.063312339517,0.017639761028,-0.468962816120,-0.010653761507,0.415217463970,-0.159725632682,-0.002620995551 &
            ,-0.170015247466,0.173484854097,-0.174881324168,-0.832160671761,-0.053253638841,0.795290336505,-0.020669338225,-0.026157179222,-0.015334613694,0.126277082450,0.007115455810,-0.601238642634 &
            ,-0.047453625134,-0.263379793826,0.042164748400,-0.017927391642,0.086084563664,-0.008417178075,0.068256519212,-0.375412610312,0.012488618295,-0.809653920355,0.160340454682,0.017735256943 &
            ,-0.059505872966,0.038381763229,-0.113242613856,-0.438338851403,-0.135516200886,-0.745106231404,-0.030612231132,-0.050515359474,-0.054964206990,-0.148165519211,-0.079660795104,-0.295987828198 &
            ,0.001202885757,0.001082766272,0.081571274313,-0.013156400452,0.093403332292,-0.226172112988,0.117000554346,-0.101428880755,0.038641679541,-0.311573300830,0.432915297522,0.014761600861 &
            ,0.070536020014,-0.264882045450,0.074452095238,0.312087433745,0.113107984064,0.296083210986,0.189710494857,0.047106223005,0.044362031795,-0.081906442186,-0.152956540349,0.361613123729 &
            ,0.039410961305,0.690399317747,0.006160624163,0.031698121290,0.201075471683,-0.078453025498,0.006248985984,0.438607199073,0.197006424063,0.331045238052,-0.120868690372,0.086733530707 &
            ,0.015732059003,-0.101381722469,0.050132631433,0.152083030072,-0.023575585508,0.001818940119,0.383502225124,0.000996587337,0.005167016633,-0.039420389227,-0.051401891545,0.069018824204 &
            ,-0.003089034698,0.031854374828,0.222635885873,0.000492841138,-0.008026612352,-0.009425396622,0.069274183908,-0.061301761222,-0.023825254903,-0.083544666094,0.187947813610,-0.005012628972 &
            ,-0.001629948790,0.075783405204,0.006888649856,-0.073706596195,0.010807262816,0.054333162581,0.109800285226,0.002244573598,0.005718374954,0.002192032919,-0.037662794742,-0.011044381303 &
            ,-0.002873369687,-0.062366870433,0.090769735679,-0.000842948650,0.004442992087,0.003173970951,-0.043649635992,0.045671297709,0.004551325838,0.040461206984,0.085342418932,0.000573008288 &
            ,-0.029391100704,0.000965519068,0.066623690877,0.242520483543,-0.004285083841,-0.006119231364,-0.103168021421,-0.005063833734,0.019444524447,-0.069356755987,-0.012571619354,0.549285408507 &
            ,0.048070847508,-0.023917760027,-0.053736921721,0.010192127230,0.093366882944,-0.136905016225,-0.038696860401,0.234036622186,0.001823905532,0.141932217123,0.618415715639,0.019351745873 &
            ,0.070221918569,-0.146021032008,-0.246701707159,0.351446788953,0.002488798714,0.279685888429,0.359642298368,0.009405854877,0.039452558501,-0.411206870289,-0.121798479209,0.534151728147 &
            ,-0.055868709352,-0.309971110128,0.494664556430,-0.004192218120,-0.014960741712,0.080345282360,-0.100048400770,0.153489868149,0.023380902390,0.056942917294,0.644578487144,-0.000906211925 &
            ,-0.007111987466,0.091564380508,-0.072668644878,0.119842324655,-0.026575109020,0.015007986012,0.854078616694,-0.010503985329,-0.006837508562,-0.000524953589,-0.060133977870,0.356391057537 &
            ,0.020956023927,-0.186388335760,0.077474806619,-0.000053798320,-0.010400403282,-0.004831365780,-0.030896933253,0.329757209787,-0.025623552518,0.468588330354,0.344461729394,-0.008001323239 &
            ,-0.003233742561,0.049089145644,-0.003256131945,-0.214182247414,0.000495452959,0.366146836023,0.312174655856,0.000087828339,-0.019045583175,-0.120080766719,-0.107046405252,0.970250871490 &
            ,-0.126470060361,0.234784577174,0.684379832582,-0.030864367694,0.003003706543,-0.138485086213,-0.078509869795,0.566942136730,0.052322660812,0.462419004006,0.157667073294,0.012374048642 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.4193,-2.3837 &
            ,0.13812,1.0266,-0.34965,-0.56761 &
            ,-0.0090951,0.18397 &
            ,0.55207,-1.6125 &
            ,0.10728,-0.85499 &
            ,-0.25124,-0.11727 &
            ,-1.0914,5.2028 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.873,-3.0479/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-3.4025,-0.20889,0.17726,0.58072,1.0163,-0.44335,0.093618,4.5316/)
real, dimension(2) :: bias2 = &
  (/-0.68013,-1.0228/)
real, dimension(1) :: bias3 = &
  (/1.1932/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch

module fnet_JP

! a = 0.00018855
! b = 0.067331


intrinsic Reshape
real, dimension(8,119) :: input = &
  Reshape((/0.168202518054,-0.044190846409,-0.242625847908,-0.074899798111,0.146802053834,-0.058861862271,0.073672692298,-0.011599407726,0.086229462129,-0.044722438852,-0.176284219673,-0.087195417185 &
            ,0.344117891648,-0.044852474974,-0.056783021856,0.065814263810,0.098145185942,-0.046874329045,0.046252177361,-0.215871994752,0.427789787125,-0.019910572466,-0.255124322720,0.114006677727 &
            ,0.008602423121,-0.042017379540,0.141272395880,-0.171468361179,0.418752042118,0.003291606444,-0.203582882182,0.045737309772,-0.080553576738,-0.037517231098,0.199913472293,-0.162424374036 &
            ,0.424823295138,0.003777542462,-0.204884508771,0.091690439692,-0.320320122042,-0.019578865333,-0.013832758854,-0.017889669942,0.733970216108,0.011678906910,-0.083900399969,0.010467794555 &
            ,-0.113143419335,-0.015393065206,-0.104986326087,0.064451712337,0.692757584318,0.019737853115,-0.104658937220,0.008616995696,-0.335094163811,-0.016252201038,0.024405450950,-0.800467333595 &
            ,0.713049558320,0.059540718781,-0.200538764646,0.747538271064,-0.039019515080,-0.019134368285,0.001724460300,-1.452903848038,-0.221806431696,0.202815180656,0.066903998623,0.900661562630 &
            ,-0.021393511519,-0.037769648646,-0.148837812868,-0.734149302178,-0.208176429997,0.296180543434,0.172726459456,0.630372006359,0.025063776535,-0.045471412296,0.141182587183,-0.315193103687 &
            ,-0.103260290884,0.296916909709,0.144148518912,0.473657356076,-0.244592593114,-0.041769085111,0.400423558609,-0.382024837186,0.050485553747,0.330397514150,0.118279391157,0.358945014286 &
            ,-0.010452380128,-0.048939850992,0.714095985356,-0.344026150972,-0.061230598181,0.328898683350,-0.035180037546,0.262219015154,0.073164515835,-0.055495954026,0.377605483931,-0.194249357395 &
            ,-0.077841700392,0.318193608320,0.014424167034,0.294712517773,-0.129492810654,-0.070922209904,0.021309101068,0.231992188583,0.122972136990,0.195985884932,0.031239930873,0.319579543692 &
            ,-0.311019666692,-0.082833629983,0.018008941913,0.385929350688,0.005965263238,0.177280049769,0.120403037316,0.251492476149,-0.138452823223,-0.085257265134,0.335535059935,-0.087564261590 &
            ,-0.365097986752,0.197646148017,0.021781453114,-0.103397407524,-0.076584316995,-0.029696823136,0.111448812956,0.049418290882,0.070687525579,-0.085241550043,0.010397206692,0.009106116880 &
            ,0.006235367420,-0.020059131577,0.003098544241,-0.056658609443,0.083809182998,0.036380927508,0.019329614270,-0.087425350311,0.028308451486,-0.002973150607,-0.035022242153,0.032868407280 &
            ,-0.008612694079,0.020591635112,-0.031067290294,0.072831281487,-0.018403569869,0.028343110200,0.023467469158,-0.003729192688,0.008847187502,0.070421994674,0.100981660842,-0.063165408947 &
            ,-0.017747453258,0.024398139551,0.059591220309,0.009900175300,-0.171210298670,0.112193634848,0.169100563688,-0.069628779102,-0.038727835763,0.015471136917,0.018762348111,0.095656356141 &
            ,-0.216539455610,0.077651522580,0.033279960180,0.055309600695,0.004272138241,0.007296386781,-0.027225596827,-0.039022993382,0.090438229915,0.057250103174,0.029871518059,-0.113558620116 &
            ,-0.157549082341,0.030352592943,0.335278347725,0.041252120801,0.111048637372,0.061645887067,0.148603172896,-0.255223963855,0.139566005849,0.023349584924,-0.106556973821,0.028996167818 &
            ,0.179019063588,0.011129869457,0.005127723757,0.052171075373,-0.154102591487,0.031649591423,-0.051822630144,0.019156396203,0.212632818804,0.157765986394,-0.219107428841,-0.326957457354 &
            ,0.119641470141,-0.025878529188,-0.314527915177,-0.033035706186,0.227725215969,0.151184984512,-0.271526766043,0.001769096655,0.012868012517,0.015090453944,0.182480115358,-0.068263105102 &
            ,0.065616194489,0.130843492398,0.261425376308,-0.082615402347,0.067075486273,0.038714054134,0.001871657660,0.024441889927,-0.238387319840,-0.017729331676,0.018150614846,0.103436318728 &
            ,0.044552284427,0.052696677209,0.010341888197,0.028458621961,-0.133148209291,0.038306439700,0.140466354389,0.074574182419,-0.084886219610,-0.000576893814,0.095676010370,0.024693003057 &
            ,-0.011542083659,-0.052884271669,0.030362447877,-0.055214031569,0.060243997931,0.000367197217,-0.069928393685,0.021096185576,-0.032909170881,-0.041549794433,0.073831648199,0.077064621907 &
            ,0.191854541781,-0.066535332291,0.145717469276,-0.212591299639,0.307701520838,0.023857956219,0.564327090359,0.022216571641,-0.097125850055,-0.044389526177,0.030086225451,-0.094199477611 &
            ,-0.301129298901,-0.017038075462,-0.111040475335,-0.151575250328,-0.073611756220,-0.044404016245,0.031704363920,-0.034458108761,-0.230908784560,-0.025070214005,-0.102513014188,-0.138160940180 &
            ,-0.065629103070,-0.045114020437,0.075203229696,-0.047506913172,-0.239404757145,-0.028285158400,-0.126219876161,-0.092203409549,-0.046787836816,-0.045203894696,0.036487916552,-0.056998059562 &
            ,-0.270431891127,-0.027188783851,-0.113017867890,-0.100322516685,-0.078193862587,-0.044925513843,-0.004806190071,-0.073835126722,-0.233303236096,-0.025879598322,-0.102429337343,-0.086090908830 &
            ,-0.064143287699,-0.045513888946,-0.035537650452,0.018165789919,-0.193929927774,-0.024430801342,-0.085960552457,-0.027745408813,-0.119108269383,-0.045907632138,-0.101495610283,0.031884173612 &
            ,-0.137726376007,-0.022772663606,-0.082523090565,-0.039261637651,-0.323381112968,-0.047646797073,-0.379414912582,-0.170612744442,-0.093772768702,-0.026187918037,-0.028748997617,0.140839219842 &
            ,-0.164346008514,-0.053644513860,-0.578554079790,-0.052585264417,0.050392554517,-0.030535111576,0.065318896947,0.122624532780,0.079614131097,-0.070245066676,-0.634456018752,-0.065132145960 &
            ,-0.016317006732,-0.123216305126,0.063843232258,-0.193059767790,0.152858567469,-0.074816849221,-0.396973473812,-0.088015656716,0.015948387254,-0.040497214473,0.052664859149,-0.378132819316 &
            ,-0.018431686829,-0.073169277549,-0.356029514834,-0.056894213081,-0.020501676249,0.079461672964,0.065943702645,-0.462831676807,-0.237530432607,-0.075658572738,-0.352720585532,0.084874377420 &
            ,0.250787316851,0.212201197794,0.110364117129,-0.196296555910,-0.249288048471,-0.079338879459,0.006121838702,0.004482755821,0.396580140174,0.259569111592,0.024150410670,-0.293188748897 &
            ,-0.078192199962,-0.073169928383,0.050151000863,-0.001223777576,0.054260691138,0.217536359682,0.032608504899,-0.104072106141,0.022106947197,-0.067850204428,0.040638994945,-0.169129311936 &
            ,-0.007109988041,0.113160449183,-0.013241367799,0.041117464158,0.194423408128,-0.060550920456,-0.521871035759,0.062300159245,-0.091215513679,-0.064035900185,0.095096985118,0.177744790438 &
            ,-0.029711686357,0.061572247117,-0.087819537652,0.050500981242,-0.027335559029,0.117477629605,-0.218438818834,0.044862359925,-0.004876575686,0.064908996781,0.113838116296,-0.003890820004 &
            ,-0.060198325757,0.156476229658,-0.060502038533,0.041040177730,-0.165230870768,0.065703170294,0.129662880587,0.027224521041,0.045507677775,0.169013457928,0.055974372293,-0.157668911465 &
            ,0.054719919927,0.059590873018,-0.055977689953,-0.060467587907,-0.065849802213,0.157897546854,0.032728492309,-0.022905565334,0.045211589422,0.047868635683,-0.067970302037,-0.046835141677 &
            ,0.009211752428,0.165058119723,0.086801501611,-0.019722822538,0.046558993161,0.040096682763,-0.201934508434,-0.000655279874,-0.025880549088,0.161353538110,-0.014728547649,-0.046544801685 &
            ,0.224039572241,0.032298312070,-0.028686413554,-0.150679015976,-0.170111478271,0.179440448747,0.044020000091,0.101792633117,0.178097410756,0.031427140078,-0.225485001657,-0.045183656803 &
            ,-0.387033317624,0.073004351866,0.366831683207,-0.039712109877,0.019147946426,0.038481581903,-0.136960924811,-0.006939751908,0.575477494383,-0.019174037259,0.008093108833,-0.174694087332 &
            ,0.311362730550,0.054588413063,-0.172804917519,0.005115573004,0.595902263440,-0.062180608599,0.167786101432,0.420109088157,0.101057124609,0.055753943056,-0.232592105794,-0.116775917505 &
            ,0.262156126121,0.021415375665,0.032366901259,-0.042106028652,0.133687040363,0.071369415368,-0.086315536693,-0.272626244439,0.324408029117,0.143024809544,0.008673544424,-0.272548948869 &
            ,-0.426277475296,0.074810786558,0.306883182088,0.130010196572,0.249830176328,0.089116955886,0.071034918362,-0.378984528170,0.212287409197,0.073372127005,0.067991426693,-0.068246797120 &
            ,-0.263900138911,0.032715375585,0.184027908981,0.299633448295,0.468919122963,0.076137211980,-0.220026273372,-0.295669331198,0.304216895996,-0.035160033672,0.281365128842,0.143909995543 &
            ,0.099707189147,0.061015761936,-0.269291688029,0.090888149479,0.038003814142,-0.154246271507,0.025478770729,0.146197832542,-0.334494117029,0.029289770945,0.229444238062,0.103831207378 &
            ,-0.206948809970,-0.192476553342,-0.098868855710,-0.309774175825,-0.058408064329,-0.094472847131,0.112599485678,-0.019577899753,-0.059618387079,-0.012677184816,-0.096636037946,-0.075763190827 &
            ,-0.063501324234,-0.077360138529,-0.007968640168,0.044730201670,-0.021224291868,0.016234347800,-0.223422651600,0.017256736757,-0.124340735246,-0.071186955094,-0.064898487284,0.009265213230 &
            ,0.048079692132,0.025260805229,-0.031281675375,-0.231123064536,0.033162472932,-0.055346759120,-0.100478118066,-0.004969110425,0.022392043783,0.010476090151,-0.026373558150,0.009128716676 &
            ,-0.152359833344,-0.060699878861,0.045887408673,0.137741487879,-0.045033262097,0.002435760249,0.017704997694,-0.047624147119,0.018855407598,-0.057825179330,-0.146814387875,0.001067690579 &
            ,-0.075382488508,-0.012166135779,-0.121491203167,-0.027497573935,-0.156941913792,-0.056550664530,-0.008717172447,0.081522801823,0.027726535176,-0.009416791861,-0.143639831092,-0.170205553569 &
            ,0.320648765907,-0.059930987393,-0.350576427808,-0.273729270000,0.133349989701,0.121260747681,0.231513045082,-0.115472680693,0.179555989766,-0.034123588674,-0.076369062986,-0.060633047121 &
            ,-0.036437616553,0.215510255636,0.376384286732,0.165853519805,-0.196972299942,-0.005262177651,0.375620689465,0.059016566893,0.142404839618,0.188074923911,0.243699686482,-0.053616229948 &
            ,0.027172685558,-0.022324432007,-0.250602518471,0.108505979199,-0.040679394486,-0.044910644667,0.074800301546,-0.032481451270,-0.086405592633,-0.030139462397,0.022535918189,-0.003828299708 &
            ,0.329508812024,-0.171878513902,-0.241880513027,-0.032288598917,-0.052233598375,-0.038710553190,-0.002723133148,0.148318759189,-0.296964326085,-0.166308294977,-0.123671042209,0.103837872489 &
            ,-0.107467696474,-0.026415358099,0.003849744865,0.141681790661,-0.351606034170,-0.083069614130,-0.014252758326,0.004482789145,-0.002423952720,-0.045876708080,0.193018361543,0.017864348662 &
            ,0.011620552822,-0.164445908640,0.266846753771,0.080151069151,-0.083159411376,-0.085001945804,0.404844411889,0.031061266432,-0.232920105639,-0.269480610955,0.101014440888,0.081565250262 &
            ,-0.302087604109,-0.105348205874,-0.286309119218,0.249456427039,-0.110829453943,-0.204301463830,-0.499835400992,-0.271888815856,0.048381401953,0.033222327297,0.006607856457,-0.029785314534 &
            ,-0.085593981316,-0.105564816040,0.142815522130,0.000128242006,-0.042798814564,0.058504427362,0.101995309499,-0.024570989666,0.059569463620,-0.083715855658,0.016339410526,-0.066880163757 &
            ,-0.070527238370,0.073474691998,0.038629983631,0.043012564224,0.098430405641,-0.012987394937,0.131153123322,-0.042646720156,-0.058036362058,0.052651257555,0.012570025376,0.010553894901 &
            ,-0.026611821063,-0.008453673588,-0.085224184562,-0.071763845477,0.078263420437,0.011377573739,-0.243017849252,-0.027712308375,0.055651725272,0.048565214237,-0.172286362344,0.015744698715 &
            ,-0.084659830830,-0.065891261690,0.002516508529,0.009668208147,0.071466862679,0.027933357977,0.122050694025,-0.134912112448,-0.003325924943,-0.142796552160,0.134717833857,-0.004422425689 &
            ,-0.091067625484,-0.067131557415,0.052626255211,0.060926700721,-0.065592885272,-0.096901855647,-0.161515949276,0.036049957758,-0.106634230115,0.154037045222,0.039643029737,-0.143825320872 &
            ,-0.284243552499,-0.021526863776,-0.110804757538,0.157109414605,0.052806656833,-0.010535718294,-0.050997318824,-0.248397049436,0.078966858629,-0.146252946621,0.008461729221,0.038509850188 &
            ,-0.440568661295,0.032262421428,-0.022502564392,0.110233292430,-0.019061924715,0.131741290093,0.066965128462,0.069827423721,-0.314711709118,0.303467312845,0.040521323623,0.018246862549 &
            ,0.054288001428,0.050314180520,0.100464689780,0.040017076562,-0.369712047081,0.202700289930,-0.138913188569,0.100741817727,-0.100795608015,-0.041446240319,0.040062143586,0.051644088111 &
            ,0.007474915054,0.145251096055,-0.106292400555,-0.072091181572,0.057475878073,0.130562414415,0.062732650982,-0.054608531093,-0.142638394559,0.138076438091,0.081220360755,0.003679045479 &
            ,-0.273748195223,-0.092811942310,-0.035019826164,0.072945239924,0.262992088033,0.194050701201,-0.126714678004,-0.243752747638,-0.064721692352,0.064886511523,-0.038113891037,-0.025267975662 &
            ,0.111313986689,0.021231072571,-0.101924472181,-0.056506994183,-0.042986789389,0.040445059007,-0.071988059116,-0.008562342484,0.076458291864,0.196969881894,0.051593320965,-0.060601023535 &
            ,-0.023130773421,-0.021379317088,-0.017060594206,0.027882991200,-0.064102673333,0.001096652187,0.010832473020,-0.009827959055,-0.016691153984,0.028681450067,-0.010480493089,0.012057034567 &
            ,-0.024774913004,-0.021193169364,-0.060682435089,-0.002843132107,-0.003918179046,0.024804192921,-0.057793170352,0.015299485715,-0.079106765162,0.062338839526,-0.071238947088,-0.005208201275 &
            ,-0.015442078308,0.041616506071,0.028144451536,0.020586757938,-0.026656917152,-0.011247557977,-0.007731802861,0.020700732798,-0.008616752540,0.051955524831,0.043725280666,0.011605025826 &
            ,-0.031470679700,-0.042112197049,0.012114673533,0.020498257608,-0.017619930956,-0.060227167171,0.056431691576,-0.001595983352,0.005361340291,0.005645659295,0.065524662635,-0.014260641059 &
            ,0.084832718312,0.006644531639,-0.049531000258,-0.065216048008,0.043271498366,0.044664268221,0.075559193466,0.010857954285,-0.108513898381,-0.085968279065,0.006204309794,0.154578841397 &
            ,-0.226792353163,-0.003265964363,-0.086291213814,0.058179207814,-0.013588470987,-0.184649461001,0.071916394899,0.020138193977,-0.084523582599,-0.164480745793,0.059324511483,0.009980135249 &
            ,0.033936738504,-0.121197080984,-0.022192985107,-0.008927549260,-0.043897044143,-0.101559932048,0.047231309257,0.021330276689,0.045705789309,0.017514404578,-0.087512848691,-0.042777865022 &
            ,0.054010260091,-0.082719251899,-0.073181734499,-0.030859654656,-0.063763685060,-0.060819403092,0.045963652676,0.028638404194,-0.008671428321,-0.158952734554,-0.059813832073,-0.031411321015 &
            ,-0.025468378175,-0.056302872964,0.141737597507,-0.029016018536,-0.055642640753,0.009296694875,0.196807360836,-0.073200288861,-0.092357777522,-0.093643867167,0.118095595825,0.052175737010 &
            ,-0.043600980438,-0.149912227495,0.057420353527,-0.037530608813,0.026489549696,0.018369232076,-0.023224185762,-0.024192942900,0.059108408010,0.050759733615,-0.085501154718,0.025864463271 &
            ,0.075691769416,0.112045472381,-0.051293412125,-0.073238964127,0.024804427517,-0.007332513188,-0.041078046617,0.004769191400,0.127353554361,0.071760933744,0.067322754587,-0.086446635836 &
            ,0.072190438719,-0.111465892015,0.171423984055,0.090534268712/),(/8,119/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.30887,3.742 &
            ,-0.18992,-0.83748,0.061855,1.5427 &
            ,-0.58652,4.2838 &
            ,0.0046244,1.1756 &
            ,0.34979,1.1098 &
            ,0.16514,-1.0435 &
            ,0.19516,-2.3469 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.026846,2.9166/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-2.8861,0.092568,-0.36472,-3.9004,-0.2648,-0.060563,0.052086,2.1557/)
real, dimension(2) :: bias2 = &
  (/-0.27965,-0.79682/)
real, dimension(1) :: bias3 = &
  (/1.9416/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(119) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 119
    inarray2(i) = inarray(120-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP

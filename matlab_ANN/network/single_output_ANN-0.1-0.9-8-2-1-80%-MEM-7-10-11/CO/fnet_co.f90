module fnet_CO

! a = 6.5379e-05
! b = 0.088568


intrinsic Reshape
real, dimension(8,119) :: input = &
  Reshape((/0.098253225418,-0.091391083983,-0.060188255310,0.154022101245,-0.225425134590,0.023351090737,-0.067549390468,0.136471170660,-0.402566204177,0.084067968822,0.073744982889,0.026285399468 &
            ,-0.701391400796,-0.219401531203,-0.175478379807,-0.171772429368,-0.327588183143,0.182425100814,-0.100924870435,-0.325545709249,-0.321603654236,-0.320881145856,-0.229153000544,-0.241828866586 &
            ,-0.297741586911,0.207837706175,-0.084468351162,-0.327300785640,-0.210115857286,-0.319432406917,-0.189192860895,-0.164115970047,-0.473922641214,-0.138831262152,-0.165592701693,-0.353391112079 &
            ,0.131619413260,-0.527698344752,-0.107172972218,-0.059865763880,-0.631730158745,0.256650479151,-0.200300019159,-0.216798965036,-0.092930297539,-0.556721112856,0.246185179238,-0.004008420935 &
            ,-0.060773406386,0.102460423891,0.100848619282,-0.431216604397,-0.112078221544,-0.706693255681,-0.217263815435,0.125080408734,0.096206682001,-0.020617421814,-0.977750571961,-0.741851720772 &
            ,-0.340568559554,-0.648606431483,0.204465925543,-0.070258850736,0.299825840171,-0.201653338218,-0.402624383172,-0.141458642849,-0.418310988018,0.591261056028,-0.163353028519,-0.648258929793 &
            ,0.255773843222,-0.594191504800,-0.517856361595,0.216374925760,0.090526507720,1.649736869462,-0.364312536690,-0.751420802722,0.174075264504,-0.311977868655,-0.481197294989,0.388597789783 &
            ,0.624342898961,1.009132443567,-0.276416533033,-0.552044202707,0.154011784269,-0.128998704802,-0.302979684408,-0.277532730600,0.524428225233,0.536375594388,0.382643058635,-0.240368116733 &
            ,0.560526981641,-0.180357532003,-0.019236829002,-0.481954344244,-0.017305259751,0.336828126215,0.354177646365,0.401140682156,0.305605096830,0.066331590009,-0.109883759857,-0.212766161854 &
            ,0.026341094878,0.180938445783,-0.226682986482,0.061952800335,-0.038784491490,-0.212367434940,0.066218253496,0.281924935453,-0.007138955455,0.046541832689,0.068316334577,-0.330212264868 &
            ,-0.181412351991,-0.069189079313,0.070015162013,-0.211048951774,0.034584136567,-0.135966195469,0.160369209901,-0.093955357715,0.077768048470,0.452956756604,-0.174728113501,0.002237442109 &
            ,0.067120388282,-0.005240482260,0.176378175408,0.355831230615,0.016197298795,-0.085538474590,0.004513376687,0.202920307974,0.003105677293,0.114156066314,-0.044908854858,-0.100855202339 &
            ,0.075642710449,0.041031956171,-0.025539147485,0.041059003953,0.073549630108,-0.032129508391,0.309321589245,0.306355483893,-0.267285589391,0.093510236461,-0.016888767137,-0.283935044622 &
            ,-0.007753675652,0.044165856321,-0.341368813487,-0.308279548448,-0.025477503542,-0.090125116256,0.038498474457,-0.001265638800,-0.036506582125,0.057049484275,-0.129193391812,-0.152009848682 &
            ,0.084277141113,-0.048240476754,0.028381001241,0.157451674567,-0.059345836232,0.100683852965,0.003484234848,-0.031496924518,0.099782973406,-0.060204613669,0.039291422841,0.008639869184 &
            ,-0.045033833720,-0.032708763590,0.152080653391,0.154686624308,0.001598968250,0.006980837861,-0.010812281771,0.186174124320,0.063390352674,0.003942770890,-0.130629051940,-0.157593177851 &
            ,0.059590807684,0.180721388447,-0.003523971407,-0.123418017558,0.035722485442,0.023019133731,0.404953450375,0.469733148963,0.148292523740,-0.298076151489,0.068451083477,0.497461105143 &
            ,0.121363609186,0.059659624967,-0.171407117799,-0.284547819011,-0.345999881211,-0.065608186697,0.081357616230,-0.046381387205,-0.053297317299,-0.100072409855,-0.368890041035,-0.436707249202 &
            ,-0.205703541634,0.182948572016,0.034655451946,-0.447096239060,-0.162131140927,-0.126348685097,-0.262088075393,-0.057744603085,0.107330331222,0.437775738662,-0.170487664340,0.309282814543 &
            ,0.058748543787,0.089289756533,0.035114773236,-0.002617943215,-0.201991057114,-0.131383049355,0.044714431495,-0.094553691646,0.021909427645,-0.063571306223,-0.093557840085,-0.091090144436 &
            ,-0.286855917299,0.213889867606,-0.052731382723,-0.196689069653,-0.059471451440,0.060080320387,-0.305259902639,-0.237908578028,0.056832594926,0.208504108237,-0.108393489973,-0.061862340866 &
            ,0.108866266896,0.035473172361,0.011238741855,0.078518950878,0.032919012783,-0.200184900296,0.066241506514,-0.120069115759,-0.016423932599,-0.008870318005,-0.035119356463,0.034461601185 &
            ,-0.232042463478,0.091567035586,-0.016345600982,-0.063965525970,-0.031599112452,0.025892588410,-0.186882094772,-0.244680270571,0.004878268416,-0.014098380533,-0.051325841837,-0.136243734438 &
            ,-0.011427363909,0.119716822733,0.117628251510,-0.021897812582,0.071799984459,0.215023298139,-0.046263674902,-0.054627299498,-0.149191473000,-0.085753073001,-0.240725687182,0.353418292894 &
            ,0.115089754783,0.155652547936,-0.057068158085,-0.091674977835,-0.017649570621,-0.180852135762,0.004562069131,0.068631914164,0.070756532038,0.072301614193,-0.056959904501,-0.135278603431 &
            ,-0.020764876466,-0.112020933202,0.278708381605,-0.147030265636,0.101023861996,0.131424529622,-0.027795993506,-0.044410105094,0.149031142622,-0.235101938119,0.042424218852,0.102645967222 &
            ,0.371637238089,0.004384288118,-0.221732241309,-0.229937689371,0.371668172568,0.047378262856,-0.075066186346,0.193424932003,0.196487159905,-0.084565241250,-0.131491634627,-0.333945026630 &
            ,0.188541217538,-0.013503330862,0.014541631555,0.120609466169,0.371296660852,-0.202255728950,-0.128160023199,-0.406140275270,-0.241078902551,-0.281445680709,-0.177259887776,0.241489873265 &
            ,0.101390771830,-0.028140922608,-0.029714246282,-0.546007846786,-0.237972910418,0.085742313069,0.431005974862,-0.159469504482,-1.018570409618,-0.519920016712,0.266641819792,0.425000268490 &
            ,-0.527809947604,-0.158840787997,0.337874734748,0.356921630228,-0.462714960909,-0.225095757777,0.062825210684,0.078463885778,-0.336197797015,0.346234217073,0.420339707015,-0.035486451526 &
            ,-0.336414474823,0.030261643000,0.071574287294,0.442871053888,-0.232674644733,0.086439616219,0.216785844914,-0.248349161067,0.043120360835,-0.274364303778,-0.224267478282,0.646211242899 &
            ,0.299238341315,0.481550529149,-0.384594927400,0.102478126026,-0.349946154433,-0.316651215081,0.193949302987,1.215750339722,0.000254280900,-0.236530644736,0.036034035275,-0.130236311658 &
            ,0.121372812982,-0.316155758881,0.045409960722,0.702529223890,0.191579420075,0.011141469922,0.219383377617,0.130446314353,0.230998489251,-0.059335643178,-0.288015934851,0.200364054607 &
            ,0.385550840596,0.453740655878,0.086527548495,0.095685721206,-0.298148634742,-0.056703698318,0.122357322390,0.383695728117,-0.449161088502,0.162209401448,0.310095314758,0.094904711840 &
            ,-0.339421771148,-0.106895800143,0.030122393767,-0.533917899163,0.118442960403,-0.109007738328,-0.015907140059,0.029665008952,-0.035342256774,0.101461271423,-0.028556904628,-0.241423347896 &
            ,0.029206444048,-0.024260251989,-0.224987048275,-0.099359849268,-0.058769014415,-0.002863381067,0.040599465464,0.033791110999,-0.089145914764,-0.018249243029,0.065110396448,-0.086917678181 &
            ,0.051190172716,-0.562811453285,0.243386981275,0.071011751684,-0.162203766114,-0.053580164945,-0.087171450397,-0.236745084732,0.127779028728,-0.107711558032,-0.015773260840,0.087617088847 &
            ,0.150358519440,0.040832658764,0.108754952328,0.114671419389,0.016880222984,0.048548358289,-0.056047156142,0.151359179180,0.071712570538,0.042996017884,0.100745375371,0.113009898160 &
            ,0.282871876860,-0.064246607894,0.019348879979,0.275345972492,0.064551996264,-0.022071190872,-0.097253412942,-0.135367115930,0.187903623057,0.034545496520,0.127512230459,0.451644142269 &
            ,-0.597221482021,0.533674149358,0.354686881013,0.080288505247,-0.145220892802,0.120859831607,-0.172993725025,0.760662230199,0.445343993941,0.037584157340,0.512759282341,0.425453025243 &
            ,0.250909093031,0.450109075089,-0.210236263948,0.506099314003,0.327786725974,-0.326986311621,0.584210391112,0.669264241164,1.010646377986,-0.266131919323,0.134847435068,-0.065121851239 &
            ,-0.066829299935,-0.061881560890,-0.676389538712,-0.414937171764,-0.174350282946,0.210577496569,0.060990836147,-0.809846852867,-0.245192450445,-0.125929465394,-0.235842285917,-0.092408713144 &
            ,-0.363496132967,-0.313153279692,0.007607904985,-0.410692263729,0.219137865672,0.100846319812,0.315030516510,0.253683438074,0.127337060331,-0.273977603616,0.101093088009,0.093577721397 &
            ,-0.046871233492,0.039540787202,-0.013918103512,-0.167312492790,-0.021094512540,0.162398546565,-0.113390233985,0.754138741457,0.146433837601,-0.042685486516,-0.424926306936,-0.363074913512 &
            ,0.037141694341,-0.452910234289,0.110530970837,-0.296517123739,0.057248666693,0.095486152055,0.376034026192,0.296395864485,0.465835223398,0.292522646526,-0.060233887507,0.621365668716 &
            ,0.024963115198,-0.162989118339,0.586192977229,0.523278254057,0.024345538119,-0.023108330492,0.071637627949,-0.378205848462,-0.138405668472,-0.139777060563,0.072871384870,0.183005161987 &
            ,-0.062292398478,0.009693856551,-0.057330818879,0.099739293665,0.039683013164,0.254910072454,-0.447877276210,-0.435802167277,-0.104872682211,0.024128864493,0.021119555593,-0.002580615382 &
            ,-0.056028323398,-0.052735587268,-0.073613037086,-0.076948456276,-0.089784757543,-0.122071641991,-0.051001199920,0.133474026098,0.189870021105,0.012307511981,-0.185861674612,-0.141911544083 &
            ,0.137352479246,-0.187106303288,0.083731002719,-0.015800445841,0.010205744869,-0.042675628497,0.056746241631,-0.008602524882,-0.234481312668,-0.194798470186,0.018926206160,-0.190443271566 &
            ,0.012744457968,0.098810062549,-0.272662414232,-0.216287277147,-0.127700983078,0.067238286467,0.003231020200,-0.447038622921,-0.022866003540,0.009505803415,-0.182217108269,-0.096574887311 &
            ,-0.316209932540,-0.623674450263,0.291925908333,-0.317733606261,-0.080721581872,-0.290676931713,-0.312076680900,-0.369383333355,-0.136910156549,0.166937618146,-0.062174984713,-0.018078788250 &
            ,0.021905695435,0.004478989341,0.144938666714,0.074488594834,0.150200383270,0.172771200440,-0.014673397971,-0.308334409267,-0.141337526814,0.044103746128,-0.006731350296,0.142661709464 &
            ,-0.476829728637,-0.006776033832,0.038687194295,0.342952728722,-0.123889199524,-0.046237738715,0.541361246245,0.362167920835,-0.256620022145,-0.106772896400,-0.009242822448,-0.162444975824 &
            ,0.178800917924,-0.029670949622,0.072124857715,-0.048823678869,0.061859351887,0.150375807300,0.033429754413,0.371278869807,-0.352410260929,0.075725824299,-0.256903998172,-0.137379086484 &
            ,-0.205164957032,0.279506318711,-0.069102221470,-0.350343114704,0.018563649067,-0.073087857799,0.459233379720,0.396608296448,0.228090137427,-0.209319436198,0.052144237186,0.064693865184 &
            ,0.090509269675,-0.033047260843,0.005344591450,0.042259073254,0.048476427531,0.496522761552,-0.220222331639,0.720917268546,0.084530103287,0.102444978572,0.159548435912,0.082206332178 &
            ,-0.060731738438,-0.152172161399,0.023729412013,0.026717714212,0.139921089771,-0.100203124322,0.249139123780,0.218728589889,-0.072241248376,0.220676113625,-0.098253208647,-0.047036928281 &
            ,0.073829324924,0.073846545213,-0.010478121505,0.048947361516,0.014327600685,-0.180361341854,0.034286070130,0.055344511765,0.054666681678,0.050118834714,-0.088192951476,-0.103115538450 &
            ,-0.152815736043,0.131041609266,-0.039301046151,-0.080119819507,-0.004454165699,0.038001804612,-0.171918707597,-0.151826096158,-0.046322770897,-0.012454802966,0.033575046227,0.009563276044 &
            ,-0.065762013228,-0.025076808037,0.030431473060,-0.026345694143,0.117580868463,-0.004971960698,-0.030146251185,0.018642270184,0.070224136143,0.044677006052,0.132237678955,0.180118480898 &
            ,-0.218584167991,0.112029090935,-0.039051412422,-0.140587847665,0.018446933416,0.000160877643,-0.401912597111,-0.317205756722,-0.074857060125,-0.028596294247,0.031551203504,-0.067948066209 &
            ,-0.105583196053,0.056593347272,-0.065121726231,-0.097597486510,-0.168421003400,0.134876305774,-0.033735276391,-0.364640203919,-0.048190538029,0.050222110291,-0.386156220512,-0.206144118948 &
            ,-0.223005661220,0.172497240121,-0.071060310377,0.000518382874,-0.041186645462,0.060234796170,-0.263229938004,-0.239517352925,0.354159368109,0.085579063823,-0.068203287548,-0.006631399873 &
            ,0.163622437826,-0.136526885910,0.611844167868,0.725057316758,-0.067327065262,0.076188229743,-0.053206985726,0.049609939262,0.106859566381,-0.031458865301,0.049315604675,0.006132076224 &
            ,0.191689940713,0.022381962228,-0.044632077455,0.203817626528,0.138605880775,-0.016328544001,0.494725012859,0.463770594051,-0.025844689985,-0.051618578201,-0.031804645863,0.320146600815 &
            ,0.094865028805,0.108652041800,0.146917162821,0.017597226267,0.330690613471,-0.218649199748,0.064748104660,0.186194865073,-0.042409167570,0.127976684603,0.217266441260,0.208254238753 &
            ,0.188919369829,-0.308298560498,0.103527763280,0.357005592933,-0.143004463557,0.152928731685,-0.206255961352,-0.332816074938,0.287034996163,-0.227028699222,0.072296694581,0.090307278168 &
            ,-0.102178393706,0.039554443882,0.085225495732,0.112274024650,0.002802496588,-0.146087213075,0.043949238954,-0.036401517717,-0.030421321495,0.020105482349,-0.252516375544,-0.259462857030 &
            ,-0.051357073077,0.027118669648,-0.013413512317,-0.020877884000,0.021089153748,-0.007688689773,-0.005225580931,-0.003273884213,-0.005704393149,0.001140382477,-0.004007959758,-0.014102262581 &
            ,0.004312678832,0.003766238760,0.003705029168,0.012646778686,-0.025615609880,-0.000801274197,-0.001989826311,-0.026281839434,0.008484158581,0.000991463433,-0.044643023324,-0.032004949465 &
            ,0.060192712619,-0.021362092519,0.022644035910,0.032713876319,-0.049870200720,0.001100514314,0.072040962197,0.057263647447,-0.039150392683,0.047821357594,-0.020087013004,-0.013414643305 &
            ,0.018338568452,-0.010133294573,0.010656808613,0.017994571456,0.024428850683,0.021650801740,-0.006138207676,0.017462988114,-0.009467734120,0.003112820672,0.054411058499,0.062907242030 &
            ,0.033145662297,0.024308728573,0.004509124811,0.000033062121,-0.033445310544,0.004570480445,0.048376397099,0.045017134897,0.053024615582,0.109019111575,-0.009147573666,0.019963697639 &
            ,-0.046066777000,-0.066178223679,0.273686061720,0.247243117384,-0.026107973978,0.021560211580,0.046378316920,-0.124345586678,-0.094473332478,-0.083673036425,0.101968134515,0.098614586494 &
            ,-0.209537595093,-0.038227086871,0.009961882786,-0.169757676510,0.043649138177,-0.031695667778,-0.088439530321,-0.099658650608,-0.053555161031,0.019309505414,-0.019333943343,-0.057578080473 &
            ,0.073065030800,-0.040829105385,0.015938068678,0.022520787915,-0.052859655229,0.077800059883,-0.045547211579,0.025216581467,0.065379002990,-0.007665145415,0.044557488713,0.046592675450 &
            ,-0.071717600419,0.011111793101,-0.007178855052,-0.154629281660,0.043670542027,-0.038801663141,0.018849862194,0.040449773043,0.064545041740,-0.161235910177,0.025452325358,0.069695502035 &
            ,0.069923867632,-0.007195436859,-0.096555300271,-0.078169296384,-0.024343827127,-0.023007116885,0.003691682675,-0.083580236245,0.030824102187,0.000561395091,-0.137005626522,-0.117610579548 &
            ,0.015267009817,-0.027799543473,-0.005702331530,-0.037954702831,0.057698525345,-0.010495383634,-0.179261096228,-0.145430174678,-0.335601264364,0.132995904090,-0.030791598185,-0.359906079945 &
            ,0.010226650960,0.007805204268,-0.371453808185,-0.332468997584/),(/8,119/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.4934,-0.16024 &
            ,-1.5282,-0.26232,-4.8148,-1.852 &
            ,-0.72803,0.41936 &
            ,-1.7104,-0.52566 &
            ,-1.5805,-0.91867 &
            ,1.736,0.071537 &
            ,-1.9182,-0.28339 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-2.3757,-0.12993/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/0.017601,-1.4106,-3.5764,-0.042198,-1.4196,0.71548,1.2513,-0.78287/)
real, dimension(2) :: bias2 = &
  (/0.51923,0.61072/)
real, dimension(1) :: bias3 = &
  (/1.5056/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(119) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 119
    inarray2(i) = inarray(120-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO

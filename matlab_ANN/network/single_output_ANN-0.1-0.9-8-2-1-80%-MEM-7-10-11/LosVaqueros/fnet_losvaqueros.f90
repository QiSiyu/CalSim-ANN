module fnet_losvaqueros

! a = 
0.0006

! b = 
0.0292

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.325559063423,0.250349194833,-0.363750013772,0.188744973376,0.250496192682,0.202371701484,-0.191117850084,-0.095722285793,0.295191240364,-0.134133612902,0.260152948878,0.089075044776 &
            ,-0.247869812300,0.290852666737,-0.178916558909,-0.203377936415,0.159967636958,-0.117036318094,0.444937858122,0.022198064795,-0.033387139574,0.286977786346,-0.001524602707,-0.001628542519 &
            ,-0.043549983819,0.303266018187,-0.050873759834,0.044310377610,0.096212185054,0.532787201781,0.219728916660,0.136329089055,-0.004186061737,-0.043933494451,0.201432395442,-0.113600237878 &
            ,-0.003783270646,0.432204446508,0.024018647182,-0.004292941940,-0.103090273848,-0.482561665788,0.159594271549,0.449363320087,-0.023330433161,0.160492503684,-0.008426532388,0.011695994649 &
            ,-0.010515674944,0.075745719929,0.141593749786,-0.024838242029,-0.359646654914,0.160774682497,-0.210125449247,0.067295459203,-0.009725215656,0.074040250059,0.141202604902,-0.025645424091 &
            ,-0.358666671745,0.160898546792,-0.210101288466,0.069287952671,-0.527746640754,0.286752462977,-0.318473190264,-0.013661583296,1.045239480849,-0.152014478486,-0.082834216116,1.131684770104 &
            ,-1.319570102620,0.370762140891,-0.101475438724,0.467025231377,0.168054606182,0.079851641039,-0.628562905201,3.126992974169,1.019693752456,0.425694931556,0.183477609600,0.205206718364 &
            ,-0.056114052146,1.210850608058,-0.250226739078,1.949742414205,1.008314249527,-0.699684403701,0.135832558544,-0.285346714734,0.363755790587,0.467041581537,0.422683496345,-0.119073822915 &
            ,-0.158174057257,-0.306035555696,0.488509883415,0.390292874340,-0.407997113061,-0.548251121077,-0.137649830455,0.919835776559,-0.757817017019,-0.744055137933,-0.104931241787,-0.532791739905 &
            ,-0.219064798207,0.265627462148,0.462809399897,0.470398246389,0.662916817906,-0.439739851136,0.416203147317,0.236834917259,-0.021242675465,-0.283943857843,0.041991826525,-0.381040866305 &
            ,1.338765317817,-0.049982683010,0.214729233906,-0.097843902254,0.109400318180,0.607542464702,0.255574107449,-0.538373007564,-0.309257561220,-0.555483867278,-0.139814298907,-0.578048515670 &
            ,0.235712590214,0.515353781384,0.494029399916,-0.287879323762,-1.276203763512,-0.126342600595,0.011167188130,0.186626111828,-0.118993280780,-0.305495131511,0.052048560063,0.627086504435 &
            ,-0.425268689428,0.021955443794,-0.401879838105,-0.438954648628,0.155237408343,-0.117260535526,0.271041966791,0.210056214921,0.265419960655,-0.234339808194,0.323260935887,0.132395468860 &
            ,-0.188577324076,-0.085337507199,-0.031817284680,-0.225579598689,0.069063759575,0.193138275735,-0.291744114620,-0.012260329073,0.096897231932,-0.056988504113,0.001038394187,0.052247071650 &
            ,-0.181184803526,-0.342590528742,-0.100604076393,-0.225459224662,-0.189608316552,-0.771660378828,0.037244734600,-0.030682670348,-0.149678344496,0.066405332319,-0.097491609103,0.303846351340 &
            ,-0.169234600724,-0.436848026743,-0.193803566867,0.098939375490,0.122130461442,-0.028146684776,0.179769281329,0.101692087271,0.016143890047,-0.230197778430,-0.147283113253,-0.059811524994 &
            ,-0.083884875975,0.072299294051,-0.205736705618,-0.295928153741,0.207694566251,0.055593879501,0.032197453927,-0.013668086204,0.232072266599,-0.098794210887,-0.071789121640,0.029839193007 &
            ,-0.049354186197,0.197897969934,0.065220910100,-0.132324560235,0.335165011325,0.000042010713,-0.072725379198,0.462290722760,-0.273497182224,-0.486916728968,-0.784151560605,-0.156631913203 &
            ,0.097796456088,-0.059031041636,-0.617845241117,-0.515051072699,0.340003981262,-0.215430874084,0.191352050516,-0.395352501927,-0.503906185397,-0.330040491893,-0.080326496435,-0.338707938915 &
            ,-0.076486591282,-0.500440659227,0.471580362467,-0.091120043439,0.260522649996,0.111999616412,0.531889910583,0.422016223625,-0.253847527930,0.902846672116,-0.503875932369,-0.016083221454 &
            ,0.000957100271,0.096770811368,-0.296374040009,-0.212888595603,0.262211523286,0.348277763904,0.003808930746,-0.101656668379,-0.145483868093,-0.004117920744,0.481774738937,0.186307278661 &
            ,-0.102772352027,-0.309217669644,-0.020348466866,0.051191572189,0.233833723631,0.090131063499,0.329740410461,0.122082458265,-0.020967974099,0.531445452775,-0.160508138888,-0.054794189220 &
            ,0.135913372787,-0.058793742180,0.085039866363,0.214152013295,-0.146025123307,-0.346898010929,-0.162198176889,-0.066382027411,-0.099736150302,0.000536711834,0.328012594765,0.104292697182 &
            ,-0.108388426867,0.470209890486,-0.060082069705,0.083306395491,0.199784237161,0.122491475650,-0.156897667144,0.057010682687,0.108567843042,-0.114205162291,-0.106486741598,-0.054689944805 &
            ,0.153949322740,0.470978259964,0.148733916736,0.159177139331,0.790233872404,-0.634381999044,0.687452759205,-0.126309013970,-0.217085087103,-0.235660010054,-0.096267555200,-0.315347097496 &
            ,-0.253624358267,-0.516058485459,0.010331758069,-0.141884290341,-0.324902439980,-0.164864357012,-0.230890429528,-0.054118816526,0.059928313990,-0.442470338044,0.277908843788,0.110286172507 &
            ,-0.242263101667,-0.094089772532,-0.038795952101,-0.405929300070,0.477939472227,-0.403557189528,0.014104541206,0.123973803331,-0.507167613013,0.413655576879,0.011308454844,-0.064409727501 &
            ,0.181120029457,-0.269928924088,0.089221559821,-0.023573887022,-0.345362210893,0.063685053288,0.209692223109,0.253719603908,0.396078968674,-0.052641472421,-0.101558648459,0.277150202532 &
            ,-0.166956375302,0.190396906600,0.332865777015,0.443032724439,0.288868656695,0.175060336744,-0.025730811226,-0.202871940193,0.162322125918,0.123941756414,0.589515699484,0.065092814714 &
            ,0.028098786607,0.284996433975,0.239491684808,0.053957660361,0.568823336020,-0.523381071299,0.616871901786,0.239357107365,-0.122461549625,0.525476075980,1.079712793269,-0.242252567282 &
            ,-0.726159978201,-0.019116911369,0.589164595989,-0.282424704922,-0.460173019646,0.179583339237,0.848004710341,1.415889432860,-1.573564862922,-0.988952686064,0.318184549620,0.128749457984 &
            ,0.026486093764,-0.847505939734,-0.302824312067,0.087657867736,1.482807553037,1.135828559981,-0.769723913825,0.783555590351,0.317286632909,-0.705338661047,-0.640093079380,0.291865513405 &
            ,0.687929924943,0.604310521400,-0.102526401573,0.092883017646,0.037064756111,0.622943150412,-0.170906885633,0.200036483992,-1.216973830398,0.061181600902,-0.692579122454,-1.310764803159 &
            ,0.667535928971,1.261255771423,0.725625029421,0.437652330413,-0.163917246144,-0.273800126918,-0.063850333538,0.443043544818,0.209564759557,-1.065528045977,0.247460112590,-0.194592667313 &
            ,0.273988581434,-0.593664770640,-0.364619488187,-0.218038224266,-0.351380112959,-0.162804405649,0.416600129746,-0.154593198492,-0.146228769256,0.377047127794,-1.252758945223,-0.867456984151 &
            ,1.247656457502,0.557057609469,0.194381180511,-0.127938237293,-0.137499724583,-0.434675267596,0.247637926930,-0.001646822769,-0.827892427974,-0.897809588316,0.210231047839,0.190859941430 &
            ,0.164465566291,0.103434681496,-0.214292388375,0.058127572080,-0.003012464850,0.130911438887,0.125636263090,0.028927873995,-0.322150290544,0.077019339707,0.275215031376,-0.416173516112 &
            ,0.414823886163,0.286907570571,0.001750440158,-0.030357962463,-0.063552791941,-0.059039088814,0.090793940308,-0.010866017625,-0.061871933392,0.431800295143,0.256211870714,0.110991243651 &
            ,0.083452351341,-0.016060013165,0.122940771245,-0.138971938713,-0.158317930526,0.551104787456,-0.084834709260,-0.045796000252,-0.238248024495,0.157287559342,0.270754418896,0.084579404607 &
            ,0.100616124619,0.332924485802,0.388748406635,0.237155094736,0.029389479548,-0.201405792310,0.336477891227,-0.429067029748,0.137367698137,0.047900100307,0.134119850245,-0.224607956300 &
            ,0.227768361277,-0.046410697671,-0.140336324909,-0.106539602621,0.134372114399,0.077306979708,-0.070924425313,-0.212585711856,0.246440545263,-0.047011095941,-0.254037154073,0.057835441233 &
            ,-0.050397898055,0.052867276287,0.039684250217,-0.104088364641,0.072686412041,-0.261148279682,0.306229961665,0.087024166165,-0.154418594445,0.028194384856,-0.476175072451,-0.215384954095 &
            ,0.407883998279,0.394834671492,-0.432553067274,-0.092918822196,0.378707124868,-0.216986791417,-0.152088395115,-0.163713101898,0.295471396697,0.113522144737,0.359728286743,0.268949745211 &
            ,0.255412615974,0.902673597249,-0.343881448307,-0.390770043299,0.625582320221,0.008902024366,0.173130689154,0.336718549111,-0.080096939191,0.923288643743,-0.403375432945,-0.321454209712 &
            ,0.705024695171,0.520124775897,0.407212091702,0.810006674434,-0.169675192771,0.233618790965,-0.833091527535,0.039244824943,0.593868503648,-0.027072875758,0.037545235129,-0.127219034477 &
            ,0.033240766359,0.093060157154,0.029641564359,-0.281042244213,0.011004918524,-0.193760881488,0.412558864372,0.114910577711,0.033853996182,-0.288025136499,0.175034757988,-0.215841557230 &
            ,0.597447014820,0.176234893520,0.444631670362,0.800035144227,-0.329373731097,0.281806030831,-0.650455279664,-0.043756781987,0.680985031789,-0.065945960287,-0.624471778034,-0.614774503356 &
            ,0.585099852081,0.409025381878,0.296920450245,-0.638780527200,-0.341441608249,-0.122491113522,-0.475041238084,0.020237581135,-0.435893307437,-1.380640333303,0.119900605323,0.381135764149 &
            ,0.338992691736,-0.081106543863,-0.035356807947,0.083030557782,-0.101793546997,0.141568798813,-0.119100000539,-0.172798683603,-0.196281953777,-0.025636382070,-0.045177573958,-0.162050261536 &
            ,0.079013621452,-0.054935553220,0.116085443375,0.042666599492,0.139311503106,-0.088703717644,-0.137146142925,0.042928750122,-0.131733358339,-0.323954537393,-0.031368446534,-0.062406170199 &
            ,-0.015134078661,0.024457250169,-0.041179846800,0.051647163191,-0.002804364654,-0.093546962594,-0.017432178274,0.024286375322,0.038460484348,-0.063511801814,-0.190763197995,-0.078982925994 &
            ,-0.035079487067,-0.222350952882,0.038567284953,-0.032817562104,0.042294162940,0.028968511059,0.000580539506,0.061287337353,-0.001576855045,0.110328494070,-0.078263071828,-0.011286450808 &
            ,0.105506193778,-0.004303740717,0.175927514532,0.088151055105,-0.046863600452,0.141266392402,-0.052129926218,-0.029177918469,0.034567320193,-0.056253956996,-0.002360077853,0.060488419076 &
            ,-0.136889663411,0.031374148377,-0.034087308763,0.004444443115,-0.019689886602,0.063754013480,-0.325043754238,0.045335346440,-0.024383591300,-0.063806132031,-0.000694890068,0.069267425253 &
            ,-0.169638465543,-0.027147520500,0.064978947159,0.030883087992,-0.168995999986,0.045680730758,0.073759822827,0.161989310364,0.189548751609,0.003442373259,0.337352163012,0.123791713753 &
            ,0.030658131180,0.429817752024,-0.069220659176,-0.119706322753,0.211141113671,0.071987328347,-0.109910969377,0.083345771415,0.007589396515,-0.178425539640,-0.089515152881,-0.050485673283 &
            ,-0.197930698094,0.031201322143,0.320432537743,0.115974115132,-0.060432620388,0.445891207117,-0.114299606157,0.106267996772,0.114967554700,0.075641506161,-0.178453286915,-0.035081625258 &
            ,0.152923254250,0.039589207942,0.065306965509,-0.076153974587,-0.102376436023,-0.091590609384,-0.027796852278,-0.009305240273,-0.153069713738,-0.213374212941,0.011588205794,0.069954564618 &
            ,0.045242908355,0.166525605649,0.177259983967,0.066823599588,0.265002250528,0.543672405129,-0.096985223420,-0.059832077456,0.257366392446,-0.059264610503,-0.597887875217,-0.043933186502 &
            ,-0.132996371994,-0.970807713030,0.098487785114,-0.059137133506,-0.137722506464,-0.051850942486,0.017529998018,-0.104741349879,-0.035536462434,0.035841682403,0.067899694217,0.056359766425 &
            ,0.070301207645,0.044386422152,0.036792252697,0.092794095458,-0.051518594188,-0.130356494035,-0.127210004688,0.016074006980,-0.060451656635,-0.011748484681,0.073018412931,0.029092311967 &
            ,0.028520495287,-0.085556200496,0.038805650908,0.007297106313,0.181084889759,-0.016868350433,0.047681987088,0.047827942614,-0.114650471223,0.202973565566,-0.140715582652,-0.030643343348 &
            ,0.089334907000,0.086280626984,-0.027210202918,0.055047169641,0.088927418734,-0.202138219795,-0.044025536394,-0.029065098144,0.183672497323,-0.080914473853,-0.078465911669,-0.019494748307 &
            ,-0.106527963537,-0.275466433043,-0.038596525287,-0.063282203499,0.009494730867,0.105844592087,0.004008888312,0.017377687755,0.058656667810,0.160182443765,-0.065717112282,0.043307837272 &
            ,0.219721237662,-0.121445358366,-0.067771734548,-0.021562355878,-0.141252038065,-0.223384898755,-0.057220511387,-0.092170432645,0.183899130362,0.064775342776,-0.045641327836,0.041450234568 &
            ,0.059845800654,-0.051766469222,-0.044051468599,-0.065435935471,0.607439101072,0.001105568113,-0.403526621551,-0.139391930401,-0.014403980639,-0.588374371390,-0.098894802097,-0.190679745749 &
            ,0.573765971188,-0.029748793541,0.062603591909,0.200656544163,-0.228317228765,-0.162727526515,-0.313140374540,-0.145597691625,-0.125029548039,-0.092027355412,0.165776639761,0.051032356076 &
            ,-0.063960273289,0.157990802680,0.161764078497,-0.017850458787,-0.223599914292,-0.188971484372,0.055930186954,0.034065537648,-0.145058324994,0.166723946453,0.135855111351,0.004353400106 &
            ,0.147138142226,-0.175023918089,-0.069829251263,-0.037673969969,-0.108489722059,0.406364766491,0.181545817905,-0.156778974087,-0.073081058509,0.008214669822,0.293199102740,0.208287307769 &
            ,-0.098000258173,0.364331236578,-0.119954947386,0.047776641962,-0.014724451538,0.044274917789,0.037879521620,0.008168182794,0.065969276298,0.040085592825,-0.001341899562,0.003209011534 &
            ,-0.075207431788,0.105457681609,0.420640277033,0.332592692504,-0.094155265526,0.074427839698,-0.339765527304,0.126803891649,0.040337307744,0.170003260485,0.338803042340,0.280391044306 &
            ,0.012705690873,-0.160598165727,-0.250611793289,0.075682913555,-0.402446084521,0.112912969179,0.129542692985,0.082450121557,0.089067895395,-0.257864598907,-0.075484675598,0.206545872507 &
            ,0.038271523861,0.021906594397,-0.133158710071,-0.085138267969,0.021227266939,0.018133640398,0.006725164436,0.010378117030,0.008177261727,-0.000063007096,-0.006119953912,-0.004329445362 &
            ,-0.007541943792,0.026014896769,-0.019161930326,0.000907677110,-0.007818230330,0.007900287703,-0.010611210164,-0.010972510624,0.011421722899,-0.025821295627,0.005550874320,0.006570284750 &
            ,-0.021578627908,0.008972186850,-0.006352809332,0.001278456235,0.002652319209,-0.037725443880,-0.015333089523,0.014363575062,0.009400981585,0.001206793172,-0.003436856962,-0.011253764450 &
            ,0.019552581394,-0.020126057541,0.003133811834,-0.011800094416,0.010318697415,0.001676083959,-0.078385295796,-0.051514015338,0.004542899469,-0.032282697595,0.035007981497,0.009329358321 &
            ,-0.022290356420,0.017375492833,-0.005655707304,-0.026063992675,0.048656573769,-0.016687482370,-0.000287218147,-0.001946560318,0.014481650930,0.018483236881,-0.022042617497,0.003656125519 &
            ,-0.005592977304,-0.029736413708,0.005490604383,0.018566182100,-0.047503419854,-0.027503100076,-0.146098301452,-0.252401607801,0.092274475041,-0.125393954545,0.163150275987,0.016708689498 &
            ,0.161374407526,0.112952863537,0.290703183448,0.046485705023,0.227290667957,0.371536810583,-0.100555236668,-0.116004000016,0.192953194754,0.191362486784,0.553618391883,0.195193221531 &
            ,0.189771995341,0.796728908257,-0.275052988386,-0.084245171164,0.087047864583,0.062335677854,0.302336187293,0.212282882737,-0.049366021093,0.268533290002,-0.196742555404,-0.011854138632 &
            ,0.106502854330,0.160756281459,0.149816789243,0.053158746042,0.136397890055,0.285417447863,-0.049440021826,-0.012254803742,-0.111601756790,0.020482388487,-0.102881727780,-0.150470234810 &
            ,0.091314642010,0.009504677893,0.157201372686,0.031977777767,0.026961557437,0.010795033181,-0.035035990450,-0.087319210109,0.091098331522,-0.145983978521,0.124684309692,-0.041585495047 &
            ,0.007396703694,-0.010123217066,-0.041130627902,-0.002832155815,0.016423669764,-0.239216368950,0.021809741509,-0.016453694482,0.124263425189,0.002641738210,0.143419743521,0.048523969795 &
            ,-0.046323525545,0.426859675647,-0.019285956362,-0.029725263912,0.071206142775,-0.005854866130,-0.019799776687,-0.015073246641,0.031916453432,-0.227972220768,0.051075895019,-0.054262390914 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.2838,-1.5688 &
            ,-1.0304,5.0672,0.75372,0.64285 &
            ,-0.82282,-2.1749 &
            ,0.72401,-3.6627 &
            ,-0.36003,-0.41204 &
            ,-0.88727,0.21017 &
            ,2.1415,-4.5057 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.4775,2.1446/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-5.228,-2.6806,-0.52734,-0.97746,1.7161,-1.0409,3.1999,10.0938/)
real, dimension(2) :: bias2 = &
  (/-0.0081618,-0.33688/)
real, dimension(1) :: bias3 = &
  (/2.7621/)
contains
subroutine fnet_losvaqueros_initall()
end subroutine fnet_losvaqueros_initall
subroutine fnet_losvaqueros_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(1) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 1
    inarray2(i) = inarray(2-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_losvaqueros_engine
end module fnet_losvaqueros

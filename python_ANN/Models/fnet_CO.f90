module fnet_CO

! a = 0.00000365
! b = 0.07965


intrinsic Reshape
real, dimension(8, 119) :: input = &
  Reshape((/-0.21178550,0.00422933,-0.21564883,-0.03076880,-0.49511844,-0.12953398,-0.74675429,-0.56832725,0.03468107,0.24878925,0.38991067,0.44094923 &
            ,0.39713106,-0.32456204,0.60271841,-0.30885699,0.15110879,-0.54965615,-0.13506287,0.35075495,0.36379626,0.43142489,0.19994503,-0.04129289 &
            ,-0.05897450,-0.70787048,-0.61836469,-0.54243022,-0.77103233,0.41720954,0.19830903,0.10492147,-0.38848904,0.14319646,0.29948252,0.02596547 &
            ,-0.68688297,-0.04223679,-0.34462944,-0.16761146,-0.15609269,-0.05233092,-0.42534202,0.22637771,0.22873782,0.08387226,0.13633659,0.11617002 &
            ,0.26669610,0.24796426,-0.50492400,-0.36837918,-0.32608104,0.24221745,0.07722476,-0.47901195,0.40261659,-0.14831769,-0.36602047,-0.56428313 &
            ,0.24384661,0.16781615,0.32795241,-0.00600279,-0.04057474,-0.00581199,-0.30604348,-0.27203417,0.08410272,-0.18335664,-0.33118272,-0.87528920 &
            ,-0.15481168,-0.63260269,-0.15531938,-0.91350818,-0.72555399,-0.41904634,-0.33655459,-0.87246996,-0.63079780,0.13195951,0.04540993,-0.50868028 &
            ,-0.52173460,0.31690302,-0.45181990,-0.23172337,0.13906570,0.20979269,-0.50001609,0.33489639,-0.07290155,-0.22915561,-0.64520425,0.24840097 &
            ,0.04200233,-0.09500480,-0.66241938,-0.08846847,-0.73596078,0.08265565,0.25799197,0.27888259,0.44727683,0.28787437,0.33661085,-0.16000892 &
            ,-0.46240383,-0.13840872,-0.42505723,-0.02889054,-0.15334083,-0.99064863,-0.42424983,-0.35127339,-0.55974364,-0.73622936,-0.70685184,3.23021698 &
            ,6.51824188,14.35181808,23.39069176,12.29414654,11.50794983,-6.40957737,62.58465195,48.86131668,-5.82783604,3.16373897,42.38478851,21.00683403 &
            ,-20.34152412,13.00682068,-16.64184952,14.61541080,-0.27856168,-2.54910302,-2.78193641,-2.17728114,-0.53030127,0.44655681,-0.01834735,-2.39284372 &
            ,2.17505240,0.45286632,1.27556825,-6.53130245,-2.10790944,2.74082685,-4.45447254,1.75919569,1.54632616,-22.81295395,-1.78318930,-5.18563557 &
            ,6.90038252,10.24207687,21.96925545,23.62837219,-28.41387177,10.80921555,-1.89195943,5.83471394,13.72234440,10.31508827,15.39469814,-8.42000675 &
            ,5.49336815,-0.48440069,-1.94376862,-4.61722755,2.62871170,-2.61752319,-12.26663780,7.23160553,-7.06671000,-4.02015305,-3.91215658,13.27485466 &
            ,8.25333595,-5.80967808,2.44879770,-8.67437363,9.48042583,1.55557537,2.56321907,-2.53916550,-2.53419828,1.33185649,1.02901912,3.52907133 &
            ,2.97497940,3.31226921,0.54049635,6.15932894,-4.73399305,0.91146445,-11.32249737,8.57305050,-0.66994673,-8.58969307,-0.06558627,1.82154894 &
            ,1.23896742,-0.67499650,1.51315916,0.51067626,-0.24322867,0.48351327,-0.37214670,3.22416186,4.22179794,0.94044673,-3.01248407,-1.74819660 &
            ,-0.80476850,-1.01509380,3.38791466,2.93494129,0.22188169,-0.67836541,1.22953105,-0.57360119,0.27012521,-0.09264039,0.60986638,0.82003003 &
            ,3.48916197,1.89243495,-2.91015673,-5.17687941,-0.34796631,-1.17740440,0.28232718,2.55448079,-0.61953938,3.19108391,4.82629299,-2.59241414 &
            ,0.60470706,-0.32265612,-1.14604735,-11.20066833,2.96113133,-3.62000370,-19.38467979,-8.71448517,-7.40757275,-21.01602936,-26.46840286,-9.68079758 &
            ,-1.33530927,-20.08646393,6.25701809,0.60693151,-0.42934048,-0.29037195,-0.13588867,-0.12083799,-0.10453538,1.83963501,-1.99060535,0.33744687 &
            ,3.71935201,-1.88867354,2.19433188,1.58560777,-0.55219698,2.05080128,-1.20428514,-1.14281237,-13.87423325,6.19843292,-7.43438339,12.29965878 &
            ,3.92301130,7.64108086,12.59810066,10.65810204,-10.74661064,3.19376540,-15.04282475,8.75716591,-31.74624252,12.60548115,1.55106235,-15.16808891 &
            ,1.97977209,-0.33781087,1.08343434,-2.36934018,1.14806151,-0.57077628,0.68138313,0.28016883,-1.37885237,3.71066284,2.84706783,-3.17095852 &
            ,4.20147610,-0.96364164,-1.89345968,-1.45155585,2.01060843,-1.55702436,0.42927670,-0.57563579,1.04783773,-0.00977150,0.62633872,0.04460296 &
            ,3.48085499,-5.55790329,0.89181131,4.54414940,-3.95928383,-0.57727075,-0.29946747,2.21796203,-1.77593243,3.27938700,-1.46641445,0.38083443 &
            ,-1.75044441,0.14017746,0.83781958,-1.02530670,-0.35199583,-0.42216328,-2.51501894,0.86704969,0.76873839,2.43627644,2.43369031,1.24509299 &
            ,-1.75462973,-0.35589218,-2.89534593,-2.59779215,-0.09539948,0.22933322,0.39144561,-0.16260290,0.27002814,0.35703623,-0.27221024,1.56019974 &
            ,0.51120520,-0.71707058,-1.18321598,0.60666257,-0.12275477,1.05025566,1.04934955,0.34724146,0.27111074,0.17055731,0.11836006,0.23640426 &
            ,0.13635279,-0.70136642,-0.67715639,-0.44104147,-0.87936163,0.01337678,-0.38669840,-0.50722253,0.10486514,-0.61728597,0.14053465,-0.21085992 &
            ,-0.01290153,0.14947824,-0.21352500,0.01810972,-0.21871126,-0.04362012,-0.05090135,-0.25777712,-0.74460655,-0.19977199,-0.53398597,0.30774239 &
            ,0.22948739,-0.20623556,0.17751834,-0.25168002,-0.57454962,-0.21114081,-0.13412549,-0.29339349,-0.07999787,0.21103439,-0.66339582,0.08087214 &
            ,0.02627364,0.27161828,-0.17030828,0.41954491,-0.07727994,-0.40959325,0.30236661,-0.34936789,-0.57279515,0.47376812,-0.70341635,-0.42626932 &
            ,-0.19777498,-0.55166024,-0.88595712,-0.33015814,0.24349485,-0.42342320,-0.26915053,-0.49817529,-0.62234902,-0.69150722,-0.24927282,-0.51597333 &
            ,-0.71142530,0.00103340,-0.67648214,-0.54485887,-0.11207154,-0.65335375,-0.37643608,0.14228368,-0.77132982,-0.08006465,0.02791447,-0.97396743 &
            ,-0.89678913,-0.43545038,-0.85760784,-0.18533856,0.13005315,-0.66207474,-0.37165564,0.23150395,0.04909704,-0.52047086,-0.53378195,0.21210411 &
            ,0.15100053,-0.59956372,-0.47440484,0.06755544,-0.32529649,0.11226395,-0.72049665,0.25328732,-0.23153386,-0.72100794,-0.60496062,-0.79854977 &
            ,-0.70259529,-0.31754205,-0.16268225,-0.37406328,0.03995853,-0.33807680,-0.16363885,-0.66046846,0.15578048,-0.10581017,-0.41912436,-0.61735088 &
            ,-0.28475592,-0.41115946,-0.15450922,-0.48727715,-1.08506310,-0.47173923,-0.55073655,-0.49553764,6.41625166,-1.66955972,8.47445488,4.55099869 &
            ,-4.91546154,13.35279465,0.39686227,1.69088554,-12.48469353,-34.88375092,-7.55089378,-42.34617615,-100.65917969,-53.45204163,6.83282995,10.52536583 &
            ,-6.61865807,-0.73448551,0.68976694,0.17903762,0.50855213,-0.11224336,0.68319786,-0.90828878,0.26490799,1.45396590,-0.31502944,3.50667214 &
            ,3.43985748,0.61957538,6.55588102,-0.28739300,-4.68859768,3.52120399,-56.99722290,-62.56631851,-49.47145081,-34.79267120,-13.81281185,-26.75404930 &
            ,-9.57783985,-13.12557983,20.20753670,13.49789619,12.12168884,49.98046875,33.16628265,-1.24645138,-13.66180897,-20.29188156,38.95693970,1.67798865 &
            ,-3.85726857,4.21381807,1.76122308,-4.12013769,0.33902475,4.51092434,3.35160232,0.34909034,3.67216253,-7.36946583,3.92111444,-9.32573223 &
            ,8.28414154,3.78802824,13.72116947,-18.34817123,-0.03886367,-2.73976755,-2.14414859,-2.04252028,1.35525680,-0.92261434,-0.48749110,-4.05734968 &
            ,-0.09992396,0.94152582,3.76633644,0.08301693,6.78138733,-3.64789653,-2.63453960,-0.51479661,9.27538681,-0.37703258,0.68615401,0.75102794 &
            ,0.12668204,0.26998267,0.20399404,0.07018313,2.79307175,2.87894130,1.16890442,0.29558796,0.90630108,-0.31639850,-2.16272712,-4.13270617 &
            ,-2.95752549,-1.37115788,0.09293487,0.01112028,0.13568556,0.22262728,-0.23471443,0.00387812,-0.05881959,0.88443613,1.07149875,2.54738855 &
            ,16.47099686,0.51263398,18.50759125,35.75110626,29.53325653,13.45324135,-1.93003559,1.22734845,1.63078308,2.23236251,2.00617599,3.20843053 &
            ,3.57048798,1.61820817,11.45476627,3.73905206,-0.18033248,-0.39163566,-0.86110151,0.12430079,0.11691286,-0.08190154,-0.25516319,0.05445569 &
            ,0.01920887,-0.15654655,-0.14810036,-0.15044886,-0.11618726,-0.01819972,-0.18773769,-0.72776878,-0.04801611,0.07655758,0.02111976,-0.06680636 &
            ,0.00713955,0.08045449,-0.17063385,0.07014021,0.14270718,-0.85595810,1.03084338,0.75411934,0.85955596,0.80263859,0.53125173,0.54590690 &
            ,3.54714918,0.64231861,0.07162710,-0.05781876,-0.20067020,0.43563038,-0.55428660,0.15657033,0.54520756,-0.26765507,0.13171294,-0.06905127 &
            ,-0.17251988,-0.09567048,-0.36020002,0.20656216,-0.25208333,-0.92440099,0.13332036,-0.14404604,0.56838530,-0.20110196,0.00351215,-0.17835453 &
            ,0.05356517,-0.13047864,0.15209959,-0.11379158,-0.00919393,0.14347148,0.05924266,-0.04259709,0.17333972,-0.23568580,0.53498012,-0.20933539 &
            ,-0.27833924,0.27505776,-0.10746816,0.12957491,-0.11312911,-0.09782863,0.07367726,0.04667259,-0.23329026,0.00571022,-0.00276755,-0.07293107 &
            ,0.02805168,0.13386856,0.03100558,0.07908586,0.24848135,-0.37565407,-0.29514641,-0.30839583,0.00555033,-0.07360043,0.40147576,0.38872200 &
            ,0.20962656,-0.01801427,-0.01874268,-0.00238963,-0.00293919,0.03271253,-0.01166743,0.04136897,0.07643694,0.00941775,-0.00152229,0.09074576 &
            ,-0.08617530,-0.07644168,-0.02044107,0.02143747,-0.03134251,0.05038782,-2.95160389,-7.11757565,-11.48758793,-1.76436186,12.99835110,-2.28716540 &
            ,14.43986988,-11.38672066,-0.29827023,-2.67524362,-27.46348763,22.27101898,-6.91663933,-19.40898323,4.67628670,-1.13988400,-20.01789093,-0.31313199 &
            ,0.84450752,-1.19488251,-0.57020819,2.13626575,-0.13016757,1.16972172,-3.72276425,4.14848614,4.84297037,3.71643734,-6.25995541,4.41585588 &
            ,-1.36719608,-3.20671320,-1.90101123,6.86736012,-32.41431046,-26.79137230,-8.82019806,-5.09687805,18.63778687,1.61935556,1.56098366,-2.15195513 &
            ,12.47745800,-6.66640377,8.15969181,5.52795553,-2.83507442,-17.17367744,41.29790497,19.36013794,11.57003593,8.46020794,-12.26941204,-3.03425050 &
            ,2.17168927,-12.19896793,1.95640910,-2.74595881,12.20384121,10.84787655,2.42716742,22.45480537,-14.93535137,4.20695496,9.07192039,-16.30295753 &
            ,17.17557144,-1.92751431,-1.70688272,-2.95920277,2.66106915,-5.62375784,4.11670589,1.74287510,-1.90216744,11.20978260,-7.91222811,-6.38297796 &
            ,-1.31885326,19.22923851,7.82246399,-3.08986378,6.28181601,-16.59004021,14.89925766,-0.86007166,0.85823154,2.47511268,-1.22377002,1.43374038 &
            ,0.66605651,-1.34867513,6.32271814,1.92220759,-5.63925695,-5.02062941,-8.26567745,-0.70379162,3.68812704,7.45926762,0.53395444,5.50259781 &
            ,0.28639835,-1.78960800,2.24888992,-0.45520404,0.41114068,0.28171784,0.03161642,3.38174748,0.45344692,0.67016268,3.91045094,-2.61379647 &
            ,0.36684403,-0.86855048,0.03037719,-0.78695458,0.56892377,1.66573870,1.63119590,2.31391311,1.22764993,0.93612367,0.04788744,-2.48463964 &
            ,17.34286499,12.85203171,17.18541718,10.14174557,6.15960932,-3.54579473,1.30258322,-1.00849640,1.39709747,-0.36773619,-0.05624138,0.18807654 &
            ,0.23276111,0.12009872,-0.25032976,-0.01883826,0.08540528,-1.04586637,-1.66174769,-0.70329386,-1.25261712,0.68704689,0.09953859,-0.48195648 &
            ,1.19097841,-0.73776913,-0.58303708,2.10659027,-2.01903009,-1.08478880,0.90441072,-1.76742721,-0.85442269,3.73286605,8.55107784,2.87183571 &
            ,5.42103386,0.23192680,2.38933468,-1.84791934,1.37268984,-0.87096381,-2.76269007,2.30004263,-0.35424727,0.85426795,-0.41080600,0.56947315 &
            ,1.76795828,-1.03507423,1.27375209,0.15221345,-1.28679156,-0.92962611,-3.06210971,0.60059422,-0.00060460,1.13516426,-1.29139936,0.51032197 &
            ,-1.13399076,0.47034973,0.02969868,-0.27469712,-0.04140088,-0.47530258,-0.49518365,0.76306677,-2.57399154,0.73570687,1.78571725,-1.21700227 &
            ,1.15376866,-1.27053416,0.70428336,0.45540482,0.40511441,-0.58471394,-0.11553337,-0.26498178,-0.09356350,0.29800650,-0.32373029,-0.31700939 &
            ,0.14495552,-0.85605657,0.27263302,0.36124894,1.11974943,0.42413482,0.04780695,-0.88015944,-0.61779994,-0.86828959,-0.41127306,0.02675289 &
            ,-0.01595457,0.07161032,-0.02754953,-0.04717630,-0.02909613,-0.24427271,-0.24538574,0.01871806,0.17918967,-0.28266528,0.36029118,0.19566821 &
            ,0.13989383,-0.15487331,0.28717911,-0.38503882/),(/8,119/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.21558727,-4.19731236,24.30017471,-0.02503662,-31.28117371,8.55153084,-6.64277411,-24.32141876,0.61791021,-0.22353718,15.10038567,0.33703774 &
            ,22.45817375,-8.06090736,0.07666086,-1.97882771/),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.21603875,0.77515048/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-11.93843269,-31.31351089,5.96818781,-3.45209503,-78.94358826,-3.45861864,-31.57631683,-5.19592094/)
real, dimension(2) :: bias2 = &
  (/13.54665947,3.85268259/)
real, dimension(1) :: bias3 = &
  (/0.09954678/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(119) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 119
    inarray2(i) = inarray(120-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO

module fnet_ORRSL

! a = 0.00000365
! b = 0.07965


intrinsic Reshape
real, dimension(8, 119) :: input = &
  Reshape((/0.52134347,-0.13075049,0.03585633,-0.15267228,-0.28532785,-0.67920369,0.21882357,-1.32737529,-0.88137668,0.45452708,-0.01017862,0.65050864 &
            ,0.18404526,-0.41029036,0.99112761,-0.41620481,0.34299192,-0.29455096,0.04356027,-0.13337451,0.03098224,0.00806497,-0.07249315,-0.23456055 &
            ,0.17498559,0.65801394,-0.18031296,-0.07317676,-0.14645407,-0.27884108,0.15092728,0.10529032,-0.69052064,0.97890031,-1.23638880,-0.22828063 &
            ,-0.09903545,0.06162860,0.41870964,0.06295367,-0.00830853,-0.10043715,2.40038753,-1.01748312,0.93255657,-0.87648290,-0.28233069,1.31490231 &
            ,-1.67162418,-0.08979145,0.19434597,0.17316192,0.34256303,-0.02464926,0.18026058,-0.10823971,-0.12860420,0.05791302,0.06254624,-0.52768397 &
            ,-1.12436748,2.16365933,0.68379283,-0.24410772,0.48818636,0.09049861,-0.09078135,-0.88385338,-0.23181960,0.04279516,-0.21646313,-0.05424587 &
            ,-0.45321324,-0.11524893,-0.22022949,0.39914325,0.83706254,-0.51124132,1.15092039,0.01607451,-0.80805248,1.32131338,0.04247664,-0.09250284 &
            ,-0.15012451,-0.40512189,0.25093183,-0.08356541,-0.05693041,-0.06454043,-0.15935811,-0.08012889,-0.50659263,-0.23454154,0.23652774,0.42148268 &
            ,0.31852809,0.01661439,-0.27192119,-0.29106343,-0.37150335,-0.11560689,-0.02588433,-0.03587357,-0.03647898,-0.06832284,-0.04882271,-0.05022454 &
            ,-0.00811967,-0.50885147,-0.25658843,-0.15333095,0.00052689,0.03103474,0.21990703,0.12772825,-0.10360261,-0.15574764,-0.35301748,0.03942057 &
            ,0.12990290,0.46014774,0.02569804,0.10336947,0.00486445,0.28602725,0.16009313,0.63354838,0.60976911,0.23032284,0.61691767,0.88643920 &
            ,0.96584415,0.91034764,0.69579446,0.00488361,0.41272709,0.21070132,0.03308342,0.18474139,0.01274999,0.53698599,-0.26078349,0.00183185 &
            ,0.18002082,-0.20349905,0.04539571,0.84044766,0.75306827,0.41694370,0.55044043,-0.09420577,0.57839197,0.44668946,0.03068543,0.90867698 &
            ,0.11737434,0.95438266,0.86310768,0.25447148,0.73534989,0.76540035,0.45635742,0.68910146,-0.03133792,0.39211121,0.32520378,0.23316364 &
            ,0.54337227,-0.03058056,0.36343947,0.30790555,0.63681632,-0.00014086,0.87369800,-0.01476909,0.09988195,0.14582908,0.09903542,-0.07506417 &
            ,-0.04107261,0.05215587,0.58008480,0.15498340,0.18556726,-0.01225199,0.18800908,0.58521569,0.35277292,0.14254439,0.74539900,0.45820972 &
            ,-0.01405054,0.64661843,0.60955459,0.85958099,0.72639096,0.00181872,0.70398456,0.15683649,0.56154770,0.27297273,0.59755611,0.81343210 &
            ,0.07132050,0.03810956,0.70207590,-0.10738237,0.62818927,0.00622953,0.39343539,0.71000493,0.78957266,0.41110834,0.80591828,-0.11819573 &
            ,0.61165345,0.28701788,-0.05531960,0.85508180,0.75350207,0.12478503,0.27970746,0.48246574,0.29616064,0.49618956,0.77809078,-0.21612169 &
            ,-0.25549009,0.62271619,0.71590161,0.61263329,0.68557751,-0.20917836,-0.02739433,-0.08571372,-0.00871732,0.52033859,0.32717115,-0.26726845 &
            ,-0.24098082,-0.29652607,-0.54492974,-1.14431620,0.48274970,-9.75816727,-36.47811508,-17.68910789,-11.48554707,-12.42313957,-4.42254019,-4.18169928 &
            ,-1.96460450,2.38437200,-2.14595723,0.25566486,0.04845285,0.13588110,0.03286980,0.07718515,0.19261149,0.41337785,1.26180291,1.87685633 &
            ,1.03792310,0.96422732,0.80158830,0.39246339,0.38954070,-0.23398648,0.61741030,-0.92788285,-1.46000552,0.34756008,-0.77461404,-0.26385832 &
            ,-0.18342905,-2.22187209,-1.15757060,-9.66854382,-16.50556183,-0.79933763,-2.21978092,-1.76102626,-1.93800259,-3.56163788,3.61704397,-0.21589813 &
            ,-1.20214236,-0.52509391,-0.56036055,-0.04464872,-0.21048023,0.13464504,0.06365891,-0.16992959,0.28598231,2.40364146,1.58963215,-1.86437035 &
            ,-0.36733171,0.75037092,-0.82547402,0.16520339,0.71376467,1.07921267,0.03943210,0.09861115,0.10320456,-0.04897884,0.67734540,-0.01526029 &
            ,0.23899187,-0.13112754,-0.88763744,0.30730695,-0.98504418,0.39811909,0.13373253,-1.82822061,0.32938522,-0.53641284,0.62610304,0.38386261 &
            ,-0.30379438,0.04391500,0.04092594,0.04137477,0.12396363,0.18639176,0.41774952,0.10203142,-0.02392082,-0.18524812,0.28639013,0.02950921 &
            ,0.19853519,-0.18687671,-0.12132661,-0.44719642,0.03809076,0.05739010,0.07658271,0.06421997,0.00503499,0.03463530,-0.06280012,0.47979990 &
            ,0.68794560,0.47715804,-0.11385012,-0.21053356,-0.17494017,-0.16782850,0.25890201,0.30076429,0.30293536,-0.96234059,0.87561244,0.82203966 &
            ,0.40279490,1.30374074,4.24917793,-0.75823426,1.08399653,-1.22818172,0.21000722,-2.45104361,-1.46608591,-4.63971043,1.51256764,-6.95984793 &
            ,-11.01261234,-1.08258462,1.04363632,-0.18841146,0.26002979,-0.73902130,0.15529673,-0.23053478,0.17771977,-1.94166780,-0.84058642,0.01356401 &
            ,0.03781420,-0.03357043,0.30438149,-0.78414261,0.47139177,1.72902846,1.01781344,8.69748974,1.37747967,1.21195185,2.07702494,0.00904475 &
            ,2.51485181,2.69504285,2.24878144,-2.32441592,-2.54745340,1.33147073,9.81907368,-1.70081007,-0.02770514,0.85090256,0.59050977,7.05933666 &
            ,2.10310388,-1.21757066,0.71985698,-0.63456106,0.44006944,0.26752901,2.07477880,-2.56793928,-2.25772786,3.17532897,-5.45114422,-1.60680175 &
            ,-4.98238993,1.61131585,-2.63109207,0.89768469,-1.47388911,0.28861088,-0.50876814,-0.75125414,0.67982101,-0.01204403,0.57670218,0.54443109 &
            ,-1.23626721,-0.98607403,3.79974961,0.15688388,-0.48267171,4.99859333,-0.49577937,0.70640439,3.26102161,0.66562498,0.37781835,-0.64709711 &
            ,-0.16681167,0.19084632,0.03193765,-0.23460101,0.02889954,0.99136114,1.45171165,1.78310275,1.72776496,0.41860130,-0.44387904,-0.60605651 &
            ,-0.42238697,-0.97548282,0.40201437,0.11046245,0.03157721,0.08729107,0.22333010,0.12369183,0.14535122,0.27859262,1.40941870,-0.18251990 &
            ,-1.10688245,0.85069621,1.07033014,0.01838938,0.11433266,0.76388186,0.30966300,0.72970355,0.76735634,0.11327826,0.77017409,0.12081145 &
            ,0.65585464,0.65616256,0.38233960,0.72139663,0.47625262,0.56761265,1.10097623,0.82549793,1.15897977,0.73876995,0.50374490,0.69097662 &
            ,0.33071262,0.68466508,0.03826924,0.55737025,0.50597602,-0.05425235,-0.19550335,-0.08757829,0.81852299,0.15423098,0.28893742,0.27308214 &
            ,0.77984023,0.81200910,1.10452771,0.40257576,0.32025102,0.63424379,0.28247789,0.11215368,0.01474486,0.19117960,0.70089179,0.50292432 &
            ,0.48370427,1.14632571,0.77470070,0.82992786,0.80206519,0.85633689,0.89691049,0.17633805,0.82457328,0.57778943,0.87946093,0.56789500 &
            ,0.64813131,1.06411028,0.19290628,0.19785930,0.96668530,0.83647776,0.80900252,0.79930478,0.56650412,0.93298715,0.09833765,0.51145428 &
            ,0.22652367,0.16042548,0.74499583,1.09577918,0.91821885,0.04152742,0.98616660,0.81499034,0.99449700,0.33022341,0.36311379,0.03781426 &
            ,0.43966693,-0.04904691,-0.00270571,0.98547357,0.96972185,0.97941178,0.25723836,0.94195986,0.27374944,0.33111718,0.57875735,0.62431192 &
            ,0.43141261,0.54573411,0.44352329,0.36709481,0.75903821,1.03062618,0.71634132,1.01200891,0.39571556,1.12412989,-0.00503651,0.31603867 &
            ,0.37176380,0.25462300,0.44554377,0.13368745,0.20135522,-0.12181029,0.71675777,0.90191054,0.27184740,0.42266756,0.40269861,-0.08763386 &
            ,0.62191987,0.62513947,0.81978935,0.57688600,0.37641063,0.73669809,0.36412954,0.57537961,1.27432740,1.60263479,0.41740581,-0.39762065 &
            ,-2.01374054,-0.25769067,3.02599239,7.70454168,-16.28352356,-14.28064251,-14.52985191,-7.47909355,5.20657921,7.20360661,6.37576675,-19.34414101 &
            ,0.40955123,-0.39719549,0.31084064,0.39203274,-0.21038672,0.40626681,-0.16575493,0.69325078,1.21903002,1.50211024,2.83977246,1.65473199 &
            ,-2.85756230,2.31114435,0.47285461,-2.10660172,-0.38320869,2.14045763,-1.87922013,-5.13933945,-7.44502068,-4.64948988,-3.94957256,-4.79230928 &
            ,1.74275517,2.85264516,7.18986750,18.48748779,11.51305103,-0.21819083,0.78110290,-0.54582936,-6.44654036,-10.36907864,0.72300345,1.00585389 &
            ,0.41360322,0.18138400,-1.25202310,-0.41587663,-3.11160684,0.01229263,-4.06259632,2.77607560,6.18252850,-2.99162149,-0.92771190,-7.18762541 &
            ,7.52253151,3.95577335,-6.12880278,0.48034680,0.59589636,0.75990999,0.49310198,0.22956151,0.50639522,0.74968982,2.97389936,4.20892096 &
            ,-0.01631496,-1.03782761,0.93130791,7.84251642,-0.83681011,-4.20495749,1.01536107,-1.78923249,0.83875173,-0.38028294,-0.14908864,-0.32933018 &
            ,-0.20315520,-0.11482865,-0.16026051,-1.82143950,-1.02245450,0.14233655,-1.09361148,-1.04102993,-0.01115066,-0.32183337,0.21213922,1.55460644 &
            ,0.06729994,-0.42045105,-4.65179253,-6.95974016,0.05320340,-0.01536086,-0.58160943,0.02083455,-0.89318693,-0.59979528,0.68462682,1.00980854 &
            ,1.15001845,-0.58797336,-0.04353085,-0.00323914,-0.55803108,-1.18109369,0.59145933,0.84735858,0.54329079,0.71961427,0.44082394,0.78680062 &
            ,0.51129663,-0.13663730,0.58633643,0.92647755,0.44025755,0.09104689,0.10651980,0.37485176,0.79154199,0.17424804,0.20855761,0.14312381 &
            ,-0.14942290,0.03885553,0.73305959,0.06518998,0.48709816,-0.33014527,0.72859472,0.41867065,0.36250982,0.15390913,0.81855041,0.75603920 &
            ,0.00278677,-0.03586485,0.23748778,0.35673189,0.00847284,0.10643791,0.87377781,-0.05188393,0.18323152,0.45967108,-0.09306833,-0.06153860 &
            ,0.26744252,0.74266201,0.81636673,0.04246995,0.50477219,0.92386204,0.42717934,0.85726082,0.06092472,0.62510580,0.72404087,0.66163731 &
            ,0.24224868,0.54152012,0.89159566,0.64634943,0.20852116,0.48604482,0.98257208,-0.03557778,0.00073619,0.79907733,0.08629096,0.86605561 &
            ,0.44039327,-0.08281253,0.01405795,0.37525898,0.08803163,-0.19831465,-0.06915129,-0.11907432,0.10435526,0.37976491,0.14354226,0.58459264 &
            ,0.65934610,0.82408488,0.41268402,0.51363415,0.09259420,-0.11385151,0.46744773,0.87462246,0.92751896,0.81559926,0.05804245,0.13869835 &
            ,0.47729954,0.52497113,0.09754957,0.12787659,0.28663790,-0.05105010,0.50107044,0.27013707,0.50387985,0.29642740,0.15500310,0.65268016 &
            ,0.60557020,-0.03116565,0.70102483,0.17688082,0.65836638,0.67338747,0.59142148,0.16316058,-0.18197809,0.60065579,-0.06230192,-0.02495518 &
            ,-0.21554616,-0.09435620,0.65445930,0.44879204,0.57826132,-0.94265640,0.19586530,-0.29741541,0.23479232,0.98386961,1.48996365,0.08291316 &
            ,0.15344451,1.89205027,-0.55856770,0.64045042,-0.98482770,-1.39902532,0.05266576,-1.13461459,-0.40266514,-0.56113052,-0.07559322,-0.56269830 &
            ,0.12023324,-0.14172655,-0.24154496,-0.11557829,-0.04405120,-0.63162392,-1.55636585,0.63044441,-0.25682247,0.11673044,1.31988358,-1.20495355 &
            ,-0.20834599,1.00423861,-2.55179691,1.92626882,1.57730031,1.42740774,0.04500208,-1.28118479,-0.17363703,-0.27932742,0.99022150,-4.18691969 &
            ,-6.25901318,-4.27614069,1.80964053,3.51546669,-2.90095377,1.97108817,1.79920113,-1.52525854,-0.76962793,-0.13616118,0.10429594,-0.60556477 &
            ,0.26883638,0.28682935,-0.29011425,-1.95103168,0.79848391,2.17350531,-2.89150786,-0.73074174,0.08091377,-1.50516617,0.17819098,-1.52665889 &
            ,1.05577791,0.71510273,0.26607493,0.41654110,-0.10581194,0.42342907,-0.23207431,-0.09447692,-1.53155529,-0.53751570,-0.89520651,-3.04213595 &
            ,-0.12685016,0.83834207,-1.35672259,-0.57471687,0.36021703,-0.72973311,0.40533179,-0.17200109,0.01172771,-0.22588508,-0.07241202,0.27474824 &
            ,-0.34119689,-0.13023433,-1.04165840,0.11746479,-1.04517615,-0.68423200,0.32472593,1.25360060,0.69391286,1.88213682,0.89070213,-0.03617292 &
            ,0.02005325,0.01030238,-0.03762184,0.08641286,0.09685173,0.01080448,-0.33063817,-0.73813379,0.27792776,0.08947304,-0.21569821,-0.26461735 &
            ,0.08456155,-0.04434945,0.38869193,0.88995677/),(/8,119/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-10.77627850,2.89785171,10.72641468,-2.76280737,3.21713972,-4.59850883,3.80802560,-8.10740852,10.94755745,-3.96694732,6.52792168,2.66527510 &
            ,-2.49739432,4.37786293,-0.51024568,8.17704582/),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.92211819,2.99261332/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.65506065,4.72145557,9.29068756,-6.37403727,-3.55928230,-2.02052927,3.71000910,4.88903904/)
real, dimension(2) :: bias2 = &
  (/3.15135765,-5.99149275/)
real, dimension(1) :: bias3 = &
  (/-2.81683493/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(119) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 119
    inarray2(i) = inarray(120-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL

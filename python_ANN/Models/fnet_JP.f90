module fnet_JP

! a = 0.00000365
! b = 0.07965


intrinsic Reshape
real, dimension(8, 119) :: input = &
  Reshape((/0.75364029,-1.14741588,-0.45531860,-1.48944628,-0.79993576,-2.99329758,-0.72706747,-6.20562649,-1.20854032,-15.05684471,-12.73844051,-12.33568287 &
            ,4.66375589,5.01871395,-2.86731005,-0.76023597,1.62647939,-0.10935713,-0.18493153,-0.42122093,-0.15150124,0.07313517,0.19223034,0.62103415 &
            ,0.61401761,-0.46843696,1.40532684,0.45556405,0.25809509,-1.26363313,-0.14228775,0.07920887,-0.32296315,0.53347337,-2.86301255,3.48945975 &
            ,-1.38759840,0.99305838,-1.09048843,1.88241398,1.40330112,1.45148134,4.40572405,0.44057447,-1.74983311,-0.99135107,-2.83875251,3.17953563 &
            ,-0.00456627,5.66702747,-4.46855688,-0.50761849,-0.06377563,0.76554233,0.53083271,-1.03420448,0.21368191,-1.39196932,-0.82522464,-0.63003224 &
            ,-0.84032345,1.26310241,-0.29666349,-0.65898967,-0.97808623,1.24001384,-1.86773241,1.69190252,0.02710256,-0.17571419,0.44239271,0.60464245 &
            ,-1.13136792,-0.10686112,0.10158888,-1.45678675,2.09249902,1.92176747,-0.73474288,1.08265364,-0.33138508,-0.94770712,-0.80048180,2.11645508 &
            ,-2.43207264,0.58058000,-0.27485973,-0.63080215,0.25525337,-0.38448951,0.01179053,0.03495169,-0.74744308,-1.17123139,1.60377944,0.21127641 &
            ,1.72111893,0.17884947,0.64623469,-1.19395304,0.09991488,-1.01531076,0.64118606,-0.00550457,0.15960903,-0.11043876,-0.04294442,0.08016151 &
            ,-0.13138133,-0.34754366,0.12580554,-0.22607887,-0.24389133,-0.43305007,-0.19035999,0.41719902,-0.06268366,-0.26514053,0.28715876,-3.70282865 &
            ,-0.69722682,-3.92384934,-2.65903020,2.54564762,0.67064130,0.72380018,-1.90203309,-6.55248976,-7.05930805,-1.64090300,-3.65783882,-8.75080299 &
            ,-6.75953007,0.60182905,-7.10311794,-0.73407149,0.06056008,0.05984476,0.92991507,0.06186344,-0.26609710,-0.34991673,-0.05022211,0.51689065 &
            ,-0.08710683,-0.62227571,-1.36399186,-0.99678797,1.64761376,-0.62734216,-0.20792894,1.28582907,1.48693407,0.25679976,1.52945733,-1.35806906 &
            ,1.69116747,1.81774855,1.85756564,2.49693656,1.72563577,-1.96898258,0.21182930,-3.10197973,-11.20979881,-2.90106392,4.44215488,3.72526169 &
            ,-3.65540409,-2.17320156,-1.46252441,0.24639779,0.24023420,-0.44878063,0.83959115,-0.21661183,-1.39627695,0.19061884,-1.30500960,-0.46694279 &
            ,-8.55152607,3.49807000,1.92115164,0.42880160,-7.40328169,-0.09590686,2.13622165,1.16427350,0.02605612,-0.26133877,-0.94643784,-0.04159930 &
            ,0.22058503,-0.59517503,-1.33368659,3.24218416,2.11261511,-0.32436278,-1.91371679,2.02311230,-1.32067537,0.02012785,3.72097301,-1.04674315 &
            ,0.16973358,0.86925930,-0.30835745,0.20204577,-0.43433329,0.30033562,1.18577385,-0.65596092,0.86402088,-2.61824560,-0.64199460,-1.15431452 &
            ,0.46278039,-0.73527700,1.25534272,-0.34679958,-0.33360729,0.36284226,0.18309677,-0.06238903,0.23831372,0.25719437,0.18153290,0.27275661 &
            ,2.92512894,2.39253211,0.15575218,0.37697825,-0.04928335,0.26089567,0.58186561,0.69587159,-0.57440358,0.17719536,5.84995651,2.69935298 &
            ,6.19780493,8.28106976,1.44333100,6.41575003,6.87563753,4.11257267,-3.84130096,10.75706196,8.93076897,-2.79535961,-5.29861212,4.57249641 &
            ,1.66641808,5.25761890,-8.08846092,-0.18619984,0.03711854,0.47956857,-0.42391568,0.23009564,-0.49523371,-0.34157151,0.07131220,1.19893992 &
            ,-1.99421549,-1.13562202,-1.13498902,0.03695867,-0.06192690,-1.39910483,0.69256288,2.03961945,-6.52926159,-2.18411517,-0.24120000,2.26178551 &
            ,2.51184440,2.75200415,5.92303181,-2.71791649,-17.53351212,3.03173995,0.49538082,0.74964023,-2.56799221,2.15452743,6.76613903,0.61840439 &
            ,3.52316189,-1.47795808,-0.29820925,0.96294248,0.67623520,-0.72318292,1.00057960,-1.16357529,3.17725992,-1.88761592,4.31618643,-3.39681792 &
            ,-1.47745931,-4.93173933,2.23779964,0.62767732,4.77044392,-2.88493299,-0.15156707,-0.21388575,-0.73079979,-0.46011737,0.20265234,1.79351604 &
            ,0.89559489,4.39925289,-4.82422733,2.53482842,1.48555446,-1.82260251,2.20026207,-2.18748236,0.78459620,0.29387510,-1.48055220,-0.16674492 &
            ,0.31698185,1.00381231,-0.19718489,-0.55405647,0.50569904,0.29062095,0.58852595,2.32778764,-2.51241755,0.85451823,-1.92757583,0.57907033 &
            ,-1.65451026,1.48812521,-1.98008585,0.72064763,-0.46805710,-0.02231831,-0.00388821,0.01066780,-0.02655412,-0.02868926,0.27321339,0.67421991 &
            ,-0.71499825,-1.46594405,0.19241925,0.37476915,0.98973262,0.62511849,0.38950494,0.44384316,-0.11197805,-1.81666338,1.56145215,1.51344240 &
            ,0.74944288,2.42458868,4.04722118,2.28712368,-3.84629941,-2.53064370,3.13162279,-5.64278507,2.66912532,1.57321572,-3.93382359,-4.61682844 &
            ,-1.50082314,1.99468756,0.28835762,0.11892785,0.31585282,-0.11021702,-0.10682981,-0.17993875,-0.37279350,0.50747478,-0.76183581,-0.61697137 &
            ,-1.09068775,-0.58031952,1.22038853,-0.06232370,-0.29679924,1.33846354,-0.36058262,-0.20104621,0.60930234,2.50011659,-1.96628833,0.96898508 &
            ,1.33009315,1.96775007,2.85161734,0.16523726,-4.27738190,0.36500934,-1.19635892,0.44404840,-0.23525627,0.99639589,2.56488991,-4.74786472 &
            ,-0.73997009,0.73441750,1.03854382,-0.62706441,0.15280518,0.08461726,-2.03622627,-0.90071845,-1.31505716,-0.15398711,-5.52292633,-0.30451536 &
            ,3.25323677,-1.34122264,-5.73044109,-3.76500654,2.32646608,0.12929522,0.19298233,0.45743501,-1.66796339,1.14448249,-0.90912062,-0.64502239 &
            ,-2.32402372,5.37567520,-0.10555451,-1.44649529,-0.12050563,1.84571338,-1.06491673,0.26099455,3.44069743,-0.46047202,-0.15357220,0.68669766 &
            ,-0.10713462,-0.03907866,-0.53255045,-0.40750033,1.19121242,-0.98231435,0.43114060,-1.45353794,0.20864418,-0.29256645,1.03089666,-0.54591346 &
            ,0.82055759,-0.24652767,-0.14332196,-0.14840169,0.04124875,-0.03181041,0.11250372,0.19316529,0.22717775,0.27244630,1.42817187,0.93866587 &
            ,-0.04352555,0.79391605,0.44621760,0.49174049,0.21099566,0.62370211,-1.02521420,0.14139350,0.13085949,-1.37395656,-2.14355230,-1.90410876 &
            ,-2.61069727,-4.39984083,-0.75065839,-14.67904949,-12.02802181,-5.10626268,1.57303965,-1.63618541,-1.31541085,1.83552265,2.20747662,0.39323193 &
            ,-0.48825556,-0.05693313,0.07224419,-0.08690672,0.22626674,0.21264835,0.20279862,0.31802565,0.84811735,0.96251911,0.58222073,0.89755046 &
            ,0.52218401,-0.40641966,0.33954006,0.06870470,-0.60507673,-0.22363122,0.73473245,-1.07028639,-1.02920055,-0.90988755,-0.74079382,-2.63034558 &
            ,-2.37177086,-7.28448248,-2.75149393,0.22529487,-2.18714190,1.59250164,-0.06904840,-0.84788799,-0.73283464,-2.58321857,2.79669595,0.65440643 &
            ,-0.29040051,-0.60097241,0.16966169,0.01658852,-0.14445415,1.24947584,0.99504983,1.48602772,0.11043168,3.95307636,-0.42156288,-0.64056337 &
            ,0.66747183,3.19959426,1.45773470,-1.30856669,-0.07940952,0.06752881,-0.01288494,0.64470267,-0.16053601,0.02902552,0.33946434,0.65409327 &
            ,-2.49093294,-0.70984334,0.47594264,0.29653198,-1.10158777,0.94824421,0.02498798,-2.33651686,0.71353841,-0.06372142,-0.37608418,0.05090332 &
            ,-0.03064056,0.33329844,0.01790279,-0.78799981,0.35038865,-0.48337907,0.94876277,0.22484154,0.39024138,-0.33885723,0.32482573,-0.60271931 &
            ,-0.06141806,0.15144697,0.02602063,-0.08423443,-0.04174019,-0.09009705,-0.12952501,-0.10726273,-0.18534462,-0.94301450,-0.52925777,0.18905634 &
            ,-0.45231271,-0.22249055,-0.28984761,-0.25735503,-0.36918128,0.40594742,-0.18996859,-0.15418640,-1.90295124,-0.44950929,0.85148764,0.87678260 &
            ,-2.59231496,-0.95993900,5.49344349,13.87082958,30.39559555,18.80253410,5.15050316,14.81082344,15.99702168,21.21752167,11.30940533,-2.41123247 &
            ,-0.61238372,1.63094401,-1.35405135,-1.72114944,0.40882540,-1.02547538,1.29958165,1.07459068,-2.40190935,-6.09919167,-5.27111816,1.32173848 &
            ,-0.57093334,-2.46560478,-3.78534174,5.49214506,0.63880700,-0.01488041,-2.07293248,2.24406004,4.07135439,5.47229481,7.33081722,5.61941862 &
            ,7.44170332,6.51880121,1.84707892,2.09349132,-3.50122690,-3.97887826,-1.80829430,-1.20867026,7.29525232,-2.57615089,1.85561645,-1.13853216 &
            ,2.73353124,1.85401559,1.41164088,-0.80628937,-2.63084769,-2.31603289,-10.59017944,-5.75613594,9.43232918,0.96939135,-5.62087679,0.66979802 &
            ,-1.82815373,-6.16174173,-7.59218264,0.33492348,-1.08742070,-0.61563373,1.36887419,-4.85767221,1.21569204,-3.18726277,-6.25389671,-2.36279058 &
            ,4.87041569,-1.91099751,0.32667392,1.16508639,-5.40344763,-0.36748841,-2.93952847,4.56830454,1.59104812,-0.16304100,0.78959161,-1.79104471 &
            ,-0.54245299,0.25792217,0.55541658,-0.97098196,1.28732824,-1.87417698,2.96464896,-3.13099217,2.18151402,-0.32524920,3.59937525,-1.44278681 &
            ,3.62473965,11.49572277,0.18679900,0.19688016,0.03154454,0.30758613,0.39032426,0.76600325,2.01397300,-1.35899973,-2.37127566,-0.07070573 &
            ,0.38601762,1.69871902,1.17067122,1.81040692,-0.98856276,-0.52146369,0.81729859,0.11137839,-1.57564759,-1.31871581,-1.82119596,-0.75334269 &
            ,-0.45876434,-0.65275919,-3.12417746,-2.19815207,-0.68054783,0.59131891,2.19291782,2.86606002,0.84587401,2.89121461,0.28584716,-0.56020808 &
            ,0.63442284,5.56265450,2.95376277,2.92912388,-1.60050344,-1.06761420,-7.28437185,-0.94748527,-2.66969323,-0.88417274,2.79454589,0.84268421 &
            ,10.47066212,3.94703126,-0.66954392,8.64665699,1.54195595,0.80258000,0.92191172,0.50226194,0.24213311,-0.40917453,-0.24641381,0.00624070 &
            ,0.76090378,1.69745684,0.67238498,1.08118105,-0.10890432,-2.74803042,-2.93200254,-2.31341767,1.77330840,-0.74583012,-1.90489352,-3.00831771 &
            ,-3.07661271,-0.55702537,0.26396176,-1.38971376,-2.48877597,-0.18524241,6.27648067,0.90966582,-4.36510897,3.51392698,5.99613047,1.40845835 &
            ,5.41265774,-9.03883934,-2.91853476,2.78404140,3.87907195,3.64098096,0.34315243,-0.90477377,-0.89250487,-5.94135857,-4.42720222,3.05334783 &
            ,-4.94815540,3.36463809,1.85076857,3.16413069,-2.68986583,0.30742610,-1.75730014,0.10053088,-0.58107954,0.08604168,0.12559107,-0.14961980 &
            ,0.32095528,-2.78065538,3.02193236,4.59614849,1.69654250,0.36680776,-3.99461603,0.94834101,2.37245727,3.92368126,2.06108284,2.16489816 &
            ,1.37211370,-0.60725462,-0.81106764,0.65455407,-0.89869344,-0.68147516,0.24402234,1.61280370,2.75437784,0.65453124,-1.81393015,-3.78676009 &
            ,-1.85199320,-0.10771319,0.23228748,-0.53949165,2.68366647,1.40374899,-2.47224760,0.48641503,-0.58055156,-2.63781047,1.73575306,-0.67568028 &
            ,-3.91746807,6.43056631,-4.36151648,-14.84132099,-25.02722359,-22.81256294,-10.81119061,-14.29479980,-12.54569054,-0.40723720,0.86005336,0.32018691 &
            ,-0.56254107,-0.08982565,0.00339419,0.25857562,-0.97729355,-0.59847564,1.21179414,-0.63929713,0.85742652,2.30742764,2.67723799,0.24164811 &
            ,1.21382701,1.13609052,-2.26286149,1.43165112,-0.07772192,-4.71375561,-3.71879053,-2.52409387,-1.15147257,0.18432473,-16.16260910,-21.76995850 &
            ,2.18023777,10.92580891,7.73727417,2.60355377,-3.02380037,0.71337563,-6.21775055,5.24406910,3.92454553,-0.84986949,-2.27014351,-1.41106439 &
            ,0.25649184,0.34226432,1.46079719,-4.84966898,5.53229094,-0.31424272,-4.11154509,0.93840730,2.91508961,-3.92840457,1.14219153,-2.91427326 &
            ,2.56085110,-0.32242143,-0.09412415,-0.24060297,-0.30298275,1.08584321,-0.71424520,-0.30534947,-3.18680406,1.92821550,-4.33997679,0.00077021 &
            ,0.35951167,0.84186405,3.45200157,-1.21587074,0.75029576,2.69023037,0.48102832,0.29865107,0.66046196,-0.76305187,0.92515254,-0.31764138 &
            ,0.43816999,1.51954579,1.26839185,1.64380097,-0.01629171,0.63720179,0.07243972,0.48909408,-0.50201380,1.08703339,-0.49347335,-0.24199224 &
            ,0.01239764,0.09858280,0.02654763,0.03409917,0.06883024,0.18103467,-0.48210052,-0.49668741,0.31337437,0.01902723,0.51964933,-0.30740109 &
            ,-0.26006517,0.71179008,0.87716824,1.19047236/),(/8,119/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/10.61342144,3.96704459,2.44366789,3.27139401,6.43961143,9.22192669,-0.43272215,7.09637642,-14.47410393,-3.09048438,-2.13577104,-3.87812495 &
            ,-7.60802984,-0.41343990,0.42526060,-15.37718391/),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-1.13864136,-4.55785275/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/2.99517632,7.71705246,-8.51072788,8.54357624,0.30808464,10.72857380,-5.82599545,4.42035961/)
real, dimension(2) :: bias2 = &
  (/-16.80775261,9.73581409/)
real, dimension(1) :: bias3 = &
  (/4.66915560/)
contains
subroutine fnet_JP_initall()
end subroutine fnet_JP_initall
subroutine fnet_JP_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(119) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 119
    inarray2(i) = inarray(120-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_JP_engine
end module fnet_JP
